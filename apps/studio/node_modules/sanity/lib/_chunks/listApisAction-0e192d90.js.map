{"version":3,"file":"listApisAction-0e192d90.js","sources":["../../src/_internal/cli/actions/graphql/listApisAction.ts"],"sourcesContent":["import type {CliCommandArguments, CliCommandContext} from '@sanity/cli'\nimport {getClientUrl} from '../../util/getClientUrl'\n\ntype ListApisResponse = {\n  projectId: string\n  dataset: string\n  tag: string\n  playgroundEnabled: boolean\n  generation: string\n}[]\n\nexport default async function listGraphQLApis(\n  args: CliCommandArguments<Record<string, unknown>>,\n  context: CliCommandContext\n): Promise<void> {\n  const {apiClient, output, chalk} = context\n\n  const client = apiClient({\n    requireUser: true,\n    requireProject: true,\n  }).config({apiVersion: '1'})\n\n  let endpoints: ListApisResponse | undefined\n  try {\n    endpoints = await client.request<ListApisResponse>({\n      url: '/apis/graphql',\n      method: 'GET',\n    })\n  } catch (err) {\n    throw err\n  }\n\n  if (!endpoints || endpoints.length === 0) {\n    output.print(\"This project doesn't have any GraphQL endpoints deployed.\")\n    return\n  }\n\n  output.print('Here are the GraphQL endpoints deployed for this project:')\n  endpoints.forEach((endpoint, index) => {\n    const {dataset, tag} = endpoint\n    const url = getClientUrl(client, `graphql/${dataset}/${tag}`)\n\n    output.print(`${index + 1}.  ${chalk.bold('Dataset:')}     ${dataset}`)\n    output.print(`    ${chalk.bold('Tag:')}         ${tag}`)\n    output.print(`    ${chalk.bold('Generation:')}  ${endpoint.generation}`)\n    output.print(`    ${chalk.bold('Playground:')}  ${endpoint.playgroundEnabled}`)\n    output.print(`    ${chalk.bold('URL:')}  ${url}\\n`)\n  })\n}\n"],"names":["listGraphQLApis","args","context","apiClient","output","chalk","client","requireUser","requireProject","config","apiVersion","endpoints","request","url","method","err","length","print","forEach","endpoint","index","dataset","tag","getClientUrl","concat","bold","generation","playgroundEnabled"],"mappings":";;;AAW8B,eAAAA,eAAAA,CAC5BC,MACAC,OACe,EAAA;EACf,MAAM;IAACC,SAAA;IAAWC,MAAQ;IAAAC;EAAA,CAAS,GAAAH,OAAA;EAEnC,MAAMI,SAASH,SAAU,CAAA;IACvBI,WAAa,EAAA,IAAA;IACbC,cAAgB,EAAA;EACjB,CAAA,CAAE,CAAAC,MAAA,CAAO;IAACC,UAAA,EAAY;EAAI,CAAA,CAAA;EAEvB,IAAAC,SAAA;EACA,IAAA;IACUA,SAAA,GAAA,MAAML,OAAOM,OAA0B,CAAA;MACjDC,GAAK,EAAA,eAAA;MACLC,MAAQ,EAAA;IAAA,CACT,CAAA;WACMC,GAAP,EAAA;IACM,MAAAA,GAAA;EACR;EAEA,IAAI,CAACJ,SAAA,IAAaA,SAAU,CAAAK,MAAA,KAAW,CAAG,EAAA;IACxCZ,MAAA,CAAOa,MAAM,2DAA2D,CAAA;IACxE;EACF;EAEAb,MAAA,CAAOa,MAAM,2DAA2D,CAAA;EAC9DN,SAAA,CAAAO,OAAA,CAAQ,CAACC,QAAA,EAAUC,KAAU,KAAA;IAC/B,MAAA;MAACC,OAAS;MAAAC;IAAO,CAAA,GAAAH,QAAA;IACvB,MAAMN,GAAM,GAAAU,sBAAA,CAAajB,MAAQ,aAAAkB,MAAA,CAAWH,qBAAWC,GAAK,CAAA,CAAA;IAErDlB,MAAA,CAAAa,KAAA,IAAAO,MAAA,CAASJ,KAAQ,GAAA,CAAA,SAAAI,MAAA,CAAOnB,MAAMoB,IAAK,CAAA,UAAU,mBAASJ,OAAS,CAAA,CAAA;IACtEjB,MAAA,CAAOa,oBAAaZ,KAAA,CAAMoB,IAAK,CAAA,MAAM,uBAAaH,GAAK,CAAA,CAAA;IACvDlB,MAAA,CAAOa,oBAAaZ,KAAA,CAAMoB,KAAK,aAAa,CAAA,QAAAD,MAAA,CAAML,SAASO,UAAY,CAAA,CAAA;IACvEtB,MAAA,CAAOa,oBAAaZ,KAAA,CAAMoB,KAAK,aAAa,CAAA,QAAAD,MAAA,CAAML,SAASQ,iBAAmB,CAAA,CAAA;IAC9EvB,MAAA,CAAOa,KAAM,QAAAO,MAAA,CAAOnB,KAAM,CAAAoB,IAAA,CAAK,MAAM,CAAM,QAAAD,MAAA,CAAAX,GAAA,OAAO,CAAA;EAAA,CACnD,CAAA;AACH;"}