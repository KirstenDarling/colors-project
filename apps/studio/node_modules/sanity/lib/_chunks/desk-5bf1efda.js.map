{"version":3,"file":"desk-5bf1efda.js","sources":["../../src/desk/components/DocTitle.tsx","../../src/desk/components/TimeAgo.tsx","../../src/desk/components/confirmDeleteDialog/useReferringDocuments.ts","../../src/desk/components/PublishedStatus.tsx","../../src/desk/components/DraftStatus.tsx","../../src/desk/components/paneItem/PaneItemPreview.tsx","../../src/desk/components/paneRouter/PaneRouterContext.tsx","../../src/desk/components/paneRouter/BackLink.tsx","../../src/desk/components/paneRouter/ChildLink.tsx","../../src/desk/components/paneRouter/ReferenceChildLink.tsx","../../src/desk/components/paneRouter/ParameterizedLink.tsx","../../src/desk/components/paneRouter/usePaneRouter.ts","../../src/desk/components/confirmDeleteDialog/ReferencePreviewLink.tsx","../../src/desk/components/confirmDeleteDialog/ConfirmDeleteDialogBody.styles.tsx","../../src/desk/components/confirmDeleteDialog/ConfirmDeleteDialogBody.tsx","../../src/desk/components/confirmDeleteDialog/ConfirmDeleteDialog.tsx","../../src/desk/components/confirmDeleteDialog/index.tsx","../../src/desk/components/pane/PaneContextMenuButton.tsx","../../src/desk/components/pane/constants.ts","../../src/desk/components/pane/PaneContext.ts","../../src/desk/components/pane/PaneLayoutContext.ts","../../src/desk/components/pane/usePaneLayout.ts","../../src/desk/components/pane/PaneDivider.tsx","../../src/desk/components/pane/Pane.tsx","../../src/desk/components/pane/usePane.ts","../../src/desk/components/pane/PaneContent.styles.tsx","../../src/desk/components/pane/PaneContent.tsx","../../src/desk/components/pane/PaneFooter.styles.tsx","../../src/desk/components/pane/PaneFooter.tsx","../../src/desk/components/pane/PaneHeader.styles.tsx","../../src/desk/components/pane/PaneHeader.tsx","../../src/desk/components/pane/PaneLayout.styles.tsx","../../src/desk/components/IntentButton.tsx","../../src/desk/components/paneHeaderActions/InsufficientPermissionsMessageTooltip.tsx","../../src/desk/components/paneHeaderActions/PaneHeaderCreateButton.tsx","../../src/desk/components/paneHeaderActions/PaneHeaderActions.tsx","../../src/desk/documentActions/DeleteAction.tsx","../../src/desk/documentActions/DiscardChangesAction.tsx","../../src/desk/documentActions/DuplicateAction.tsx","../../src/desk/documentActions/HistoryRestoreAction.tsx","../../src/desk/panes/document/DocumentPaneContext.ts","../../src/desk/panes/document/useDocumentPane.tsx","../../src/desk/documentActions/PublishAction.tsx","../../src/desk/documentActions/UnpublishAction.tsx","../../src/desk/documentBadges/LiveEditBadge.ts","../../src/desk/constants.ts","../../src/desk/getIntentState.ts","../../src/desk/router.ts","../../src/desk/deskTool.ts","../../src/desk/DeskToolContext.ts","../../src/desk/structureBuilder/SerializeError.ts","../../src/desk/structureBuilder/util/getExtendedProjection.ts","../../src/desk/structureBuilder/Sort.ts","../../src/desk/structureBuilder/MenuItem.ts","../../src/desk/structureBuilder/MenuItemGroup.ts","../../src/desk/structureBuilder/util/validateId.ts","../../src/desk/structureBuilder/util/getStructureNodeId.ts","../../src/desk/structureBuilder/Component.ts","../../src/desk/structureBuilder/util/resolveTypeForDocument.ts","../../src/desk/structureBuilder/views/View.ts","../../src/desk/structureBuilder/views/ComponentView.ts","../../src/desk/structureBuilder/views/FormView.ts","../../src/desk/structureBuilder/views/index.ts","../../src/desk/structureBuilder/Document.ts","../../src/desk/structureBuilder/Layout.ts","../../src/desk/structureBuilder/Intent.ts","../../src/desk/structureBuilder/InitialValueTemplateItem.ts","../../src/desk/structureBuilder/GenericList.ts","../../src/desk/structureBuilder/DocumentList.ts","../../src/desk/structureBuilder/List.ts","../../src/desk/structureBuilder/ListItem.ts","../../src/desk/structureBuilder/DocumentListItem.ts","../../src/desk/structureBuilder/DocumentTypeList.ts","../../src/desk/structureBuilder/documentTypeListItems.ts","../../src/desk/structureBuilder/createStructureBuilder.ts","../../src/desk/DeskToolProvider.tsx"],"sourcesContent":["import {SanityDocumentLike} from '@sanity/types'\nimport React from 'react'\nimport {useSchema, unstable_useValuePreview as useValuePreview} from 'sanity'\n\nexport interface DocTitleProps {\n  document: SanityDocumentLike\n}\n\nexport function DocTitle(props: DocTitleProps) {\n  const {document: documentValue} = props\n  const schema = useSchema()\n  const schemaType = schema.get(documentValue._type)\n\n  const {error, value} = useValuePreview({\n    schemaType: schemaType!,\n    value: documentValue,\n  })\n\n  if (!schemaType) {\n    return <code>Unknown schema type: {documentValue._type}</code>\n  }\n\n  if (error) {\n    return <>Error: {error.message}</>\n  }\n\n  return <>{value?.title || <span style={{color: 'var(--card-muted-fg-color)'}}>Untitled</span>}</>\n}\n","import React from 'react'\nimport {useTimeAgo} from 'sanity'\n\nexport interface TimeAgoProps {\n  time: string | Date\n}\n\nexport function TimeAgo({time}: TimeAgoProps) {\n  const timeAgo = useTimeAgo(time)\n\n  return <span title={timeAgo}>{timeAgo} ago</span>\n}\n","import {useMemo} from 'react'\nimport {ClientError, SanityClient} from '@sanity/client'\nimport {Observable, timer, fromEvent, EMPTY, of} from 'rxjs'\nimport {\n  map,\n  startWith,\n  distinctUntilChanged,\n  switchMap,\n  shareReplay,\n  catchError,\n} from 'rxjs/operators'\nimport {\n  AvailabilityResponse,\n  DEFAULT_STUDIO_CLIENT_OPTIONS,\n  DocumentStore,\n  useDocumentStore,\n  createHookFromObservableFactory,\n  getDraftId,\n  getPublishedId,\n  useClient,\n} from 'sanity'\n\n// this is used in place of `instanceof` so the matching can be more robust and\n// won't have any issues with dual packages etc\n// https://nodejs.org/api/packages.html#dual-package-hazard\nfunction isClientError(e: unknown): e is ClientError {\n  if (typeof e !== 'object') return false\n  if (!e) return false\n  return 'statusCode' in e && 'response' in e\n}\n\nconst POLL_INTERVAL = 5000\n\n// only fetches when the document is visible\nlet visiblePoll$: Observable<number>\nconst getVisiblePoll$ = () => {\n  if (!visiblePoll$) {\n    visiblePoll$ = fromEvent(document, 'visibilitychange').pipe(\n      // add empty emission to have this fire on creation\n      startWith(null),\n      map(() => document.visibilityState === 'visible'),\n      distinctUntilChanged(),\n      switchMap((visible) =>\n        visible\n          ? // using timer instead of interval since timer will emit on creation\n            timer(0, POLL_INTERVAL)\n          : EMPTY\n      ),\n      shareReplay({refCount: true, bufferSize: 1})\n    )\n  }\n  return visiblePoll$\n}\n\nexport type ReferringDocuments = {\n  isLoading: boolean\n  totalCount: number\n  projectIds: string[]\n  datasetNames: string[]\n  hasUnknownDatasetNames: boolean\n  internalReferences?: {\n    totalCount: number\n    references: Array<{_id: string; _type: string}>\n  }\n  crossDatasetReferences?: {\n    totalCount: number\n    references: Array<{\n      /**\n       * The project ID of the document that is currently referencing the subject\n       * document. Unlike `documentId` and `datasetName`, this should always be\n       * defined.\n       */\n      projectId: string\n      /**\n       * The ID of the document that is currently referencing the subject\n       * document. This will be omitted if there is no access to the current\n       * project and dataset pair (e.g. if no `sanity-project-token` were\n       * configured)\n       */\n      documentId?: string\n      /**\n       * The dataset name that is currently referencing the subject document.\n       * This will be omitted if there is no access to the current project and\n       * dataset pair (e.g. if no `sanity-project-token` were configured)\n       */\n      datasetName?: string\n    }>\n  }\n}\n\nfunction getDocumentExistence(\n  documentId: string,\n  {versionedClient}: {versionedClient: SanityClient}\n): Observable<string | undefined> {\n  const draftId = getDraftId(documentId)\n  const publishedId = getPublishedId(documentId)\n  const requestOptions = {\n    uri: versionedClient.getDataUrl('doc', `${draftId},${publishedId}`),\n    json: true,\n    query: {excludeContent: 'true'},\n    tag: 'use-referring-documents.document-existence',\n  }\n  return versionedClient.observable.request<AvailabilityResponse>(requestOptions).pipe(\n    map(({omitted}) => {\n      const nonExistant = omitted.filter((doc) => doc.reason === 'existence')\n      if (nonExistant.length === 2) {\n        // None of the documents exist\n        return undefined\n      }\n\n      if (nonExistant.length === 0) {\n        // Both exist, so use the published one\n        return publishedId\n      }\n\n      // If the draft does not exist, use the published ID, and vice versa\n      return nonExistant.some((doc) => doc.id === draftId) ? publishedId : draftId\n    })\n  )\n}\n\n/**\n * fetches the cross-dataset references using the client observable.request\n * method (for that requests can be automatically cancelled)\n */\nfunction fetchCrossDatasetReferences(\n  documentId: string,\n  context: {versionedClient: SanityClient}\n): Observable<ReferringDocuments['crossDatasetReferences']> {\n  const {versionedClient} = context\n\n  return getVisiblePoll$().pipe(\n    switchMap(() => getDocumentExistence(documentId, context)),\n    switchMap((checkDocumentId) => {\n      if (!checkDocumentId) {\n        return of({totalCount: 0, references: []})\n      }\n\n      const currentDataset = versionedClient.config().dataset\n\n      return versionedClient.observable\n        .request({\n          url: `/data/references/${currentDataset}/documents/${checkDocumentId}/to?excludeInternalReferences=true&excludePaths=true`,\n          tag: 'use-referring-documents.external',\n        })\n        .pipe(\n          catchError((e) => {\n            // it's possible that referencing document doesn't exist yet so the\n            // API will return a 404. In those cases, we want to catch and return\n            // a response with no references\n            if (isClientError(e) && e.statusCode === 404) {\n              return of({totalCount: 0, references: []})\n            }\n\n            throw e\n          })\n        )\n    })\n  )\n}\n\nconst useInternalReferences = createHookFromObservableFactory(\n  ([documentId, documentStore]: [string, DocumentStore]) => {\n    const referencesClause = '*[references($documentId)][0...100]{_id,_type}'\n    const totalClause = 'count(*[references($documentId)])'\n    const fetchQuery = `{\"references\":${referencesClause},\"totalCount\":${totalClause}}`\n    const listenQuery = '*[references($documentId)]'\n\n    return documentStore.listenQuery(\n      {fetch: fetchQuery, listen: listenQuery},\n      {documentId},\n      {tag: 'use-referring-documents', transitions: ['appear', 'disappear'], throttleTime: 5000}\n    ) as Observable<ReferringDocuments['internalReferences']>\n  }\n)\n\nconst useCrossDatasetReferences = createHookFromObservableFactory(\n  ([documentId, versionedClient]: [string, SanityClient]) => {\n    // (documentId: string, versionedClient: SanityClient) => {\n    return getVisiblePoll$().pipe(\n      switchMap(() =>\n        fetchCrossDatasetReferences(documentId, {\n          versionedClient,\n        })\n      )\n    )\n  }\n)\n\nexport function useReferringDocuments(documentId: string): ReferringDocuments {\n  const versionedClient = useClient(DEFAULT_STUDIO_CLIENT_OPTIONS)\n\n  const documentStore = useDocumentStore()\n  const publishedId = getPublishedId(documentId)\n\n  const [internalReferences, isInternalReferencesLoading] = useInternalReferences(\n    useMemo(() => [publishedId, documentStore], [documentStore, publishedId])\n  )\n\n  const [crossDatasetReferences, isCrossDatasetReferencesLoading] = useCrossDatasetReferences(\n    useMemo(() => [publishedId, versionedClient], [publishedId, versionedClient])\n  )\n\n  const projectIds = useMemo(() => {\n    return Array.from(\n      new Set(\n        crossDatasetReferences?.references\n          .map((crossDatasetReference) => crossDatasetReference.projectId)\n          .filter(Boolean)\n      )\n    ).sort()\n  }, [crossDatasetReferences?.references])\n\n  const datasetNames = useMemo(() => {\n    return Array.from(\n      new Set<string>(\n        crossDatasetReferences?.references\n          // .filter((name) => typeof name === 'string')\n          .map((crossDatasetReference) => crossDatasetReference?.datasetName || '')\n          .filter((datasetName) => Boolean(datasetName) && datasetName !== '')\n      )\n    ).sort()\n  }, [crossDatasetReferences?.references])\n\n  const hasUnknownDatasetNames = useMemo(() => {\n    return Boolean(\n      crossDatasetReferences?.references.some(\n        (crossDatasetReference) => typeof crossDatasetReference.datasetName !== 'string'\n      )\n    )\n  }, [crossDatasetReferences?.references])\n\n  return {\n    totalCount: (internalReferences?.totalCount || 0) + (crossDatasetReferences?.totalCount || 0),\n    projectIds,\n    datasetNames,\n    hasUnknownDatasetNames,\n    internalReferences,\n    crossDatasetReferences,\n    isLoading: isInternalReferencesLoading || isCrossDatasetReferencesLoading,\n  }\n}\n","import React from 'react'\nimport {PublishIcon} from '@sanity/icons'\nimport {PreviewValue, SanityDocument} from '@sanity/types'\nimport {Box, Text, Tooltip} from '@sanity/ui'\nimport {TimeAgo} from './TimeAgo'\nimport {TextWithTone} from 'sanity'\n\nexport function PublishedStatus(props: {document?: PreviewValue | Partial<SanityDocument> | null}) {\n  const {document} = props\n  const updatedAt = document && '_updatedAt' in document && document._updatedAt\n\n  return (\n    <Tooltip\n      portal\n      content={\n        <Box padding={2}>\n          <Text size={1}>\n            {document ? (\n              <>Published {updatedAt && <TimeAgo time={updatedAt} />}</>\n            ) : (\n              <>Not published</>\n            )}\n          </Text>\n        </Box>\n      }\n    >\n      <TextWithTone tone=\"positive\" dimmed={!document} muted={!document} size={1}>\n        <PublishIcon />\n      </TextWithTone>\n    </Tooltip>\n  )\n}\n","import React from 'react'\nimport {EditIcon} from '@sanity/icons'\nimport {PreviewValue, SanityDocument} from '@sanity/types'\nimport {Box, Text, Tooltip} from '@sanity/ui'\nimport {TimeAgo} from './TimeAgo'\nimport {TextWithTone} from 'sanity'\n\nexport function DraftStatus(props: {document?: PreviewValue | Partial<SanityDocument> | null}) {\n  const {document} = props\n  const updatedAt = document && '_updatedAt' in document && document._updatedAt\n\n  return (\n    <Tooltip\n      portal\n      content={\n        <Box padding={2}>\n          <Text size={1}>\n            {document ? (\n              <>Edited {updatedAt && <TimeAgo time={updatedAt} />}</>\n            ) : (\n              <>No unpublished edits</>\n            )}\n          </Text>\n        </Box>\n      }\n    >\n      <TextWithTone tone=\"caution\" dimmed={!document} muted={!document} size={1}>\n        <EditIcon />\n      </TextWithTone>\n    </Tooltip>\n  )\n}\n","import type {SanityDocument, SchemaType} from '@sanity/types'\nimport React, {isValidElement} from 'react'\nimport {isNumber, isString} from 'lodash'\nimport {Inline} from '@sanity/ui'\nimport {useMemoObservable} from 'react-rx'\nimport {PublishedStatus} from '../PublishedStatus'\nimport {DraftStatus} from '../DraftStatus'\nimport type {PaneItemPreviewState} from './types'\nimport {\n  DocumentPresence,\n  DocumentPreviewPresence,\n  DocumentPreviewStore,\n  GeneralPreviewLayoutKey,\n  getPreviewStateObservable,\n  getPreviewValueWithFallback,\n  SanityDefaultPreview,\n  isRecord,\n} from 'sanity'\n\nexport interface PaneItemPreviewProps {\n  documentPreviewStore: DocumentPreviewStore\n  icon: React.ComponentType | false\n  layout: GeneralPreviewLayoutKey\n  presence?: DocumentPresence[]\n  schemaType: SchemaType\n  value: SanityDocument\n}\n\nexport function PaneItemPreview(props: PaneItemPreviewProps) {\n  const {icon, layout, presence, schemaType, value} = props\n  const title =\n    (isRecord(value.title) && isValidElement(value.title)) ||\n    isString(value.title) ||\n    isNumber(value.title)\n      ? value.title\n      : null\n\n  // NOTE: this emits sync so can never be null\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  const {draft, published, isLoading} = useMemoObservable<PaneItemPreviewState>(\n    () => getPreviewStateObservable(props.documentPreviewStore, schemaType, value._id, title),\n    [props.documentPreviewStore, schemaType, value._id, title]\n  )!\n\n  const status = isLoading ? null : (\n    <Inline space={4}>\n      {presence && presence.length > 0 && <DocumentPreviewPresence presence={presence} />}\n      <PublishedStatus document={published} />\n      <DraftStatus document={draft} />\n    </Inline>\n  )\n\n  return (\n    <SanityDefaultPreview\n      {...getPreviewValueWithFallback({value, draft, published})}\n      isPlaceholder={isLoading}\n      icon={icon}\n      layout={layout}\n      status={status}\n    />\n  )\n}\n","import {createContext} from 'react'\nimport {PaneRouterContextValue} from './types'\n\nfunction missingContext<T = unknown>(): T {\n  throw new Error('Pane is missing router context')\n}\n\n/**\n *\n * @hidden\n * @beta\n */\nexport const PaneRouterContext = createContext<PaneRouterContextValue>({\n  index: 0,\n  groupIndex: 0,\n  siblingIndex: 0,\n  payload: undefined,\n  params: {},\n  hasGroupSiblings: false,\n  groupLength: 0,\n  routerPanesState: [],\n  BackLink: () => missingContext(),\n  ChildLink: () => missingContext(),\n  ReferenceChildLink: () => missingContext(),\n  handleEditReference: () => missingContext(),\n  ParameterizedLink: () => missingContext(),\n  replaceCurrent: () => missingContext(),\n  closeCurrent: () => missingContext(),\n  duplicateCurrent: () => missingContext(),\n  setView: () => missingContext(),\n  setParams: () => missingContext(),\n  setPayload: () => missingContext(),\n  navigateIntent: () => missingContext(),\n})\n","import React, {forwardRef, useContext, useMemo} from 'react'\nimport {PaneRouterContext} from './PaneRouterContext'\nimport {BackLinkProps} from './types'\nimport {StateLink} from 'sanity/router'\n\n/**\n * @internal\n */\nexport const BackLink = forwardRef(function BackLink(\n  props: BackLinkProps,\n  ref: React.ForwardedRef<HTMLAnchorElement>\n) {\n  const {routerPanesState, groupIndex} = useContext(PaneRouterContext)\n  const panes = useMemo(() => routerPanesState.slice(0, groupIndex), [groupIndex, routerPanesState])\n  const state = useMemo(() => ({panes}), [panes])\n\n  return <StateLink {...props} ref={ref} state={state} />\n}) as React.ComponentType<BackLinkProps>\n","import React, {forwardRef, useContext} from 'react'\nimport {PaneRouterContext} from './PaneRouterContext'\nimport {ChildLinkProps} from './types'\nimport {StateLink} from 'sanity/router'\n\n/**\n * @internal\n */\nexport const ChildLink = forwardRef(function ChildLink(\n  props: ChildLinkProps,\n  ref: React.ForwardedRef<HTMLAnchorElement>\n) {\n  const {childId, childPayload, childParameters, ...rest} = props\n  const {routerPanesState, groupIndex} = useContext(PaneRouterContext)\n\n  return (\n    <StateLink\n      {...rest}\n      ref={ref}\n      state={{\n        panes: [\n          ...routerPanesState.slice(0, groupIndex + 1),\n          [{id: childId, params: childParameters, payload: childPayload}],\n        ],\n      }}\n    />\n  )\n})\n","import React, {forwardRef} from 'react'\nimport {toString as pathToString} from '@sanity/util/paths'\nimport {ChildLink} from './ChildLink'\nimport {ReferenceChildLinkProps} from './types'\n\nexport const ReferenceChildLink = forwardRef(function ReferenceChildLink(\n  {documentId, documentType, parentRefPath, children, template, ...rest}: ReferenceChildLinkProps,\n  ref: React.ForwardedRef<HTMLAnchorElement>\n) {\n  return (\n    <ChildLink\n      {...rest}\n      ref={ref}\n      childId={documentId}\n      childPayload={template?.params}\n      childParameters={{\n        type: documentType,\n        parentRefPath: pathToString(parentRefPath),\n        ...(template && {template: template?.id}),\n      }}\n    >\n      {children}\n    </ChildLink>\n  )\n})\n","import React, {forwardRef, useContext, useMemo} from 'react'\nimport {PaneRouterContext} from './PaneRouterContext'\nimport {useUnique} from 'sanity'\nimport {StateLink} from 'sanity/router'\n\ninterface ParameterizedLinkProps {\n  params?: Record<string, string>\n  payload?: unknown\n  children?: React.ReactNode\n}\n\n/**\n * @internal\n */\nexport const ParameterizedLink = forwardRef(function ParameterizedLink(\n  props: ParameterizedLinkProps,\n  ref: React.ForwardedRef<HTMLAnchorElement>\n) {\n  const {routerPanesState: currentPanes, groupIndex, siblingIndex} = useContext(PaneRouterContext)\n  const {params, payload, ...rest} = props\n  const nextParams = useUnique(params)\n  const nextPayload = useUnique(payload)\n\n  const nextState = useMemo(() => {\n    const currentGroup = currentPanes[groupIndex]\n    const currentSibling = currentGroup[siblingIndex]\n\n    const nextSibling = {\n      ...currentSibling,\n      params: nextParams ?? currentSibling.params,\n      payload: nextPayload ?? currentSibling.payload,\n    }\n\n    const nextGroup = [\n      ...currentGroup.slice(0, siblingIndex),\n      nextSibling,\n      ...currentGroup.slice(siblingIndex + 1),\n    ]\n\n    const nextPanes = [\n      ...currentPanes.slice(0, groupIndex),\n      nextGroup,\n      ...currentPanes.slice(groupIndex + 1),\n    ]\n\n    return {panes: nextPanes}\n  }, [currentPanes, groupIndex, nextParams, nextPayload, siblingIndex])\n\n  return <StateLink ref={ref} {...rest} state={nextState} />\n})\n","import {useContext} from 'react'\nimport {PaneRouterContext} from './PaneRouterContext'\nimport {PaneRouterContextValue} from './types'\n\n/**\n *\n * @hidden\n * @beta\n */\nexport function usePaneRouter(): PaneRouterContextValue {\n  return useContext(PaneRouterContext)\n}\n","import React, {useCallback} from 'react'\nimport type {SanityDocument, SchemaType} from '@sanity/types'\nimport {PaneItemPreview} from '../paneItem/PaneItemPreview'\nimport {usePaneRouter} from '../paneRouter'\nimport {\n  FIXME,\n  PreviewCard,\n  getPublishedId,\n  useDocumentPresence,\n  useDocumentPreviewStore,\n} from 'sanity'\n\nconst EMPTY_ARRAY: [] = []\n\ninterface ReferencePreviewLinkProps {\n  onClick?: () => void\n  type: SchemaType & {icon?: any}\n  value: SanityDocument\n}\n\nexport function ReferencePreviewLink(props: ReferencePreviewLinkProps) {\n  const {onClick, type, value} = props\n  const publishedId = getPublishedId(value?._id)\n  const documentPresence = useDocumentPresence(publishedId)\n  const documentPreviewStore = useDocumentPreviewStore()\n  const {ReferenceChildLink} = usePaneRouter()\n\n  const Link = useCallback(\n    function LinkComponent(linkProps: {children: React.ReactNode}) {\n      return (\n        <ReferenceChildLink\n          documentId={value?._id}\n          documentType={type?.name}\n          parentRefPath={EMPTY_ARRAY}\n          {...linkProps}\n        />\n      )\n    },\n    [ReferenceChildLink, type?.name, value?._id]\n  )\n\n  return (\n    <PreviewCard\n      __unstable_focusRing\n      as={Link as FIXME}\n      data-as=\"a\"\n      onClick={onClick}\n      padding={2}\n      radius={2}\n    >\n      <PaneItemPreview\n        documentPreviewStore={documentPreviewStore}\n        icon={type?.icon}\n        layout=\"default\"\n        presence={documentPresence?.length > 0 ? documentPresence : EMPTY_ARRAY}\n        schemaType={type}\n        value={value}\n      />\n    </PreviewCard>\n  )\n}\n","import React from 'react'\nimport styled from 'styled-components'\nimport {rem, Flex, Text, Card, Box, Tooltip, Container, Inline} from '@sanity/ui'\nimport {InfoOutlineIcon} from '@sanity/icons'\n\nexport const ChevronWrapper = styled(Box)`\n  margin-left: auto;\n`\n\nexport const CrossDatasetReferencesDetails = styled.details`\n  flex: none;\n\n  &[open] ${ChevronWrapper} {\n    transform: rotate(180deg);\n  }\n`\n\nexport const CrossDatasetReferencesSummary = styled.summary`\n  list-style: none;\n\n  &::-webkit-details-marker {\n    display: none;\n  }\n`\n\nexport const TableContainer = styled(Box).attrs({paddingX: 2, paddingBottom: 2})`\n  overflow: auto;\n  max-height: 150px;\n`\n\nexport const Table = styled.table`\n  width: 100%;\n  text-align: left;\n  padding: 0 ${({theme}) => rem(theme.sanity.space[2])};\n  border-collapse: collapse;\n\n  th {\n    padding: ${({theme}) => rem(theme.sanity.space[1])};\n  }\n\n  thead > tr {\n    position: sticky;\n    top: 0;\n    background: var(--card-bg-color);\n    z-index: 1;\n  }\n\n  td {\n    padding: 0 ${({theme}) => rem(theme.sanity.space[1])};\n  }\n\n  tr > *:last-child {\n    text-align: right;\n  }\n`\n\nexport const DocumentIdFlex = styled(Flex)`\n  min-height: 35px;\n`\n\nexport const ReferencesCard = styled(Card).attrs({\n  radius: 2,\n  shadow: 1,\n  marginBottom: 4,\n  flex: 'auto',\n})`\n  overflow: hidden;\n  overflow: clip;\n  min-height: 150px;\n`\n\nexport const OtherReferenceCount = (props: {totalCount: number; references: unknown[]}) => {\n  const difference = props.totalCount - props.references.length\n\n  if (!difference) return null\n\n  return (\n    <Inline space={2}>\n      <Text size={1} muted>\n        {difference} other reference{difference === 1 ? '' : 's'} not shown{' '}\n      </Text>\n\n      <Tooltip\n        portal\n        placement=\"top\"\n        content={\n          <Container width={0}>\n            <Box padding={2}>\n              <Text size={1}>\n                We can't show metadata about these references because no token with access to the\n                datasets they are in was found.\n              </Text>\n            </Box>\n          </Container>\n        }\n      >\n        <Text size={1} muted>\n          <InfoOutlineIcon />\n        </Text>\n      </Tooltip>\n    </Inline>\n  )\n}\n","import React, {useCallback} from 'react'\nimport {\n  WarningOutlineIcon,\n  DocumentsIcon,\n  ClipboardIcon,\n  UnknownIcon,\n  ChevronDownIcon,\n} from '@sanity/icons'\nimport {useToast, Text, Box, Button, Flex, Label, Card, Stack} from '@sanity/ui'\nimport CopyToClipboard from 'react-copy-to-clipboard'\nimport {ReferencePreviewLink} from './ReferencePreviewLink'\nimport {ReferringDocuments} from './useReferringDocuments'\nimport {\n  ReferencesCard,\n  OtherReferenceCount,\n  CrossDatasetReferencesDetails,\n  CrossDatasetReferencesSummary,\n  TableContainer,\n  Table,\n  ChevronWrapper,\n  DocumentIdFlex,\n} from './ConfirmDeleteDialogBody.styles'\nimport {SanityDefaultPreview, useSchema} from 'sanity'\n\ntype DeletionConfirmationDialogBodyProps = Required<ReferringDocuments> & {\n  documentTitle: React.ReactNode\n  action: string\n  onReferenceLinkClick?: () => void\n}\n\n/**\n * The inner part of the `ConfirmDeleteDialog`. This is ran when both the\n * `crossDatasetReferences` and `internalReferences` are loaded.\n */\nexport function ConfirmDeleteDialogBody({\n  crossDatasetReferences,\n  internalReferences,\n  documentTitle,\n  totalCount,\n  action,\n  datasetNames,\n  hasUnknownDatasetNames,\n  onReferenceLinkClick,\n}: DeletionConfirmationDialogBodyProps) {\n  const schema = useSchema()\n  const toast = useToast()\n\n  const renderPreviewItem = useCallback(\n    (item: any) => {\n      const type = schema.get(item._type)\n      if (type) {\n        return <ReferencePreviewLink type={type} value={item} onClick={onReferenceLinkClick} />\n      }\n\n      return (\n        // Padding added to match the ReferencePreviewLink styling\n        <Box padding={2}>\n          <SanityDefaultPreview\n            icon={UnknownIcon}\n            title=\"Preview Unavailable\"\n            subtitle={`ID: ${item._id}`}\n            layout=\"default\"\n          />\n        </Box>\n      )\n    },\n    [schema, onReferenceLinkClick]\n  )\n\n  if (internalReferences?.totalCount === 0 && crossDatasetReferences?.totalCount === 0) {\n    return (\n      <Text as=\"p\">\n        Are you sure you want to {action} <strong>“{documentTitle}”</strong>?\n      </Text>\n    )\n  }\n\n  const documentCount =\n    crossDatasetReferences.totalCount === 1\n      ? '1 document'\n      : `${crossDatasetReferences.totalCount.toLocaleString()} documents`\n\n  // We do some extra checks to handle cases where you have unavailable dataset\n  // name(s) due to permissions, both alone and in combination with known datasets\n\n  // This normalizes one or more undefined dataset names to the catch-all `unavailable`\n  const normalizedDatasetNames = [\n    ...datasetNames,\n    ...(hasUnknownDatasetNames ? ['unavailable'] : []),\n  ]\n  const datasetsCount =\n    normalizedDatasetNames.length === 1\n      ? 'another dataset'\n      : `${normalizedDatasetNames.length} datasets`\n\n  let datasetNameList = `Dataset${\n    normalizedDatasetNames.length === 1 ? '' : 's'\n  }: ${normalizedDatasetNames.join(', ')}`\n\n  // We only have one dataset, and it is unavailable due to permissions\n  if (hasUnknownDatasetNames && normalizedDatasetNames.length === 1) {\n    datasetNameList = 'Unavailable dataset'\n  }\n\n  return (\n    <>\n      <Card padding={3} radius={2} tone=\"caution\" marginBottom={4} flex=\"none\">\n        <Flex>\n          <Text aria-hidden=\"true\" size={1}>\n            <WarningOutlineIcon />\n          </Text>\n          <Box flex={1} marginLeft={3}>\n            <Text size={1}>\n              {totalCount === 1 ? (\n                <>1 document refers to “{documentTitle}”</>\n              ) : (\n                <>\n                  {totalCount.toLocaleString()} documents refer to “{documentTitle}”\n                </>\n              )}\n            </Text>\n          </Box>\n        </Flex>\n      </Card>\n\n      <Box flex=\"none\" marginBottom={4}>\n        <Text>\n          You may not be able to {action} “{documentTitle}” because the following documents refer to\n          it:\n        </Text>\n      </Box>\n\n      <ReferencesCard>\n        <Flex direction=\"column\" height=\"fill\">\n          {internalReferences.totalCount > 0 && (\n            <Stack as=\"ul\" padding={3} space={3} overflow=\"auto\" data-testid=\"internal-references\">\n              {internalReferences?.references.map((item) => (\n                <Box as=\"li\" key={item._id}>\n                  {renderPreviewItem(item)}\n                </Box>\n              ))}\n\n              {internalReferences.totalCount > internalReferences.references.length && (\n                <Box as=\"li\" padding={3}>\n                  <OtherReferenceCount {...internalReferences} />\n                </Box>\n              )}\n            </Stack>\n          )}\n\n          {crossDatasetReferences.totalCount > 0 && (\n            <CrossDatasetReferencesDetails\n              data-testid=\"cross-dataset-references\"\n              style={{\n                // only add the border if needed\n                borderTop:\n                  internalReferences.totalCount > 0\n                    ? '1px solid var(--card-shadow-outline-color)'\n                    : undefined,\n              }}\n            >\n              <CrossDatasetReferencesSummary>\n                <Flex padding={4} align=\"center\">\n                  <Box marginRight={4}>\n                    <Text size={3}>\n                      <DocumentsIcon />\n                    </Text>\n                  </Box>\n                  <Flex marginRight={4} direction=\"column\">\n                    <Box marginBottom={2}>\n                      <Text>\n                        {documentCount} in {datasetsCount}\n                      </Text>\n                    </Box>\n                    <Box>\n                      <Text title={datasetNameList} textOverflow=\"ellipsis\" size={1} muted>\n                        {datasetNameList}\n                      </Text>\n                    </Box>\n                  </Flex>\n                  <ChevronWrapper>\n                    <Text muted>\n                      <ChevronDownIcon />\n                    </Text>\n                  </ChevronWrapper>\n                </Flex>\n              </CrossDatasetReferencesSummary>\n\n              <TableContainer>\n                <Table>\n                  <thead>\n                    <tr>\n                      <th>\n                        <Label muted size={0}>\n                          Project ID\n                        </Label>\n                      </th>\n                      <th>\n                        <Label muted size={0}>\n                          Dataset\n                        </Label>\n                      </th>\n                      <th>\n                        <Label muted size={0}>\n                          Document ID\n                        </Label>\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {crossDatasetReferences.references\n                      .filter((reference): reference is Required<typeof reference> => {\n                        return 'projectId' in reference\n                      })\n                      .map(({projectId, datasetName, documentId}, index) => (\n                        // eslint-disable-next-line react/no-array-index-key\n                        <tr key={`${documentId}-${index}`}>\n                          <td>\n                            <Text size={1}>{projectId}</Text>\n                          </td>\n                          <td>\n                            <Text size={1}>{datasetName || 'unavailable'}</Text>\n                          </td>\n                          <td>\n                            <DocumentIdFlex align=\"center\" gap={2} justify=\"flex-end\">\n                              <Text textOverflow=\"ellipsis\" size={1}>\n                                {documentId || 'unavailable'}\n                              </Text>\n                              {documentId && (\n                                <CopyToClipboard\n                                  text={documentId}\n                                  // eslint-disable-next-line react/jsx-no-bind\n                                  onCopy={() => {\n                                    // TODO: this isn't visible with the dialog open\n                                    toast.push({\n                                      title: 'Copied document ID to clipboard!',\n                                      status: 'success',\n                                    })\n                                  }}\n                                >\n                                  <Button\n                                    title=\"Copy ID to clipboard\"\n                                    mode=\"bleed\"\n                                    icon={ClipboardIcon}\n                                    fontSize={0}\n                                  />\n                                </CopyToClipboard>\n                              )}\n                            </DocumentIdFlex>\n                          </td>\n                        </tr>\n                      ))}\n                  </tbody>\n                </Table>\n                <Box padding={2}>\n                  <OtherReferenceCount {...crossDatasetReferences} />\n                </Box>\n              </TableContainer>\n            </CrossDatasetReferencesDetails>\n          )}\n        </Flex>\n      </ReferencesCard>\n\n      <Box flex=\"none\">\n        <Text>\n          If you {action} this document, documents that refer to it will no longer be able to access\n          it.\n        </Text>\n      </Box>\n    </>\n  )\n}\n","import React, {useMemo, useId} from 'react'\nimport styled from 'styled-components'\nimport {Box, Dialog, Button, Text, Spinner, Grid, Flex} from '@sanity/ui'\nimport {DocTitle} from '../DocTitle'\nimport {useReferringDocuments} from './useReferringDocuments'\nimport {ConfirmDeleteDialogBody} from './ConfirmDeleteDialogBody'\n\n/** @internal */\nexport const DialogBody = styled(Flex).attrs({\n  padding: 4,\n  direction: 'column',\n  height: 'fill',\n})`\n  box-sizing: border-box;\n`\n\n/** @internal */\nexport const LoadingContainer = styled(Flex).attrs({\n  align: 'center',\n  direction: 'column',\n  justify: 'center',\n})`\n  height: 300px;\n`\n\n/** @internal */\nexport interface ConfirmDeleteDialogProps {\n  /**\n   * Incoming document ID used to find other referencing documents. This\n   * field respects draft IDs (e.g. if you pass in a published ID when one\n   * doesn't exist the document title may not show up).\n   */\n  id: string\n  /**\n   * The schema typename of the incoming document\n   */\n  type: string\n  /**\n   * The name of the action being done. (e.g. the `'unpublish'` action requires\n   * the same document deletion confirmation).\n   */\n  action?: string\n  onCancel: () => void\n  onConfirm: () => void\n}\n\n/**\n * A confirmation dialog used to prevent unwanted document deletes. Loads all\n * the referencing internal and cross-data references prior to showing the\n * delete button.\n *\n * @internal\n */\nexport function ConfirmDeleteDialog({\n  id,\n  type,\n  action = 'delete',\n  onCancel,\n  onConfirm,\n}: ConfirmDeleteDialogProps) {\n  const dialogId = `deletion-confirmation-${useId()}`\n  const {\n    internalReferences,\n    crossDatasetReferences,\n    isLoading,\n    totalCount,\n    projectIds,\n    datasetNames,\n    hasUnknownDatasetNames,\n  } = useReferringDocuments(id)\n  const capitalizedAction = `${action.substring(0, 1).toUpperCase()}${action.substring(1)}`\n\n  const documentTitle = <DocTitle document={useMemo(() => ({_id: id, _type: type}), [id, type])} />\n  const showConfirmButton = !isLoading\n\n  return (\n    <Dialog\n      width={1}\n      id={dialogId}\n      header={`${capitalizedAction} document?`}\n      footer={\n        <Grid columns={showConfirmButton ? 2 : 1} gap={2} paddingX={4} paddingY={3}>\n          <Button mode=\"ghost\" onClick={onCancel} text=\"Cancel\" />\n\n          {showConfirmButton && (\n            <Button\n              data-testid=\"confirm-delete-button\"\n              text={totalCount > 0 ? `${capitalizedAction} anyway` : `${capitalizedAction} now`}\n              tone=\"critical\"\n              onClick={onConfirm}\n            />\n          )}\n        </Grid>\n      }\n      onClose={onCancel}\n      onClickOutside={onCancel}\n    >\n      <DialogBody>\n        {crossDatasetReferences && internalReferences && !isLoading ? (\n          <ConfirmDeleteDialogBody\n            crossDatasetReferences={crossDatasetReferences}\n            internalReferences={internalReferences}\n            documentTitle={documentTitle}\n            isLoading={isLoading}\n            totalCount={totalCount}\n            action={action}\n            projectIds={projectIds}\n            datasetNames={datasetNames}\n            hasUnknownDatasetNames={hasUnknownDatasetNames}\n            onReferenceLinkClick={onCancel}\n          />\n        ) : (\n          <LoadingContainer data-testid=\"loading-container\">\n            <Spinner muted />\n            <Box marginTop={3}>\n              <Text align=\"center\" muted size={1}>\n                Looking for referring documents…\n              </Text>\n            </Box>\n          </LoadingContainer>\n        )}\n      </DialogBody>\n    </Dialog>\n  )\n}\n","import React, {useCallback, useState, useId} from 'react'\nimport {Box, Flex, Button, Dialog, Text, ErrorBoundary} from '@sanity/ui'\nimport {ConfirmDeleteDialog, ConfirmDeleteDialogProps} from './ConfirmDeleteDialog'\n\nexport type {ConfirmDeleteDialogProps}\n\ntype ArgType<T> = T extends (arg: infer U) => unknown ? U : never\ntype ErrorInfo = ArgType<React.ComponentProps<typeof ErrorBoundary>['onCatch']>\n\n/** @internal */\nfunction ConfirmDeleteDialogContainer(props: ConfirmDeleteDialogProps) {\n  const id = useId()\n  const [error, setError] = useState<ErrorInfo | null>(null)\n  const handleRetry = useCallback(() => setError(null), [])\n\n  return error ? (\n    <Dialog\n      id={`dialog-error-${id}`}\n      data-testid=\"confirm-delete-error-dialog\"\n      header=\"Error\"\n      footer={\n        <Flex paddingX={4} paddingY={3} direction=\"column\">\n          <Button mode=\"ghost\" text=\"Retry\" onClick={handleRetry} />\n        </Flex>\n      }\n      onClose={props.onCancel}\n    >\n      <Box padding={4}>\n        <Text>An error occurred while loading referencing documents.</Text>\n      </Box>\n    </Dialog>\n  ) : (\n    <ErrorBoundary onCatch={setError}>\n      <ConfirmDeleteDialog {...props} />\n    </ErrorBoundary>\n  )\n}\n\nexport {ConfirmDeleteDialogContainer as ConfirmDeleteDialog}\n","import {EllipsisVerticalIcon} from '@sanity/icons'\nimport {Box, Button, Label, Menu, MenuButton, MenuDivider, MenuItem, PopoverProps} from '@sanity/ui'\nimport React, {forwardRef, Fragment, useCallback, useMemo, useId} from 'react'\nimport {PaneMenuItem, PaneMenuItemGroup} from '../../types'\nimport {IntentLink} from 'sanity/router'\n\ninterface PaneContextMenuButtonProps {\n  items: PaneMenuItem[]\n  itemGroups?: PaneMenuItemGroup[]\n  onAction: (action: PaneMenuItem) => void\n}\n\ninterface MenuItemGroup {\n  id: string\n  title?: React.ReactNode\n  items: PaneMenuItem[]\n}\n\nconst CONTEXT_MENU_POPOVER_PROPS: PopoverProps = {\n  constrainSize: true,\n  placement: 'bottom',\n  portal: true,\n  width: 0,\n}\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport function PaneContextMenuButton(props: PaneContextMenuButtonProps) {\n  const {items, itemGroups, onAction} = props\n  const id = useId()\n\n  const groups = useMemo(() => {\n    if (!itemGroups || itemGroups.length === 0) {\n      return [{id: '$default', items}]\n    }\n\n    const defaultGroup: MenuItemGroup = {id: '$default', items: []}\n\n    const groupMap = itemGroups.reduce((acc: Record<string, MenuItemGroup>, group) => {\n      acc[group.id] = {id: group.id, title: group.title, items: []}\n      return acc\n    }, {})\n\n    for (const item of items) {\n      const group = groupMap[item.group || '$default'] || defaultGroup\n\n      group.items.push(item)\n    }\n\n    return Object.values(groupMap)\n      .concat([defaultGroup])\n      .filter((g) => g.items.length > 0)\n  }, [items, itemGroups])\n\n  return (\n    <MenuButton\n      button={<Button icon={EllipsisVerticalIcon} mode=\"bleed\" padding={3} title=\"Show menu\" />}\n      id={id}\n      menu={\n        <Menu>\n          {groups.map((group, groupIndex) => (\n            // eslint-disable-next-line react/no-array-index-key\n            <Fragment key={groupIndex}>\n              {groupIndex > 0 && <MenuDivider />}\n              {group.title && (\n                <Box paddingX={3} paddingTop={3} paddingBottom={2}>\n                  <Label muted>{group.title}</Label>\n                </Box>\n              )}\n              {group.items.map((item, itemIndex) => (\n                <PaneContextMenuItem\n                  item={item}\n                  // eslint-disable-next-line react/no-array-index-key\n                  key={`${itemIndex}-${item.title}`}\n                  onAction={onAction}\n                />\n              ))}\n            </Fragment>\n          ))}\n        </Menu>\n      }\n      popover={CONTEXT_MENU_POPOVER_PROPS}\n    />\n  )\n}\n\nfunction PaneContextMenuItem(props: {\n  item: PaneMenuItem\n  onAction: (action: PaneMenuItem) => void\n}) {\n  const {item, onAction} = props\n\n  const handleClick = useCallback(() => {\n    onAction(item)\n  }, [item, onAction])\n\n  const hotkeys = useMemo(() => {\n    if (!item.shortcut) return undefined\n\n    return item.shortcut.split('+')\n  }, [item])\n\n  const IntentButtonOrActionButton = forwardRef((linkProps, linkRef: React.ForwardedRef<never>) =>\n    item.intent ? (\n      <IntentLink\n        {...linkProps}\n        intent={item.intent.type}\n        params={item.intent.params}\n        ref={linkRef}\n      />\n    ) : (\n      <MenuItem {...linkProps} pressed={item.selected} />\n    )\n  )\n\n  IntentButtonOrActionButton.displayName = 'Link'\n\n  return (\n    <MenuItem\n      as={IntentButtonOrActionButton}\n      data-as={item.intent ? 'a' : 'button'}\n      hotkeys={hotkeys}\n      icon={item.icon}\n      onClick={handleClick}\n      padding={0}\n      text={item.title}\n    />\n  )\n}\n","/**\n * @internal\n */\nexport const PANE_DEBUG = false\n\n/**\n * @internal\n */\nexport const PANE_COLLAPSED_WIDTH = 51\n\n/**\n * @internal\n */\nexport const PANE_DEFAULT_MIN_WIDTH = PANE_COLLAPSED_WIDTH * 4\n","import {createContext} from 'react'\nimport {PaneContextValue} from './types'\n\n/**\n * @internal\n */\nexport const PaneContext = createContext<PaneContextValue | null>(null)\n","import {createContext} from 'react'\nimport {PaneLayoutContextValue} from './types'\n\n/**\n * @internal\n */\nexport const PaneLayoutContext = createContext<PaneLayoutContextValue | null>(null)\n","import {useContext} from 'react'\nimport {PaneLayoutContext} from './PaneLayoutContext'\nimport {PaneLayoutContextValue} from './types'\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport function usePaneLayout(): PaneLayoutContextValue {\n  const pane = useContext(PaneLayoutContext)\n\n  if (!pane) {\n    throw new Error('PaneLayout: missing context value')\n  }\n\n  return pane\n}\n","import {Layer} from '@sanity/ui'\nimport React, {useCallback, useState} from 'react'\nimport styled from 'styled-components'\nimport {usePaneLayout} from './usePaneLayout'\n\nconst Root = styled(Layer)`\n  position: relative;\n  width: 1px;\n  min-width: 1px;\n\n  &:before {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    width: 1px;\n    background-color: var(--card-border-color);\n  }\n\n  &:not([data-disabled]) {\n    cursor: ew-resize;\n    width: 9px;\n    min-width: 9px;\n    margin: 0 -4px;\n\n    &:before {\n      left: 4px;\n    }\n\n    &:after {\n      content: '';\n      display: block;\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 9px;\n      bottom: 0;\n      background-color: var(--card-border-color);\n      opacity: 0;\n      transition: opacity 150ms;\n    }\n\n    &[data-dragging]:after,\n    &:hover:after {\n      opacity: 0.2;\n    }\n  }\n`\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport function PaneDivider({\n  disabled,\n  element,\n}: {\n  disabled?: boolean\n  element: HTMLElement | null\n}) {\n  const {resize} = usePaneLayout()\n  const [dragging, setDragging] = useState(false)\n\n  const handleMouseDown = useCallback(\n    (event: any) => {\n      if (!element) return\n\n      setDragging(true)\n\n      event.preventDefault()\n\n      const startX = event.pageX\n\n      resize('start', element, 0)\n\n      const handleMouseMove = (e: MouseEvent) => {\n        e.preventDefault()\n\n        const deltaX = e.pageX - startX\n\n        resize('move', element, deltaX)\n      }\n\n      const handleMouseUp = (e: MouseEvent) => {\n        e.preventDefault()\n\n        setDragging(false)\n\n        window.removeEventListener('mousemove', handleMouseMove)\n        window.removeEventListener('mouseup', handleMouseUp)\n\n        resize('end', element, 0)\n      }\n\n      window.addEventListener('mousemove', handleMouseMove)\n      window.addEventListener('mouseup', handleMouseUp)\n    },\n    [element, resize]\n  )\n\n  return (\n    <Root\n      data-disabled={disabled ? '' : undefined}\n      data-dragging={dragging ? '' : undefined}\n      onMouseDown={handleMouseDown}\n    />\n  )\n}\n","import {BoundaryElementProvider, Card, CardProps, Code, Flex, useForwardedRef} from '@sanity/ui'\nimport React, {forwardRef, useMemo, useState, useCallback, useEffect} from 'react'\nimport styled from 'styled-components'\nimport {PANE_COLLAPSED_WIDTH, PANE_DEBUG, PANE_DEFAULT_MIN_WIDTH} from './constants'\nimport {PaneContext} from './PaneContext'\nimport {PaneDivider} from './PaneDivider'\nimport {usePaneLayout} from './usePaneLayout'\nimport {LegacyLayerProvider} from 'sanity'\n\ninterface PaneProps {\n  children?: React.ReactNode\n  currentMinWidth?: number\n  currentMaxWidth?: number\n  flex?: number\n  id: string\n  minWidth?: number\n  maxWidth?: number\n  selected?: boolean\n}\n\nconst Root = styled(Card)`\n  outline: none;\n\n  // NOTE: This will render a border to the right side of each pane\n  // without taking up physical space.\n  box-shadow: 1px 0 0 var(--card-border-color);\n`\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\n// eslint-disable-next-line complexity\nexport const Pane = forwardRef(function Pane(\n  props: PaneProps &\n    Omit<CardProps, 'as' | 'overflow'> &\n    Omit<React.HTMLProps<HTMLDivElement>, 'as' | 'height' | 'hidden' | 'id' | 'style'>,\n  ref: React.ForwardedRef<HTMLDivElement>\n) {\n  const {\n    children,\n    currentMinWidth: currentMinWidthProp,\n    currentMaxWidth: currentMaxWidthProp,\n    flex: flexProp = 1,\n    id,\n    minWidth: minWidthProp,\n    maxWidth: maxWidthProp,\n    selected = false,\n    ...restProps\n  } = props\n  const [rootElement, setRootElement] = useState<HTMLDivElement | null>(null)\n  const {\n    collapse,\n    collapsed: layoutCollapsed,\n    expand,\n    expandedElement,\n    mount,\n    panes,\n  } = usePaneLayout()\n  const pane = panes.find((p) => p.element === rootElement)\n  const paneIndex = pane && panes.indexOf(pane)\n  const nextPane = typeof paneIndex === 'number' ? panes[paneIndex + 1] : undefined\n  const isLast = paneIndex === panes.length - 1\n  const expanded = expandedElement === rootElement\n  const collapsed = layoutCollapsed ? false : pane?.collapsed || false\n  const nextCollapsed = nextPane?.collapsed || false\n  const forwardedRef = useForwardedRef(ref)\n  const flex = pane?.flex ?? flexProp\n  const currentMinWidth = pane?.currentMinWidth ?? currentMinWidthProp\n  const currentMaxWidth = pane?.currentMaxWidth ?? currentMaxWidthProp\n\n  const setRef = useCallback(\n    (refValue: HTMLDivElement | null) => {\n      setRootElement(refValue)\n      forwardedRef.current = refValue\n    },\n    [forwardedRef]\n  )\n\n  useEffect(() => {\n    if (!rootElement) return undefined\n    return mount(rootElement, {\n      currentMinWidth: currentMinWidthProp,\n      currentMaxWidth: currentMaxWidthProp,\n      flex: flexProp,\n      id,\n      minWidth: minWidthProp,\n      maxWidth: maxWidthProp,\n    })\n  }, [\n    currentMinWidthProp,\n    currentMaxWidthProp,\n    flexProp,\n    id,\n    minWidthProp,\n    maxWidthProp,\n    mount,\n    rootElement,\n  ])\n\n  const handleCollapse = useCallback(() => {\n    if (!rootElement) return\n    collapse(rootElement)\n  }, [collapse, rootElement])\n\n  const handleExpand = useCallback(() => {\n    if (!rootElement) return\n    expand(rootElement)\n  }, [expand, rootElement])\n\n  const contextValue = useMemo(\n    () => ({\n      collapse: handleCollapse,\n      collapsed: layoutCollapsed ? false : collapsed,\n      expand: handleExpand,\n      index: paneIndex,\n      isLast,\n      rootElement,\n    }),\n    [collapsed, handleCollapse, handleExpand, isLast, layoutCollapsed, paneIndex, rootElement]\n  )\n\n  const minWidth = useMemo(() => {\n    if (layoutCollapsed) {\n      return undefined\n    }\n\n    if (collapsed) return PANE_COLLAPSED_WIDTH\n\n    if (currentMinWidth === 0) {\n      return minWidthProp || PANE_DEFAULT_MIN_WIDTH\n    }\n\n    if (isLast) {\n      return minWidthProp || PANE_DEFAULT_MIN_WIDTH\n    }\n\n    return currentMinWidth || minWidthProp || PANE_DEFAULT_MIN_WIDTH\n  }, [collapsed, currentMinWidth, isLast, layoutCollapsed, minWidthProp])\n\n  const maxWidth = useMemo(() => {\n    if (collapsed) return PANE_COLLAPSED_WIDTH\n\n    if (layoutCollapsed && isLast) {\n      return undefined\n    }\n\n    if (isLast) {\n      if (maxWidthProp) {\n        return currentMaxWidth ?? maxWidthProp\n      }\n\n      return undefined\n    }\n\n    return currentMaxWidth ?? maxWidthProp\n  }, [collapsed, currentMaxWidth, isLast, layoutCollapsed, maxWidthProp])\n\n  const hidden = layoutCollapsed && !isLast\n\n  const divider = useMemo(\n    () =>\n      !isLast &&\n      !layoutCollapsed && (\n        <LegacyLayerProvider zOffset=\"paneResizer\">\n          <PaneDivider disabled={collapsed || nextCollapsed} element={rootElement} />\n        </LegacyLayerProvider>\n      ),\n    [collapsed, isLast, layoutCollapsed, nextCollapsed, rootElement]\n  )\n\n  const style = useMemo(\n    () => ({\n      flex,\n      minWidth,\n      maxWidth: maxWidth === Infinity ? undefined : maxWidth,\n    }),\n    [flex, minWidth, maxWidth]\n  )\n\n  return (\n    <>\n      <LegacyLayerProvider zOffset=\"pane\">\n        <PaneContext.Provider value={contextValue}>\n          <Root\n            data-testid=\"pane\"\n            tone=\"inherit\"\n            hidden={hidden}\n            id={id}\n            overflow={layoutCollapsed ? undefined : 'hidden'}\n            {...restProps}\n            data-pane-collapsed={collapsed ? '' : undefined}\n            data-pane-index={paneIndex}\n            data-pane-selected={selected ? '' : undefined}\n            ref={setRef}\n            style={style}\n          >\n            {PANE_DEBUG && (\n              <Card padding={4} tone={expanded ? 'primary' : 'caution'}>\n                <Code size={1}>\n                  {[\n                    `#${paneIndex}`,\n                    `collapsed=${collapsed}`,\n                    `currentMinWidth=${currentMinWidth}`,\n                    `currentMaxWidth=${currentMaxWidth}`,\n                    `flex=${flex}`,\n                    `minWidth=${minWidth}`,\n                    `maxWidth=${maxWidth}`,\n                  ].join('\\n')}\n                </Code>\n              </Card>\n            )}\n\n            <BoundaryElementProvider element={rootElement}>\n              {!hidden && (\n                <Flex direction=\"column\" height=\"fill\">\n                  {children}\n                </Flex>\n              )}\n            </BoundaryElementProvider>\n          </Root>\n        </PaneContext.Provider>\n      </LegacyLayerProvider>\n\n      {divider}\n    </>\n  )\n})\n","import {useContext} from 'react'\nimport {PaneContext} from './PaneContext'\nimport {PaneContextValue} from './types'\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport function usePane(): PaneContextValue {\n  const pane = useContext(PaneContext)\n\n  if (!pane) {\n    throw new Error('Pane: missing context value')\n  }\n\n  return pane\n}\n","import {Card} from '@sanity/ui'\nimport styled from 'styled-components'\n\nexport const Root = styled(Card)`\n  position: relative;\n  outline: none;\n`\n\nRoot.displayName = 'PaneContent__root'\n","import {BoxOverflow} from '@sanity/ui'\nimport React, {forwardRef} from 'react'\nimport {usePane} from './usePane'\nimport {usePaneLayout} from './usePaneLayout'\nimport {Root} from './PaneContent.styles'\n\ninterface PaneContentProps {\n  as?: React.ElementType | keyof JSX.IntrinsicElements\n  overflow?: BoxOverflow\n  padding?: number | number[]\n}\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport const PaneContent = forwardRef(function PaneContent(\n  props: PaneContentProps & Omit<React.HTMLProps<HTMLDivElement>, 'as' | 'height' | 'ref'>,\n  ref: React.ForwardedRef<HTMLDivElement>\n) {\n  const {as, children, overflow, padding, ...restProps} = props\n  const {collapsed} = usePane()\n  const {collapsed: layoutCollapsed} = usePaneLayout()\n\n  return (\n    <Root\n      data-testid=\"pane-content\"\n      forwardedAs={as}\n      {...restProps}\n      flex={1}\n      hidden={collapsed}\n      overflow={layoutCollapsed ? undefined : overflow}\n      padding={padding}\n      ref={ref}\n      tone=\"inherit\"\n    >\n      {children}\n    </Root>\n  )\n})\n","import {Card, Layer} from '@sanity/ui'\nimport styled from 'styled-components'\n\nexport const Root = styled(Layer)`\n  position: sticky;\n  bottom: 0;\n\n  &:before {\n    content: '';\n    display: block;\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: -1px;\n    border-bottom: 1px solid var(--card-shadow-outline-color);\n  }\n`\n\nexport const RootCard = styled(Card)`\n  padding-bottom: env(safe-area-inset-bottom);\n`\n","import {Box} from '@sanity/ui'\nimport React, {forwardRef} from 'react'\nimport {usePane} from './usePane'\nimport {Root, RootCard} from './PaneFooter.styles'\nimport {LegacyLayerProvider} from 'sanity'\n\ninterface PaneFooterProps {\n  children?: React.ReactNode\n  padding?: number | number[]\n}\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport const PaneFooter = forwardRef(function PaneFooter(\n  props: PaneFooterProps,\n  ref: React.ForwardedRef<HTMLDivElement>\n) {\n  const {children, padding} = props\n  const {collapsed} = usePane()\n\n  return (\n    <LegacyLayerProvider zOffset=\"paneFooter\">\n      <Root data-testid=\"pane-footer\" hidden={collapsed} ref={ref}>\n        <RootCard tone=\"inherit\">\n          <Box padding={padding}>{children}</Box>\n        </RootCard>\n      </Root>\n    </LegacyLayerProvider>\n  )\n})\n","import {Box, Flex, Layer, rgba, TextSkeleton, Text, Theme, Card} from '@sanity/ui'\nimport styled, {css} from 'styled-components'\n\nexport const Root = styled(Layer)`\n  line-height: 0;\n  position: sticky;\n  top: 0;\n\n  &:not([data-collapsed]):after {\n    content: '';\n    display: block;\n    position: absolute;\n    left: 0;\n    right: 0;\n    bottom: -1px;\n    border-bottom: 1px solid var(--card-shadow-outline-color);\n  }\n`\n\nexport const Layout = styled(Flex)`\n  transform-origin: calc(51px / 2);\n\n  [data-collapsed] > div > & {\n    transform: rotate(90deg);\n  }\n`\n\nexport const TitleCard = styled(Card)(({theme}: {theme: Theme}) => {\n  const {fg, bg} = theme.sanity.color.card.enabled\n\n  // Disable color updates on hover\n  return css`\n    background-color: ${bg};\n\n    [data-ui='Text'] {\n      color: ${fg};\n    }\n  `\n})\n\nexport const TitleTextSkeleton = styled(TextSkeleton)`\n  width: 66%;\n  max-width: 175px;\n`\n\nexport const TitleText = styled(Text)`\n  cursor: default;\n  outline: none;\n`\n\nexport const TabsBox = styled(Box)(({theme}: {theme: Theme}) => {\n  const {color, space} = theme.sanity\n\n  return css`\n    overflow: hidden;\n    overflow: clip;\n    position: relative;\n\n    & > div {\n      white-space: nowrap;\n      overflow: auto;\n      /* Hide scrollbars */\n      scrollbar-width: none;\n      &::-webkit-scrollbar {\n        width: 0;\n        height: 0;\n      }\n    }\n\n    /* right padding */\n    & > div:after {\n      content: '';\n      display: inline-block;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      width: ${space[3]}px;\n      height: 1px;\n    }\n\n    /* Gradient that makes it look like tabs disappear into nothing (looks nicer) */\n    &:after {\n      content: '';\n      display: block;\n      position: absolute;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      background: linear-gradient(to right, ${rgba(color.base.bg, 0)}, var(--card-bg-color));\n      width: ${space[3]}px;\n      pointer-events: none;\n    }\n  `\n})\n","import {useElementRect, Box, Card, Flex, LayerProvider} from '@sanity/ui'\nimport React, {useMemo, useCallback, forwardRef} from 'react'\nimport {usePane} from './usePane'\nimport {Layout, Root, TabsBox, TitleCard, TitleTextSkeleton, TitleText} from './PaneHeader.styles'\nimport {LegacyLayerProvider} from 'sanity'\n\ninterface PaneHeaderProps {\n  actions?: React.ReactNode\n  backButton?: React.ReactNode\n  contentAfter?: React.ReactNode\n  loading?: boolean\n  subActions?: React.ReactNode\n  tabIndex?: number\n  tabs?: React.ReactNode\n  title: React.ReactNode\n}\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport const PaneHeader = forwardRef(function PaneHeader(\n  props: PaneHeaderProps,\n  ref: React.ForwardedRef<HTMLDivElement>\n) {\n  const {actions, backButton, contentAfter, loading, subActions, tabs, tabIndex, title} = props\n  const {collapse, collapsed, expand, rootElement: paneElement} = usePane()\n  const paneRect = useElementRect(paneElement || null)\n\n  const layoutStyle = useMemo(\n    () => ({\n      width: collapsed ? paneRect?.height || window.innerHeight : undefined,\n    }),\n    [collapsed, paneRect]\n  )\n\n  const handleTitleClick = useCallback(() => {\n    if (collapsed) return\n    collapse()\n  }, [collapse, collapsed])\n\n  const handleLayoutClick = useCallback(() => {\n    if (!collapsed) return\n    expand()\n  }, [collapsed, expand])\n\n  return (\n    <LayerProvider zOffset={100}>\n      <Root data-collapsed={collapsed ? '' : undefined} data-testid=\"pane-header\" ref={ref}>\n        <LegacyLayerProvider zOffset=\"paneHeader\">\n          <Card data-collapsed={collapsed ? '' : undefined} tone=\"inherit\">\n            <Layout onClick={handleLayoutClick} padding={2} sizing=\"border\" style={layoutStyle}>\n              {backButton}\n\n              <TitleCard\n                __unstable_focusRing\n                flex={1}\n                forwardedAs=\"button\"\n                onClick={handleTitleClick}\n                paddingLeft={backButton ? 1 : 3}\n                paddingY={3}\n                tabIndex={tabIndex}\n              >\n                {loading && <TitleTextSkeleton animated radius={1} />}\n                {!loading && (\n                  <TitleText textOverflow=\"ellipsis\" weight=\"semibold\">\n                    {title}\n                  </TitleText>\n                )}\n              </TitleCard>\n\n              {actions && (\n                <Box hidden={collapsed} paddingLeft={1}>\n                  <LegacyLayerProvider zOffset=\"paneHeader\">{actions}</LegacyLayerProvider>\n                </Box>\n              )}\n            </Layout>\n\n            {(tabs || subActions) && (\n              <Flex\n                align=\"center\"\n                hidden={collapsed}\n                overflow=\"auto\"\n                paddingBottom={3}\n                paddingX={3}\n                paddingTop={1}\n              >\n                <TabsBox flex={1} marginRight={subActions ? 3 : 0}>\n                  {tabs}\n                </TabsBox>\n\n                {subActions && subActions}\n              </Flex>\n            )}\n\n            {!collapsed && contentAfter && contentAfter}\n          </Card>\n        </LegacyLayerProvider>\n      </Root>\n    </LayerProvider>\n  )\n})\n","import {Card} from '@sanity/ui'\nimport styled from 'styled-components'\n\nexport const Root = styled(Card)`\n  transition: opacity 200ms;\n  position: relative;\n  z-index: 1;\n  padding-left: env(safe-area-inset-left);\n  padding-right: env(safe-area-inset-right);\n  opacity: 0;\n\n  &:not([hidden]) {\n    display: flex;\n  }\n\n  &:not([data-collapsed]) {\n    overflow: auto;\n  }\n\n  &[data-mounted] {\n    opacity: 1;\n  }\n\n  &[data-resizing] {\n    pointer-events: none;\n  }\n`\n","import {Button} from '@sanity/ui'\nimport React, {forwardRef, useMemo} from 'react'\nimport {PaneMenuItem} from '../types'\nimport {IntentLink} from 'sanity/router'\n\ntype RouterIntent = NonNullable<PaneMenuItem['intent']>\n\nexport const IntentButton = forwardRef(function IntentButton(\n  props: {intent: RouterIntent} & Omit<React.ComponentProps<typeof Button>, 'as' | 'href' | 'type'>,\n  ref: React.ForwardedRef<HTMLAnchorElement>\n) {\n  const {intent, ...restProps} = props\n\n  const Link = useMemo(\n    () =>\n      // eslint-disable-next-line @typescript-eslint/no-shadow\n      forwardRef(function Link(\n        linkProps: {children: React.ReactNode},\n        linkRef: React.ForwardedRef<HTMLAnchorElement>\n      ) {\n        return (\n          <IntentLink {...linkProps} intent={intent.type} params={intent.params} ref={linkRef} />\n        )\n      }),\n    [intent]\n  )\n\n  return props.disabled ? (\n    <Button {...props} as=\"a\" role=\"link\" aria-disabled=\"true\" />\n  ) : (\n    <Button\n      {...restProps}\n      as={Link}\n      data-as=\"a\"\n      ref={ref as React.ForwardedRef<HTMLButtonElement>}\n    />\n  )\n})\n","import {Tooltip, Text, Box} from '@sanity/ui'\nimport React from 'react'\nimport {useCurrentUser, InsufficientPermissionsMessage} from 'sanity'\n\ninterface InsufficientPermissionsMessageTooltipProps {\n  reveal: boolean\n  loading: boolean\n  children: React.ReactNode\n}\n\nexport function InsufficientPermissionsMessageTooltip({\n  reveal,\n  loading,\n  children,\n}: InsufficientPermissionsMessageTooltipProps) {\n  const currentUser = useCurrentUser()\n\n  if (!reveal) {\n    return <>{children}</>\n  }\n\n  return (\n    <Tooltip\n      content={\n        loading ? (\n          <Box padding={2}>\n            <Text>Loading…</Text>\n          </Box>\n        ) : (\n          <InsufficientPermissionsMessage currentUser={currentUser} />\n        )\n      }\n      portal\n    >\n      {/* this wrapping div is to allow mouse events */}\n      {/* while the child element is disabled */}\n      <div>{children}</div>\n    </Tooltip>\n  )\n}\n","import {ComposeIcon} from '@sanity/icons'\nimport React, {useMemo, forwardRef} from 'react'\nimport {Box, Button, Label, Menu, MenuButton, MenuItem, PopoverProps} from '@sanity/ui'\nimport {Schema} from '@sanity/types'\nimport {IntentButton} from '../IntentButton'\nimport {InsufficientPermissionsMessageTooltip} from './InsufficientPermissionsMessageTooltip'\nimport {IntentLink} from 'sanity/router'\nimport {\n  useTemplatePermissions,\n  TemplatePermissionsResult,\n  Template,\n  InitialValueTemplateItem,\n  useSchema,\n  useTemplates,\n} from 'sanity'\n\nexport type PaneHeaderIntentProps = React.ComponentProps<typeof IntentButton>['intent']\n\nconst POPOVER_PROPS: PopoverProps = {\n  constrainSize: true,\n  placement: 'bottom',\n  portal: true,\n}\n\nconst getIntent = (\n  schema: Schema,\n  templates: Template[],\n  item: InitialValueTemplateItem\n): PaneHeaderIntentProps | null => {\n  const typeName = templates.find((t) => t.id === item.templateId)?.schemaType\n  if (!typeName) return null\n\n  const baseParams = {\n    template: item.templateId,\n    type: typeName,\n    id: item.initialDocumentId,\n  }\n\n  return {\n    type: 'create',\n    params: item.parameters ? [baseParams, item.parameters] : baseParams,\n  }\n}\n\ninterface PaneHeaderCreateButtonProps {\n  templateItems: InitialValueTemplateItem[]\n}\n\nexport function PaneHeaderCreateButton({templateItems}: PaneHeaderCreateButtonProps) {\n  const schema = useSchema()\n  const templates = useTemplates()\n\n  const [templatePermissions, isTemplatePermissionsLoading] = useTemplatePermissions({\n    templateItems,\n  })\n\n  const nothingGranted = useMemo(() => {\n    return (\n      !isTemplatePermissionsLoading &&\n      templatePermissions?.every((permission) => !permission.granted)\n    )\n  }, [isTemplatePermissionsLoading, templatePermissions])\n\n  const permissionsById = useMemo(() => {\n    if (!templatePermissions) return {}\n    return templatePermissions.reduce<Record<string, TemplatePermissionsResult | undefined>>(\n      (acc, permission) => {\n        acc[permission.id] = permission\n        return acc\n      },\n      {}\n    )\n  }, [templatePermissions])\n\n  if (nothingGranted) {\n    return (\n      <InsufficientPermissionsMessageTooltip reveal loading={isTemplatePermissionsLoading}>\n        <Button\n          aria-label=\"Insufficient permissions\"\n          icon={ComposeIcon}\n          mode=\"bleed\"\n          disabled\n          data-testid=\"action-intent-button\"\n        />\n      </InsufficientPermissionsMessageTooltip>\n    )\n  }\n\n  if (templateItems.length === 1) {\n    const firstItem = templateItems[0]\n    const permissions = permissionsById[firstItem.id]\n    const disabled = !permissions?.granted\n    const intent = getIntent(schema, templates, firstItem)\n    if (!intent) return null\n\n    return (\n      <InsufficientPermissionsMessageTooltip\n        reveal={disabled}\n        loading={isTemplatePermissionsLoading}\n      >\n        <IntentButton\n          aria-label={firstItem.title}\n          icon={firstItem.icon || ComposeIcon}\n          intent={intent}\n          mode=\"bleed\"\n          disabled={disabled}\n          data-testid=\"action-intent-button\"\n        />\n      </InsufficientPermissionsMessageTooltip>\n    )\n  }\n\n  return (\n    <MenuButton\n      button={\n        <Button\n          icon={ComposeIcon}\n          mode=\"bleed\"\n          padding={3}\n          data-testid=\"multi-action-intent-button\"\n        />\n      }\n      id=\"create-menu\"\n      menu={\n        <Menu>\n          <Box paddingX={3} paddingTop={3} paddingBottom={2}>\n            <Label muted>Create</Label>\n          </Box>\n\n          {templateItems.map((item, itemIndex) => {\n            const permissions = permissionsById[item.id]\n            const disabled = !permissions?.granted\n            const intent = getIntent(schema, templates, item)\n            const template = templates.find((t) => t.id === item.templateId)\n            if (!template || !intent) return null\n\n            const Link = forwardRef((linkProps, linkRef: React.ForwardedRef<never>) =>\n              disabled ? (\n                <button type=\"button\" disabled {...linkProps} ref={linkRef} />\n              ) : (\n                <IntentLink\n                  {...linkProps}\n                  intent={intent.type}\n                  params={intent.params}\n                  ref={linkRef}\n                />\n              )\n            )\n\n            Link.displayName = 'Link'\n\n            return (\n              <InsufficientPermissionsMessageTooltip\n                key={item.id}\n                reveal={disabled}\n                loading={isTemplatePermissionsLoading}\n              >\n                <MenuItem\n                  as={Link}\n                  data-as={disabled ? 'button' : 'a'}\n                  text={item.title || template.title}\n                  aria-label={disabled ? 'Insufficient permissions' : item.title || template.title}\n                  disabled={disabled}\n                  data-testid={`action-intent-button-${itemIndex}`}\n                />\n              </InsufficientPermissionsMessageTooltip>\n            )\n          })}\n        </Menu>\n      }\n      popover={POPOVER_PROPS}\n    />\n  )\n}\n","import {UnknownIcon} from '@sanity/icons'\nimport {Box, Button, Inline, Text, Tooltip} from '@sanity/ui'\nimport {partition, uniqBy} from 'lodash'\nimport React, {memo, useCallback, useMemo} from 'react'\nimport {DeskToolPaneActionHandler, PaneMenuItem, PaneMenuItemGroup} from '../../types'\nimport {IntentButton} from '../IntentButton'\nimport {PaneContextMenuButton} from '../pane/PaneContextMenuButton'\nimport {PaneHeaderCreateButton} from './PaneHeaderCreateButton'\nimport {useTemplates, InitialValueTemplateItem} from 'sanity'\n\n// to preserve memory references\nconst emptyArray: never[] = []\nconst emptyObject = {}\n\nfunction isNonNullable<T>(value: T): value is NonNullable<T> {\n  return value !== null && value !== undefined\n}\n\n/**\n * hashes an object to a string where the order of the keys don't matter\n */\nconst hashObject = (value: unknown) => {\n  const sortObject = (v: unknown): unknown => {\n    if (typeof v !== 'object' || !v) return v\n    if (Array.isArray(v)) return v.map(sortObject)\n    return Object.entries(v).sort(([keyA], [keyB]) => keyA.localeCompare(keyB, 'en'))\n  }\n\n  const normalize = (v: unknown) => JSON.parse(JSON.stringify(v))\n\n  return JSON.stringify(sortObject(normalize(value)))\n}\n\ninterface PaneHeaderActionsProps {\n  initialValueTemplateItems?: InitialValueTemplateItem[]\n  menuItems?: PaneMenuItem[]\n  menuItemGroups?: PaneMenuItemGroup[]\n  actionHandlers?: Record<string, DeskToolPaneActionHandler>\n}\n\nexport const PaneHeaderActions = memo(\n  ({\n    initialValueTemplateItems: initialValueTemplateItemsFromStructure = emptyArray,\n    menuItems = emptyArray,\n    menuItemGroups = emptyArray,\n    actionHandlers = emptyObject,\n  }: PaneHeaderActionsProps) => {\n    const templates = useTemplates()\n\n    const handleAction = useCallback(\n      (item: PaneMenuItem) => {\n        if (typeof item.action === 'string' && !(item.action in actionHandlers)) {\n          console.warn('No handler for action:', item.action)\n          return false\n        }\n\n        const handler =\n          // eslint-disable-next-line no-nested-ternary\n          typeof item.action === 'function'\n            ? item.action\n            : typeof item.action === 'string'\n            ? actionHandlers[item.action]\n            : null\n\n        if (handler) {\n          handler(item.params as Record<string, string>)\n          return true\n        }\n\n        return false\n      },\n      [actionHandlers]\n    )\n\n    const [actionMenuItems, contextMenuItems] = useMemo(() => {\n      const nonCreateMenuItem = menuItems\n        // remove items with `create` intents because those will get combined\n        // into one action button later\n        .filter((item) => item.intent?.type !== 'create')\n\n      return partition(nonCreateMenuItem, (item) => item.showAsAction)\n    }, [menuItems])\n\n    const initialValueTemplateItemFromMenuItems = useMemo(() => {\n      return menuItems\n        .map((item, menuItemIndex) => {\n          if (item.intent?.type !== 'create') return null\n\n          const {params} = item.intent\n          if (!params) return null\n\n          const intentParams = Array.isArray(params) ? params[0] : params\n          const templateParams = Array.isArray(params) ? params[1] : undefined\n\n          // fallback to the schema type name as the template ID.\n          // by default, the initial template values are populated from every\n          // document type in the schema\n          const templateId = intentParams.template || intentParams.type\n          if (!templateId) return null\n\n          // eslint-disable-next-line max-nested-callbacks\n          const template = templates.find((t) => t.id === templateId)\n          // the template doesn't exist then the action might be disabled\n          if (!template) return null\n\n          const initialDocumentId = intentParams.id\n\n          return {\n            item,\n            template,\n            templateParams,\n            menuItemIndex,\n            initialDocumentId,\n          }\n        })\n        .filter(isNonNullable)\n        .map(({initialDocumentId, item, template, menuItemIndex, templateParams}) => {\n          const initialValueTemplateItem: InitialValueTemplateItem = {\n            id: `menuItem${menuItemIndex}`,\n            initialDocumentId,\n            templateId: template.id,\n            type: 'initialValueTemplateItem',\n            title: item.title || template.title,\n            icon: item.icon as InitialValueTemplateItem['icon'],\n            description: template.description,\n            parameters: templateParams,\n            schemaType: template.schemaType,\n          }\n\n          return initialValueTemplateItem\n        })\n    }, [menuItems, templates])\n\n    const combinedInitialValueTemplates = useMemo(() => {\n      // this de-dupes create actions\n      return uniqBy(\n        [...initialValueTemplateItemFromMenuItems, ...initialValueTemplateItemsFromStructure],\n        (item) => hashObject([item.initialDocumentId, item.templateId, item.parameters])\n      )\n    }, [initialValueTemplateItemFromMenuItems, initialValueTemplateItemsFromStructure])\n\n    return (\n      <Inline space={1}>\n        {[\n          Boolean(combinedInitialValueTemplates.length) && (\n            <PaneHeaderCreateButton\n              key=\"$CreateMenuButton\"\n              templateItems={combinedInitialValueTemplates}\n            />\n          ),\n          //\n          ...actionMenuItems.map((actionItem, actionIndex) => {\n            return (\n              <Tooltip\n                content={\n                  <Box padding={2}>\n                    <Text size={1}>{actionItem.title}</Text>\n                  </Box>\n                }\n                // eslint-disable-next-line react/no-array-index-key\n                key={`${actionIndex}-${actionItem.title}`}\n                placement=\"bottom\"\n              >\n                {actionItem.intent ? (\n                  <IntentButton\n                    intent={actionItem.intent}\n                    aria-label={actionItem.title}\n                    icon={actionItem.icon || UnknownIcon}\n                    mode=\"bleed\"\n                  />\n                ) : (\n                  <Button\n                    aria-label={actionItem.title}\n                    icon={actionItem.icon || UnknownIcon}\n                    mode=\"bleed\"\n                    // eslint-disable-next-line react/jsx-no-bind\n                    onClick={() => handleAction(actionItem)}\n                  />\n                )}\n              </Tooltip>\n            )\n          }),\n          //\n          Boolean(contextMenuItems.length) && (\n            <PaneContextMenuButton\n              items={contextMenuItems}\n              itemGroups={menuItemGroups}\n              key=\"$ContextMenu\"\n              onAction={handleAction}\n            />\n          ),\n        ]}\n      </Inline>\n    )\n  }\n)\n\nPaneHeaderActions.displayName = 'PaneHeaderActions'\n","/* eslint-disable import/no-extraneous-dependencies */\n\nimport {TrashIcon} from '@sanity/icons'\nimport React, {useCallback, useState} from 'react'\nimport {ConfirmDeleteDialog} from '../components'\nimport {\n  DocumentActionComponent,\n  InsufficientPermissionsMessage,\n  useCurrentUser,\n  useDocumentOperation,\n  useDocumentPairPermissions,\n} from 'sanity'\n\nconst DISABLED_REASON_TITLE = {\n  NOTHING_TO_DELETE: 'This document doesn’t yet exist or is already deleted',\n}\n\n/** @internal */\nexport const DeleteAction: DocumentActionComponent = ({id, type, draft, onComplete}) => {\n  const {delete: deleteOp} = useDocumentOperation(id, type)\n  const [isDeleting, setIsDeleting] = useState(false)\n  const [isConfirmDialogOpen, setConfirmDialogOpen] = useState(false)\n\n  const handleCancel = useCallback(() => {\n    setConfirmDialogOpen(false)\n    onComplete()\n  }, [onComplete])\n\n  const handleConfirm = useCallback(() => {\n    setIsDeleting(true)\n    setConfirmDialogOpen(false)\n    deleteOp.execute()\n    onComplete()\n  }, [deleteOp, onComplete])\n\n  const handle = useCallback(() => {\n    setConfirmDialogOpen(true)\n  }, [])\n\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'delete',\n  })\n\n  const currentUser = useCurrentUser()\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      tone: 'critical',\n      icon: TrashIcon,\n      disabled: true,\n      label: 'Delete',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"delete this document\"\n          currentUser={currentUser}\n        />\n      ),\n    }\n  }\n\n  return {\n    tone: 'critical',\n    icon: TrashIcon,\n    disabled: isDeleting || Boolean(deleteOp.disabled) || isPermissionsLoading,\n    title:\n      (deleteOp.disabled &&\n        DISABLED_REASON_TITLE[deleteOp.disabled as keyof typeof DISABLED_REASON_TITLE]) ||\n      '',\n    label: isDeleting ? 'Deleting…' : 'Delete',\n    shortcut: 'Ctrl+Alt+D',\n    onHandle: handle,\n    dialog: isConfirmDialogOpen && {\n      type: 'custom',\n      component: (\n        <ConfirmDeleteDialog\n          action=\"delete\"\n          id={draft?._id || id}\n          type={type}\n          onCancel={handleCancel}\n          onConfirm={handleConfirm}\n        />\n      ),\n    },\n  }\n}\n\nDeleteAction.action = 'delete'\n","/* eslint-disable import/no-extraneous-dependencies */\n\nimport {ResetIcon} from '@sanity/icons'\nimport React, {useCallback, useMemo, useState} from 'react'\nimport {\n  DocumentActionComponent,\n  DocumentActionDialogProps,\n  InsufficientPermissionsMessage,\n  useCurrentUser,\n  useDocumentOperation,\n  useDocumentPairPermissions,\n} from 'sanity'\n\nconst DISABLED_REASON_TITLE = {\n  NO_CHANGES: 'This document has no unpublished changes',\n  NOT_PUBLISHED: 'This document is not published',\n}\n\n/** @internal */\nexport const DiscardChangesAction: DocumentActionComponent = ({\n  id,\n  type,\n  published,\n  liveEdit,\n  onComplete,\n}) => {\n  const {discardChanges} = useDocumentOperation(id, type)\n  const [isConfirmDialogOpen, setConfirmDialogOpen] = useState(false)\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'discardDraft',\n  })\n  const currentUser = useCurrentUser()\n\n  const handleConfirm = useCallback(() => {\n    discardChanges.execute()\n    onComplete()\n  }, [discardChanges, onComplete])\n\n  const handle = useCallback(() => {\n    setConfirmDialogOpen(true)\n  }, [])\n\n  const dialog: DocumentActionDialogProps | false = useMemo(\n    () =>\n      isConfirmDialogOpen && {\n        type: 'confirm',\n        tone: 'critical',\n        onCancel: onComplete,\n        onConfirm: handleConfirm,\n        message: <>Are you sure you want to discard all changes since last published?</>,\n      },\n    [handleConfirm, isConfirmDialogOpen, onComplete]\n  )\n\n  if (!published || liveEdit) {\n    return null\n  }\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      tone: 'critical',\n      icon: ResetIcon,\n      disabled: true,\n      label: 'Discard changes',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"discard changes in this document\"\n          currentUser={currentUser}\n        />\n      ),\n    }\n  }\n\n  return {\n    tone: 'critical',\n    icon: ResetIcon,\n    disabled: Boolean(discardChanges.disabled) || isPermissionsLoading,\n    title:\n      (discardChanges.disabled &&\n        DISABLED_REASON_TITLE[discardChanges.disabled as keyof typeof DISABLED_REASON_TITLE]) ||\n      '',\n    label: 'Discard changes',\n    onHandle: handle,\n    dialog,\n  }\n}\n\nDiscardChangesAction.action = 'discardChanges'\n","import {CopyIcon} from '@sanity/icons'\nimport {uuid} from '@sanity/uuid'\nimport React, {useCallback, useState} from 'react'\nimport {useRouter} from 'sanity/router'\nimport {\n  DocumentActionComponent,\n  InsufficientPermissionsMessage,\n  useDocumentPairPermissions,\n  useDocumentOperation,\n  useCurrentUser,\n} from 'sanity'\n\nconst DISABLED_REASON_TITLE = {\n  NOTHING_TO_DUPLICATE: 'This document doesn’t yet exist so there‘s nothing to duplicate',\n}\n\n/** @internal */\nexport const DuplicateAction: DocumentActionComponent = ({id, type, onComplete}) => {\n  const {duplicate} = useDocumentOperation(id, type)\n  const {navigateIntent} = useRouter()\n  const [isDuplicating, setDuplicating] = useState(false)\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'duplicate',\n  })\n\n  const currentUser = useCurrentUser()\n\n  const handle = useCallback(() => {\n    const dupeId = uuid()\n\n    setDuplicating(true)\n    duplicate.execute(dupeId)\n    navigateIntent('edit', {id: dupeId, type})\n    onComplete()\n  }, [duplicate, navigateIntent, onComplete, type])\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      icon: CopyIcon,\n      disabled: true,\n      label: 'Duplicate',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"duplicate this document\"\n          currentUser={currentUser}\n        />\n      ),\n    }\n  }\n\n  return {\n    icon: CopyIcon,\n    disabled: isDuplicating || Boolean(duplicate.disabled) || isPermissionsLoading,\n    label: isDuplicating ? 'Duplicating…' : 'Duplicate',\n    title:\n      (duplicate.disabled &&\n        DISABLED_REASON_TITLE[duplicate.disabled as keyof typeof DISABLED_REASON_TITLE]) ||\n      '',\n    onHandle: handle,\n  }\n}\n\nDuplicateAction.action = 'duplicate'\n","import {RestoreIcon} from '@sanity/icons'\nimport React, {useCallback, useMemo, useState} from 'react'\nimport {DocumentActionComponent, DocumentActionDialogProps, useDocumentOperation} from 'sanity'\nimport {useRouter} from 'sanity/router'\n\n/** @internal */\nexport const HistoryRestoreAction: DocumentActionComponent = ({id, type, revision, onComplete}) => {\n  const {restore} = useDocumentOperation(id, type)\n  const {navigateIntent} = useRouter()\n  const [isConfirmDialogOpen, setConfirmDialogOpen] = useState(false)\n\n  const handleConfirm = useCallback(() => {\n    restore.execute(revision!)\n    navigateIntent('edit', {id, type})\n    onComplete()\n  }, [restore, revision, navigateIntent, id, type, onComplete])\n\n  const handle = useCallback(() => {\n    setConfirmDialogOpen(true)\n  }, [])\n\n  const dialog: DocumentActionDialogProps | null = useMemo(() => {\n    if (isConfirmDialogOpen) {\n      return {\n        type: 'confirm',\n        tone: 'critical',\n        onCancel: onComplete,\n        onConfirm: handleConfirm,\n        message: <>Are you sure you want to restore this document?</>,\n      }\n    }\n\n    return null\n  }, [handleConfirm, isConfirmDialogOpen, onComplete])\n\n  const isRevisionInitialVersion = revision === '@initial'\n  const isRevisionLatestVersion = revision === undefined // undefined means latest version\n\n  if (isRevisionLatestVersion) {\n    return null\n  }\n\n  return {\n    label: 'Restore',\n    color: 'primary',\n    onHandle: handle,\n    title: isRevisionInitialVersion\n      ? \"You can't restore to the initial version\"\n      : 'Restore to this version',\n    icon: RestoreIcon,\n    dialog,\n    disabled: isRevisionInitialVersion,\n  }\n}\n\nHistoryRestoreAction.action = 'restore'\n","import {\n  ValidationMarker,\n  Path,\n  SanityDocument,\n  ObjectSchemaType,\n  SanityDocumentLike,\n} from '@sanity/types'\nimport {createContext} from 'react'\nimport {View} from '../../structureBuilder'\nimport {PaneMenuItem, PaneMenuItemGroup} from '../../types'\nimport {TimelineMode} from './types'\nimport {\n  DocumentActionComponent,\n  DocumentBadgeComponent,\n  DocumentFormNode,\n  DocumentLanguageFilterComponent,\n  DocumentPermission,\n  EditStateFor,\n  PatchEvent,\n  PermissionCheckResult,\n  StateTree,\n  TimelineStore,\n} from 'sanity'\n\n/** @internal */\nexport interface DocumentPaneContextValue {\n  actions: DocumentActionComponent[] | null\n  activeViewId: string | null\n  badges: DocumentBadgeComponent[] | null\n  changesOpen: boolean\n  collapsedFieldSets: StateTree<boolean> | undefined\n  collapsedPaths: StateTree<boolean> | undefined\n  compareValue: Partial<SanityDocument> | null\n  connectionState: 'connecting' | 'reconnecting' | 'connected'\n  displayed: Partial<SanityDocument> | null\n  documentId: string\n  documentIdRaw: string\n  documentType: string\n  editState: EditStateFor | null\n  focusPath: Path\n  index: number\n  inspectOpen: boolean\n  menuItemGroups: PaneMenuItemGroup[]\n  menuItems: PaneMenuItem[]\n  onBlur: (blurredPath: Path) => void\n  onChange: (event: PatchEvent) => void\n  onFocus: (pathOrEvent: Path) => void\n  onHistoryClose: () => void\n  onHistoryOpen: () => void\n  onInspectClose: () => void\n  onKeyUp: (event: React.KeyboardEvent<HTMLDivElement>) => void\n  onMenuAction: (item: PaneMenuItem) => void\n  onPaneClose: () => void\n  onPaneSplit?: () => void\n  onPathOpen: (path: Path) => void\n  onSetActiveFieldGroup: (path: Path, groupName: string) => void\n  onSetCollapsedPath: (path: Path, expanded: boolean) => void\n  onSetCollapsedFieldSet: (path: Path, expanded: boolean) => void\n  paneKey: string\n  previewUrl?: string | null\n  ready: boolean\n  schemaType: ObjectSchemaType\n  setTimelineMode: (mode: TimelineMode) => void\n  setTimelineRange(since: string | null, rev: string | null): void\n  source?: string\n  timelineError: Error | null\n  timelineMode: TimelineMode\n  timelineStore: TimelineStore\n  title: string | null\n  validation: ValidationMarker[]\n  value: SanityDocumentLike\n  views: View[]\n  formState: DocumentFormNode | null\n  permissions?: PermissionCheckResult | null\n  isPermissionsLoading: boolean\n  unstable_languageFilter: DocumentLanguageFilterComponent[]\n}\n\n/** @internal */\nexport const DocumentPaneContext = createContext<DocumentPaneContextValue | null>(null)\n","import {useContext} from 'react'\nimport {DocumentPaneContext, DocumentPaneContextValue} from './DocumentPaneContext'\n\n/** @internal */\nexport function useDocumentPane(): DocumentPaneContextValue {\n  const documentPane = useContext(DocumentPaneContext)\n\n  if (!documentPane) {\n    throw new Error('DocumentPane: missing context value')\n  }\n\n  return documentPane\n}\n","import {CheckmarkIcon, PublishIcon} from '@sanity/icons'\nimport {isValidationErrorMarker} from '@sanity/types'\nimport React, {useCallback, useEffect, useState} from 'react'\nimport {TimeAgo} from '../components'\nimport {useDocumentPane} from '../panes/document/useDocumentPane'\nimport {\n  DocumentActionComponent,\n  InsufficientPermissionsMessage,\n  useCurrentUser,\n  useDocumentOperation,\n  useDocumentPairPermissions,\n  useEditState,\n  useSyncState,\n  useValidationStatus,\n} from 'sanity'\n\nconst DISABLED_REASON_TITLE = {\n  LIVE_EDIT_ENABLED: 'Cannot publish since liveEdit is enabled for this document type',\n  ALREADY_PUBLISHED: 'Already published',\n  NO_CHANGES: 'No unpublished changes',\n  NOT_READY: 'Operation not ready',\n}\n\nfunction getDisabledReason(\n  reason: keyof typeof DISABLED_REASON_TITLE,\n  publishedAt: string | undefined\n) {\n  if (reason === 'ALREADY_PUBLISHED' && publishedAt) {\n    return (\n      <>\n        <span>\n          Published <TimeAgo time={publishedAt} />\n        </span>\n      </>\n    )\n  }\n  return DISABLED_REASON_TITLE[reason]\n}\n\n/** @internal */\n// eslint-disable-next-line complexity\nexport const PublishAction: DocumentActionComponent = (props) => {\n  const {id, type, liveEdit, draft, published} = props\n  const [publishState, setPublishState] = useState<'publishing' | 'published' | null>(null)\n  const {publish} = useDocumentOperation(id, type)\n  const validationStatus = useValidationStatus(id, type)\n  const syncState = useSyncState(id, type)\n  const {changesOpen, onHistoryOpen, documentId, documentType} = useDocumentPane()\n  const editState = useEditState(documentId, documentType)\n\n  const revision = (editState?.draft || editState?.published || {})._rev\n\n  const hasValidationErrors = validationStatus.validation.some(isValidationErrorMarker)\n  // we use this to \"schedule\" publish after pending tasks (e.g. validation and sync) has completed\n  const [publishScheduled, setPublishScheduled] = useState<boolean>(false)\n  const isSyncing = syncState.isSyncing\n  const isValidating = validationStatus.isValidating\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'publish',\n  })\n\n  const currentUser = useCurrentUser()\n\n  // eslint-disable-next-line no-nested-ternary\n  const title = publish.disabled\n    ? getDisabledReason(publish.disabled, (published || {})._updatedAt) || ''\n    : hasValidationErrors\n    ? 'There are validation errors that need to be fixed before this document can be published'\n    : ''\n\n  const hasDraft = Boolean(draft)\n\n  const doPublish = useCallback(() => {\n    publish.execute()\n    setPublishState('publishing')\n  }, [publish])\n\n  useEffect(() => {\n    // make sure the validation status is about the current revision and not an earlier one\n    const validationComplete =\n      validationStatus.isValidating === false && validationStatus.revision !== revision\n\n    if (!publishScheduled || isSyncing || !validationComplete) {\n      return\n    }\n\n    if (!hasValidationErrors) {\n      doPublish()\n    }\n    setPublishScheduled(false)\n  }, [\n    isSyncing,\n    doPublish,\n    hasValidationErrors,\n    publishScheduled,\n    validationStatus.revision,\n    revision,\n    isValidating,\n    validationStatus.isValidating,\n  ])\n\n  useEffect(() => {\n    const didPublish = publishState === 'publishing' && !hasDraft\n    if (didPublish) {\n      if (changesOpen) {\n        // Re-open the panel\n        onHistoryOpen()\n      }\n    }\n    const nextState = didPublish ? 'published' : null\n    const delay = didPublish ? 200 : 4000\n    const timer = setTimeout(() => {\n      setPublishState(nextState)\n    }, delay)\n    return () => clearTimeout(timer)\n  }, [changesOpen, publishState, hasDraft, onHistoryOpen])\n\n  const handle = useCallback(() => {\n    if (\n      syncState.isSyncing ||\n      validationStatus.isValidating ||\n      validationStatus.revision !== revision\n    ) {\n      setPublishScheduled(true)\n    } else {\n      doPublish()\n    }\n  }, [\n    syncState.isSyncing,\n    validationStatus.isValidating,\n    validationStatus.revision,\n    revision,\n    doPublish,\n  ])\n\n  if (liveEdit) {\n    return {\n      tone: 'positive',\n      label: 'Publish',\n      title:\n        'Live Edit is enabled for this content type and publishing happens automatically as you make changes',\n      disabled: true,\n    }\n  }\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      tone: 'positive',\n      label: 'Publish',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"publish this document\"\n          currentUser={currentUser}\n        />\n      ),\n      disabled: true,\n    }\n  }\n\n  const disabled = Boolean(\n    publishScheduled ||\n      editState?.transactionSyncLock?.enabled ||\n      publishState === 'publishing' ||\n      publishState === 'published' ||\n      hasValidationErrors ||\n      publish.disabled\n  )\n\n  return {\n    disabled: disabled || isPermissionsLoading,\n    tone: 'positive',\n    label:\n      // eslint-disable-next-line no-nested-ternary\n      publishState === 'published'\n        ? 'Published'\n        : publishScheduled || publishState === 'publishing'\n        ? 'Publishing…'\n        : 'Publish',\n    // @todo: Implement loading state, to show a `<Button loading />` state\n    // loading: publishScheduled || publishState === 'publishing',\n    icon: publishState === 'published' ? CheckmarkIcon : PublishIcon,\n    // eslint-disable-next-line no-nested-ternary\n    title: publishScheduled\n      ? 'Waiting for tasks to finish before publishing'\n      : publishState === 'published' || publishState === 'publishing'\n      ? null\n      : title,\n    shortcut: disabled || publishScheduled ? null : 'Ctrl+Alt+P',\n    onHandle: handle,\n  }\n}\n\nPublishAction.action = 'publish'\n","import {UnpublishIcon} from '@sanity/icons'\nimport React, {useCallback, useMemo, useState} from 'react'\nimport {ConfirmDeleteDialog} from '../components'\nimport {\n  DocumentActionComponent,\n  InsufficientPermissionsMessage,\n  useDocumentPairPermissions,\n  useCurrentUser,\n  useDocumentOperation,\n  DocumentActionModalDialogProps,\n} from 'sanity'\n\nconst DISABLED_REASON_TITLE = {\n  NOT_PUBLISHED: 'This document is not published',\n}\n\n/** @internal */\nexport const UnpublishAction: DocumentActionComponent = ({\n  id,\n  type,\n  draft,\n  onComplete,\n  liveEdit,\n}) => {\n  const {unpublish} = useDocumentOperation(id, type)\n  const [isConfirmDialogOpen, setConfirmDialogOpen] = useState(false)\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'unpublish',\n  })\n  const currentUser = useCurrentUser()\n\n  const handleCancel = useCallback(() => {\n    setConfirmDialogOpen(false)\n    onComplete()\n  }, [onComplete])\n\n  const handleConfirm = useCallback(() => {\n    setConfirmDialogOpen(false)\n    unpublish.execute()\n    onComplete()\n  }, [onComplete, unpublish])\n\n  const dialog: DocumentActionModalDialogProps | null = useMemo(() => {\n    if (isConfirmDialogOpen) {\n      return {\n        type: 'dialog',\n        onClose: onComplete,\n        content: (\n          <ConfirmDeleteDialog\n            id={draft?._id || id}\n            type={type}\n            action=\"unpublish\"\n            onCancel={handleCancel}\n            onConfirm={handleConfirm}\n          />\n        ),\n      }\n    }\n\n    return null\n  }, [draft, id, handleCancel, handleConfirm, isConfirmDialogOpen, onComplete, type])\n\n  if (liveEdit) {\n    return null\n  }\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      tone: 'critical',\n      icon: UnpublishIcon,\n      label: 'Unpublish',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"unpublish this document\"\n          currentUser={currentUser}\n        />\n      ),\n      disabled: true,\n    }\n  }\n\n  return {\n    tone: 'critical',\n    icon: UnpublishIcon,\n    disabled: Boolean(unpublish.disabled) || isPermissionsLoading,\n    label: 'Unpublish',\n    title: unpublish.disabled\n      ? DISABLED_REASON_TITLE[unpublish.disabled as keyof typeof DISABLED_REASON_TITLE]\n      : '',\n    onHandle: () => setConfirmDialogOpen(true),\n    dialog,\n  }\n}\n\nUnpublishAction.action = 'unpublish'\n","import {DocumentBadgeComponent} from 'sanity'\n\n/** @internal */\nexport const LiveEditBadge: DocumentBadgeComponent = (props) => {\n  const {liveEdit} = props\n\n  if (liveEdit) {\n    return {\n      label: 'Live',\n      color: 'danger',\n    }\n  }\n\n  return null\n}\n","/**\n * @internal\n */\nexport const _DEBUG = false\n\nexport const EMPTY_PARAMS = {}\nexport const LOADING_PANE = Symbol('LOADING_PANE')\n\nexport const DOCUMENT_PANEL_PORTAL_ELEMENT = 'documentPanelPortalElement'\n","import {uuid} from '@sanity/uuid'\nimport {PaneNode, RouterPanes} from './types'\nimport {EMPTY_PARAMS, LOADING_PANE} from './constants'\n\nconst state: {\n  activePanes: Array<PaneNode | typeof LOADING_PANE>\n} = {activePanes: []}\n\nexport function setActivePanes(panes: Array<PaneNode | typeof LOADING_PANE>): void {\n  state.activePanes = panes\n}\n\n/**\n * This function looks at the _active panes_ to resolve an intent. this type of\n * intent resolution is faster and does not cause the panes to reset\n *\n * @internal\n */\nexport function getIntentState(\n  intent: string,\n  params: Record<string, string>,\n  routerState: {panes?: RouterPanes} | undefined,\n  payload: unknown\n): {panes: RouterPanes} | {intent: string; params: Record<string, string>; payload: unknown} {\n  const panes = routerState?.panes || []\n  const activePanes = state.activePanes || []\n  const editDocumentId = params.id || uuid()\n  const isTemplate = intent === 'create' && params.template\n\n  // Loop through open panes and see if any of them can handle the intent\n  for (let i = activePanes.length - 1; i >= 0; i--) {\n    const pane = activePanes[i]\n\n    if (typeof pane !== 'object') continue\n\n    // NOTE: if you update this logic, please also update the similar handler in\n    // `resolveIntent.ts`\n    if (\n      pane.canHandleIntent?.(intent, params, {\n        pane,\n        index: i,\n      }) ||\n      // see `resolveIntent.ts` for more info\n      (pane.type === 'documentList' &&\n        pane.schemaTypeName === params.type &&\n        pane.options.filter === '_type == $type')\n    ) {\n      const paneParams = isTemplate ? {template: params.template} : EMPTY_PARAMS\n\n      return {\n        panes: panes\n          .slice(0, i)\n          .concat([[{id: editDocumentId, params: paneParams, payload}]]) as RouterPanes,\n      }\n    }\n  }\n\n  return {intent: intent, params, payload}\n}\n","import {omit} from 'lodash'\nimport {RouterPanes, RouterPaneGroup, RouterPaneSibling} from './types'\nimport {route} from 'sanity/router'\n\nconst EMPTY_PARAMS = {}\n\n/**\n * @internal\n */\nexport function legacyEditParamsToState(params: string): Record<string, unknown> {\n  try {\n    return JSON.parse(decodeURIComponent(params))\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.warn('Failed to parse JSON parameters')\n    return {}\n  }\n}\n\nexport function encodePanesSegment(panes: RouterPanes): string {\n  return (panes || [])\n    .map((group) => group.map(encodeChunks).join('|'))\n    .map(encodeURIComponent)\n    .join(';')\n}\n\n/**\n * @internal\n */\nexport function legacyEditParamsToPath(params: Record<string, unknown>): string {\n  return JSON.stringify(params)\n}\n\n// http://localhost:3333/intent/create/template=book-by-author;type=book/eyJhdXRob3JJZCI6Imdycm0ifQ==\n\n/**\n * @internal\n */\nexport function toState(pathSegment: string): RouterPaneGroup[] {\n  return parsePanesSegment(decodeURIComponent(pathSegment))\n}\n\n/**\n * @internal\n */\nexport function toPath(panes: RouterPaneGroup[]): string {\n  return encodePanesSegment(panes)\n}\n\nexport const router = route.create('/', [\n  // \"Asynchronous intent resolving\" route\n  route.intents('/intent'),\n\n  // Legacy fallback route, will be redirected to new format\n  route.create('/edit/:type/:editDocumentId', [\n    route.create({\n      path: '/:params',\n      transform: {params: {toState: legacyEditParamsToState, toPath: legacyEditParamsToPath}},\n    }),\n  ]),\n\n  // The regular path - when the intent can be resolved to a specific pane\n  route.create({\n    path: '/:panes',\n    // Legacy URLs, used to handle redirects\n    children: [route.create('/:action', route.create('/:legacyEditDocumentId'))],\n    transform: {\n      panes: {toState, toPath},\n    },\n  }),\n])\n\n// old: authors;knut,{\"template\":\"diaryEntry\"}\n// new: authors;knut,view=diff,eyJyZXYxIjoiYWJjMTIzIiwicmV2MiI6ImRlZjQ1NiJ9|latest-posts\n\nconst panePattern = /^([.a-z0-9_-]+),?({.*?})?(?:(;|$))/i\nconst isParam = (str: string) => /^[a-z0-9]+=[^=]+/i.test(str)\nconst isPayload = (str: string) =>\n  /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(str)\nconst exclusiveParams = ['view', 'since', 'rev']\n\ntype Truthy<T> = T extends false\n  ? never\n  : T extends ''\n  ? never\n  : T extends 0\n  ? never\n  : T extends 0n\n  ? never\n  : T extends null | undefined\n  ? NonNullable<T>\n  : T\nconst isTruthy = Boolean as (t: unknown) => boolean as <T>(t: T) => t is Truthy<T>\n\nfunction parseChunks(chunks: string[], initial: RouterPaneSibling): RouterPaneSibling {\n  return chunks.reduce(\n    (pane, chunk) => {\n      if (isParam(chunk)) {\n        const key = chunk.slice(0, chunk.indexOf('='))\n        const value = chunk.slice(key.length + 1)\n        pane.params = {...pane.params, [decodeURIComponent(key)]: decodeURIComponent(value)}\n      } else if (isPayload(chunk)) {\n        pane.payload = tryParseBase64Payload(chunk)\n      } else {\n        // eslint-disable-next-line no-console\n        console.warn('Unknown pane segment: %s - skipping', chunk)\n      }\n\n      return pane\n    },\n    {...initial, params: EMPTY_PARAMS, payload: undefined}\n  )\n}\n\nfunction encodeChunks(pane: RouterPaneSibling, index: number, group: RouterPaneGroup): string {\n  const {payload, params = {}, id} = pane\n  const [firstSibling] = group\n  const paneIsFirstSibling = pane === firstSibling\n  const sameAsFirst = index !== 0 && id === firstSibling.id\n  const encodedPayload = typeof payload === 'undefined' ? undefined : btoa(JSON.stringify(payload))\n\n  const encodedParams = Object.entries(params)\n    .filter((entry): entry is [string, string] => {\n      const [key, value] = entry\n      if (!value) return false\n      if (paneIsFirstSibling) return true\n\n      // omit the value if it's the same as the value from the first sibling\n      const valueFromFirstSibling = firstSibling.params?.[key]\n      if (value === valueFromFirstSibling && !exclusiveParams.includes(key)) return false\n      return true\n    })\n    .map(([key, value]) => `${encodeURIComponent(key)}=${encodeURIComponent(value)}`)\n\n  return (\n    [sameAsFirst ? '' : id]\n      .concat([encodedParams.length > 0 && encodedParams, encodedPayload].filter(isTruthy).flat())\n      .join(',') || ','\n  )\n}\n\nexport function parsePanesSegment(str: string): RouterPanes {\n  if (str.indexOf(',{') !== -1) {\n    return parseOldPanesSegment(str)\n  }\n\n  return str\n    .split(';')\n    .map((group) => {\n      const [firstSibling, ...restOfSiblings] = group.split('|').map((segment) => {\n        const [id, ...chunks] = segment.split(',')\n        return parseChunks(chunks, {id})\n      })\n\n      return [\n        firstSibling,\n        ...restOfSiblings.map((sibling) => ({\n          ...firstSibling,\n          ...sibling,\n          id: sibling.id || firstSibling.id,\n          params: {...omit(firstSibling.params, exclusiveParams), ...sibling.params},\n          payload: sibling.payload || firstSibling.payload,\n        })),\n      ]\n    })\n    .filter((group) => group.length > 0)\n}\n\nfunction parseOldPanesSegment(str: string): RouterPanes {\n  const chunks: RouterPaneGroup = []\n\n  let buffer = str\n  while (buffer.length) {\n    const [match, id, payloadChunk] = buffer.match(panePattern) || []\n    if (!match) {\n      buffer = buffer.slice(1)\n      continue\n    }\n\n    const payload = payloadChunk && tryParsePayload(payloadChunk)\n    chunks.push({id, payload})\n\n    buffer = buffer.slice(match.length)\n  }\n\n  return [chunks]\n}\n\nfunction tryParsePayload(json: string) {\n  try {\n    return JSON.parse(json)\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.warn(`Failed to parse parameters: ${err.message}`)\n    return undefined\n  }\n}\n\nfunction tryParseBase64Payload(data: string) {\n  return data ? tryParsePayload(atob(data)) : undefined\n}\n","import {MasterDetailIcon} from '@sanity/icons'\nimport {lazy} from 'react'\nimport {definePlugin} from 'sanity'\nimport {\n  DeleteAction,\n  DiscardChangesAction,\n  DuplicateAction,\n  HistoryRestoreAction,\n  PublishAction,\n  UnpublishAction,\n} from './documentActions'\nimport {LiveEditBadge} from './documentBadges'\nimport {getIntentState} from './getIntentState'\nimport {router} from './router'\nimport {DeskToolOptions} from './types'\n\nconst documentActions = [\n  PublishAction,\n  UnpublishAction,\n  DiscardChangesAction,\n  DuplicateAction,\n  DeleteAction,\n  HistoryRestoreAction,\n]\n\nconst documentBadges = [LiveEditBadge]\n\n/**\n * @hidden\n * @beta */\nexport const deskTool = definePlugin<DeskToolOptions | void>((options) => ({\n  name: '@sanity/desk-tool',\n  document: {\n    actions: (prevActions) => {\n      // NOTE: since it's possible to have several desk tools in one Studio,\n      // we need to check whether the document actions already exist in the Studio config\n      const actions = prevActions.slice(0)\n      for (const action of documentActions) {\n        if (!actions.includes(action)) actions.push(action)\n      }\n      return actions\n    },\n    badges: (prevBadges) => {\n      // NOTE: since it's possible to have several desk tools in one Studio,\n      // we need to check whether the document badges already exist in the Studio config\n      const badges = prevBadges.slice(0)\n      for (const badge of documentBadges) {\n        if (!badges.includes(badge)) badges.push(badge)\n      }\n      return badges\n    },\n  },\n  tools: [\n    {\n      name: options?.name || 'desk',\n      title: options?.title || 'Desk',\n      icon: options?.icon || MasterDetailIcon,\n      component: lazy(() => import('./components/deskTool')),\n      canHandleIntent: (intent, params) => {\n        return Boolean(\n          (intent === 'edit' && params.id) ||\n            (intent === 'create' && params.type) ||\n            (intent === 'create' && params.template)\n        )\n      },\n      getIntentState,\n      options,\n      router,\n    },\n  ],\n}))\n","import {createContext} from 'react'\nimport {DeskToolContextValue} from './types'\n\nexport const DeskToolContext = createContext<DeskToolContextValue | null>(null)\n","import {SerializePath} from './StructureNodes'\n\n/** @internal */\nexport class SerializeError extends Error {\n  public readonly path: SerializePath\n  public helpId?: HELP_URL\n\n  constructor(\n    message: string,\n    parentPath: SerializePath,\n    pathSegment: string | number | undefined,\n    hint?: string\n  ) {\n    super(message)\n    const segment = typeof pathSegment === 'undefined' ? '<unknown>' : `${pathSegment}`\n    this.path = (parentPath || []).concat(hint ? `${segment} (${hint})` : segment)\n  }\n\n  withHelpUrl(id: HELP_URL): SerializeError {\n    this.helpId = id\n    return this\n  }\n}\n\n/** @internal */\nexport enum HELP_URL {\n  ID_REQUIRED = 'structure-node-id-required',\n  TITLE_REQUIRED = 'structure-title-required',\n  FILTER_REQUIRED = 'structure-filter-required',\n  INVALID_LIST_ITEM = 'structure-invalid-list-item',\n  COMPONENT_REQUIRED = 'structure-view-component-required',\n  DOCUMENT_ID_REQUIRED = 'structure-document-id-required',\n  DOCUMENT_TYPE_REQUIRED = 'structure-document-type-required',\n  SCHEMA_TYPE_REQUIRED = 'structure-schema-type-required',\n  SCHEMA_TYPE_NOT_FOUND = 'structure-schema-type-not-found',\n  LIST_ITEMS_MUST_BE_ARRAY = 'structure-list-items-must-be-array',\n  QUERY_PROVIDED_FOR_FILTER = 'structure-query-provided-for-filter',\n  ACTION_OR_INTENT_REQUIRED = 'structure-action-or-intent-required',\n  LIST_ITEM_IDS_MUST_BE_UNIQUE = 'structure-list-item-ids-must-be-unique',\n  ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE = 'structure-action-and-intent-mutually-exclusive',\n}\n","import {SchemaType, SortOrderingItem} from '@sanity/types'\n\nconst IMPLICIT_FIELDS = ['_id', '_type', '_createdAt', '_updatedAt', '_rev']\n\n// Takes a path array and a schema type and builds a GROQ join every time it enters a reference field\nfunction joinReferences(schemaType: SchemaType, path: string[]): string {\n  const [head, ...tail] = path\n\n  if (!('fields' in schemaType)) {\n    return ''\n  }\n\n  const schemaField = schemaType.fields.find((field) => field.name === head)\n  if (!schemaField) {\n    if (!IMPLICIT_FIELDS.includes(head)) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        'The current ordering config targeted the nonexistent field \"%s\" on schema type \"%s\". It should be one of %o',\n        head,\n        schemaType.name,\n        schemaType.fields.map((field) => field.name)\n      )\n    }\n    return ''\n  }\n\n  if ('to' in schemaField.type && schemaField.type.name === 'reference') {\n    const refTypes = schemaField.type.to\n    return `${head}->{${refTypes.map((refType) => joinReferences(refType, tail)).join(',')}}`\n  }\n\n  const tailFields = tail.length > 0 && joinReferences(schemaField.type, tail)\n  const tailWrapper = tailFields ? `{${tailFields}}` : ''\n  return tail.length > 0 ? `${head}${tailWrapper}` : head\n}\n\nexport function getExtendedProjection(schemaType: SchemaType, orderBy: SortOrderingItem[]): string {\n  return orderBy.map((ordering) => joinReferences(schemaType, ordering.field.split('.'))).join(', ')\n}\n","import {SortOrdering} from '@sanity/types'\n\nexport const ORDER_BY_UPDATED_AT: SortOrdering = {\n  title: 'Last edited',\n  name: 'lastEditedDesc',\n  by: [{field: '_updatedAt', direction: 'desc'}],\n}\n\nexport const ORDER_BY_CREATED_AT: SortOrdering = {\n  title: 'Created',\n  name: 'lastCreatedDesc',\n  by: [{field: '_createdAt', direction: 'desc'}],\n}\n\nexport const DEFAULT_SELECTED_ORDERING_OPTION = ORDER_BY_UPDATED_AT\n\nexport const DEFAULT_ORDERING_OPTIONS: SortOrdering[] = [\n  ORDER_BY_UPDATED_AT, // _updatedAt\n  ORDER_BY_CREATED_AT, // _createdAt\n]\n","import {SchemaType, SortOrdering, SortOrderingItem} from '@sanity/types'\nimport {SortIcon} from '@sanity/icons'\nimport {getExtendedProjection} from './util/getExtendedProjection'\nimport {Intent} from './Intent'\nimport {DEFAULT_ORDERING_OPTIONS} from './Sort'\nimport {SerializeOptions, Serializable, SerializePath} from './StructureNodes'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {StructureContext} from './types'\n\n/** @internal */\nexport function maybeSerializeMenuItem(\n  item: MenuItem | MenuItemBuilder,\n  index: number,\n  path: SerializePath\n): MenuItem {\n  return item instanceof MenuItemBuilder ? item.serialize({path, index}) : item\n}\n\n/**\n * @hidden\n * @beta */\nexport type MenuItemActionType =\n  | string\n  | ((params: Record<string, string> | undefined, scope?: any) => void)\n\n/**\n * @hidden\n * @beta */\nexport type MenuItemParamsType = Record<string, string | unknown | undefined>\n\n/**\n * @hidden\n * @beta */\nexport interface MenuItem {\n  title: string\n  action?: MenuItemActionType\n  intent?: Intent\n  group?: string\n  // TODO: align these with TemplateResponse['icon']\n  icon?: React.ComponentType | React.ReactNode\n  params?: MenuItemParamsType\n  showAsAction?: boolean\n}\n\n/**\n * @hidden\n * @beta */\nexport type PartialMenuItem = Partial<MenuItem>\n\n/**\n * @hidden\n * @beta */\nexport class MenuItemBuilder implements Serializable<MenuItem> {\n  protected spec: PartialMenuItem\n\n  constructor(protected _context: StructureContext, spec?: MenuItem) {\n    this.spec = spec ? spec : {}\n  }\n\n  action(action: MenuItemActionType): MenuItemBuilder {\n    return this.clone({action})\n  }\n\n  getAction(): PartialMenuItem['action'] {\n    return this.spec.action\n  }\n\n  intent(intent: Intent): MenuItemBuilder {\n    return this.clone({intent})\n  }\n\n  getIntent(): PartialMenuItem['intent'] {\n    return this.spec.intent\n  }\n\n  title(title: string): MenuItemBuilder {\n    return this.clone({title})\n  }\n\n  getTitle(): string | undefined {\n    return this.spec.title\n  }\n\n  group(group: string): MenuItemBuilder {\n    return this.clone({group})\n  }\n\n  getGroup(): PartialMenuItem['group'] {\n    return this.spec.group\n  }\n\n  icon(icon: React.ComponentType | React.ReactNode): MenuItemBuilder {\n    return this.clone({icon})\n  }\n\n  getIcon(): PartialMenuItem['icon'] {\n    return this.spec.icon\n  }\n\n  params(params: MenuItemParamsType): MenuItemBuilder {\n    return this.clone({params})\n  }\n\n  getParams(): PartialMenuItem['params'] {\n    return this.spec.params\n  }\n\n  showAsAction(showAsAction = true): MenuItemBuilder {\n    return this.clone({showAsAction: Boolean(showAsAction)})\n  }\n\n  getShowAsAction(): PartialMenuItem['showAsAction'] {\n    return this.spec.showAsAction\n  }\n\n  serialize(options: SerializeOptions = {path: []}): MenuItem {\n    const {title, action, intent} = this.spec\n    if (!title) {\n      const hint = typeof action === 'string' ? `action: \"${action}\"` : undefined\n      throw new SerializeError(\n        '`title` is required for menu item',\n        options.path,\n        options.index,\n        hint\n      ).withHelpUrl(HELP_URL.TITLE_REQUIRED)\n    }\n\n    if (!action && !intent) {\n      throw new SerializeError(\n        `\\`action\\` or \\`intent\\` required for menu item with title ${this.spec.title}`,\n        options.path,\n        options.index,\n        `\"${title}\"`\n      ).withHelpUrl(HELP_URL.ACTION_OR_INTENT_REQUIRED)\n    }\n\n    if (intent && action) {\n      throw new SerializeError(\n        'cannot set both `action` AND `intent`',\n        options.path,\n        options.index,\n        `\"${title}\"`\n      ).withHelpUrl(HELP_URL.ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE)\n    }\n\n    return {...this.spec, title}\n  }\n\n  clone(withSpec?: PartialMenuItem): MenuItemBuilder {\n    const builder = new MenuItemBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n\n/** @internal */\nexport interface SortMenuItem extends MenuItem {\n  params: {\n    by: SortOrderingItem[]\n  }\n}\n\n/** @internal */\nexport function getOrderingMenuItem(\n  context: StructureContext,\n  ordering: SortOrdering,\n  extendedProjection?: string\n): MenuItemBuilder {\n  return new MenuItemBuilder(context)\n    .group('sorting')\n    .title(`Sort by ${ordering.title}`)\n    .icon(SortIcon)\n    .action('setSortOrder')\n    .params({by: ordering.by, extendedProjection})\n}\n\n/** @internal */\nexport function getOrderingMenuItemsForSchemaType(\n  context: StructureContext,\n  typeName: SchemaType | string\n): MenuItemBuilder[] {\n  const {schema} = context\n  const type = typeof typeName === 'string' ? schema.get(typeName) : typeName\n  if (!type || !('orderings' in type)) {\n    return []\n  }\n\n  return (\n    type.orderings ? type.orderings.concat(DEFAULT_ORDERING_OPTIONS) : DEFAULT_ORDERING_OPTIONS\n  ).map((ordering: SortOrdering) =>\n    getOrderingMenuItem(context, ordering, getExtendedProjection(type, ordering.by))\n  )\n}\n","import {SerializeOptions, Serializable, SerializePath} from './StructureNodes'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {StructureContext} from './types'\n\n/** @internal */\nexport function maybeSerializeMenuItemGroup(\n  item: MenuItemGroup | MenuItemGroupBuilder,\n  index: number,\n  path: SerializePath\n): MenuItemGroup {\n  return item instanceof MenuItemGroupBuilder ? item.serialize({path, index}) : item\n}\n\n/**\n * @hidden\n * @beta */\nexport interface MenuItemGroup {\n  id: string\n  title: string\n}\n\n/**\n * @hidden\n * @beta */\nexport class MenuItemGroupBuilder implements Serializable<MenuItemGroup> {\n  protected _id: string\n  protected _title: string\n\n  constructor(protected _context: StructureContext, spec?: MenuItemGroup) {\n    this._id = spec ? spec.id : ''\n    this._title = spec ? spec.title : ''\n  }\n\n  id(id: string): MenuItemGroupBuilder {\n    return new MenuItemGroupBuilder(this._context, {id, title: this._title})\n  }\n\n  getId(): string {\n    return this._id\n  }\n\n  title(title: string): MenuItemGroupBuilder {\n    return new MenuItemGroupBuilder(this._context, {id: this._id, title})\n  }\n\n  getTitle(): string {\n    return this._title\n  }\n\n  serialize(options: SerializeOptions = {path: []}): MenuItemGroup {\n    const {_id, _title} = this\n    if (!_id) {\n      throw new SerializeError(\n        '`id` is required for a menu item group',\n        options.path,\n        options.index,\n        _title\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!_title) {\n      throw new SerializeError(\n        '`title` is required for a menu item group',\n        options.path,\n        _id\n      ).withHelpUrl(HELP_URL.TITLE_REQUIRED)\n    }\n\n    return {\n      id: _id,\n      title: _title,\n    }\n  }\n}\n","import {SerializeError} from '../SerializeError'\nimport {SerializePath} from '../StructureNodes'\n\nexport const disallowedPattern = /([^A-Za-z0-9-_.])/\n\nexport function validateId(\n  id: string,\n  parentPath: SerializePath,\n  pathSegment: string | number | undefined\n): string {\n  if (typeof id !== 'string') {\n    throw new SerializeError(\n      `Structure node id must be of type string, got ${typeof id}`,\n      parentPath,\n      pathSegment\n    )\n  }\n\n  const [disallowedChar] = id.match(disallowedPattern) || []\n  if (disallowedChar) {\n    throw new SerializeError(\n      `Structure node id cannot contain character \"${disallowedChar}\"`,\n      parentPath,\n      pathSegment\n    )\n  }\n\n  if (id.startsWith('__edit__')) {\n    throw new SerializeError(\n      `Structure node id cannot start with __edit__`,\n      parentPath,\n      pathSegment\n    )\n  }\n\n  return id\n}\n","import {camelCase} from 'lodash'\nimport getSlug from 'speakingurl'\nimport {disallowedPattern} from './validateId'\n\nexport function getStructureNodeId(title: string, id?: string): string {\n  if (id) {\n    return id\n  }\n\n  const camelCased = camelCase(title)\n\n  return disallowedPattern.test(camelCased) ? camelCase(getSlug(title)) : camelCased\n}\n","import {SerializeOptions, StructureNode, Serializable, Child} from './StructureNodes'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {MenuItem, MenuItemBuilder, maybeSerializeMenuItem} from './MenuItem'\nimport {MenuItemGroup, MenuItemGroupBuilder, maybeSerializeMenuItemGroup} from './MenuItemGroup'\nimport {validateId} from './util/validateId'\nimport {UserComponent} from './types'\nimport {getStructureNodeId} from './util/getStructureNodeId'\n\n/**\n * @hidden\n * @beta */\n// TODO: rename to `StructureComponent` since it clashes with React?\nexport interface Component extends StructureNode {\n  component: UserComponent\n  child?: Child\n  menuItems: MenuItem[]\n  menuItemGroups: MenuItemGroup[]\n  options: {[key: string]: unknown}\n}\n\n/**\n * @hidden\n * @beta */\nexport interface ComponentInput extends StructureNode {\n  component: UserComponent\n  child?: Child\n  options?: {[key: string]: unknown}\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n}\n\n/**\n * @hidden\n * @beta */\nexport interface BuildableComponent extends Partial<StructureNode> {\n  component?: UserComponent\n  child?: Child\n  options?: {[key: string]: unknown}\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n}\n\n/**\n * @hidden\n * @beta */\nexport class ComponentBuilder implements Serializable<Component> {\n  protected spec: BuildableComponent\n\n  constructor(spec?: ComponentInput) {\n    this.spec = {options: {}, ...(spec ? spec : {})}\n  }\n\n  id(id: string): ComponentBuilder {\n    return this.clone({id})\n  }\n\n  getId(): BuildableComponent['id'] {\n    return this.spec.id\n  }\n\n  title(title: string): ComponentBuilder {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  getTitle(): BuildableComponent['title'] {\n    return this.spec.title\n  }\n\n  child(child: Child): ComponentBuilder {\n    return this.clone({child})\n  }\n\n  getChild(): BuildableComponent['child'] {\n    return this.spec.child\n  }\n\n  component(component: UserComponent): ComponentBuilder {\n    return this.clone({component})\n  }\n\n  getComponent(): BuildableComponent['component'] {\n    return this.spec.component\n  }\n\n  options(options: {[key: string]: unknown}): ComponentBuilder {\n    return this.clone({options})\n  }\n\n  getOptions(): NonNullable<BuildableComponent['options']> {\n    return this.spec.options || {}\n  }\n\n  menuItems(menuItems: (MenuItem | MenuItemBuilder)[]): ComponentBuilder {\n    return this.clone({menuItems})\n  }\n\n  getMenuItems(): BuildableComponent['menuItems'] {\n    return this.spec.menuItems\n  }\n\n  menuItemGroups(menuItemGroups: (MenuItemGroup | MenuItemGroupBuilder)[]): ComponentBuilder {\n    return this.clone({menuItemGroups})\n  }\n\n  getMenuItemGroups(): BuildableComponent['menuItemGroups'] {\n    return this.spec.menuItemGroups\n  }\n\n  serialize(options: SerializeOptions = {path: []}): Component {\n    const {id, title, child, options: componentOptions, component} = this.spec\n    if (!id) {\n      throw new SerializeError(\n        '`id` is required for `component` structure item',\n        options.path,\n        options.index\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!component) {\n      throw new SerializeError(\n        '`component` is required for `component` structure item',\n        options.path,\n        options.index\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    return {\n      id: validateId(id, options.path, options.index),\n      title,\n      type: 'component',\n      child,\n      component,\n      options: componentOptions || {},\n      menuItems: (this.spec.menuItems || []).map((item, i) =>\n        maybeSerializeMenuItem(item, i, options.path)\n      ),\n      menuItemGroups: (this.spec.menuItemGroups || []).map((item, i) =>\n        maybeSerializeMenuItemGroup(item, i, options.path)\n      ),\n    }\n  }\n\n  clone(withSpec?: BuildableComponent): ComponentBuilder {\n    const builder = new ComponentBuilder()\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n","import type {SanityClient} from '@sanity/client'\nimport {\n  DEFAULT_STUDIO_CLIENT_OPTIONS,\n  getDraftId,\n  getPublishedId,\n  type SourceClientOptions,\n} from 'sanity'\n\nexport async function resolveTypeForDocument(\n  getClient: (options: SourceClientOptions) => SanityClient,\n  id: string\n): Promise<string | undefined> {\n  const query = '*[_id in [$documentId, $draftId]]._type'\n  const documentId = getPublishedId(id)\n  const draftId = getDraftId(id)\n\n  const types = await getClient(DEFAULT_STUDIO_CLIENT_OPTIONS).fetch(\n    query,\n    {documentId, draftId},\n    {tag: 'structure.resolve-type'}\n  )\n\n  return types[0]\n}\n","import {kebabCase} from 'lodash'\nimport {Serializable, SerializeOptions, SerializePath} from '../StructureNodes'\nimport {HELP_URL, SerializeError} from '../SerializeError'\nimport {validateId} from '../util/validateId'\nimport {View} from '../types'\nimport {ComponentViewBuilder} from './ComponentView'\nimport {FormViewBuilder} from './FormView'\n\n/**\n * @hidden\n * @beta */\nexport interface BaseView {\n  id: string\n  title: string\n  icon?: React.ComponentType | React.ReactNode\n}\n\n/**\n * @hidden\n * @beta */\nexport abstract class GenericViewBuilder<TView extends Partial<BaseView>, ConcreteImpl>\n  implements Serializable<BaseView>\n{\n  protected spec: TView = {} as TView\n\n  id(id: string): ConcreteImpl {\n    return this.clone({id})\n  }\n\n  getId(): TView['id'] {\n    return this.spec.id\n  }\n\n  title(title: string): ConcreteImpl {\n    return this.clone({title, id: this.spec.id || kebabCase(title)})\n  }\n\n  getTitle(): TView['title'] {\n    return this.spec.title\n  }\n\n  icon(icon: React.ComponentType | React.ReactNode): ConcreteImpl {\n    return this.clone({icon})\n  }\n\n  getIcon(): TView['icon'] {\n    return this.spec.icon\n  }\n\n  serialize(options: SerializeOptions = {path: []}): BaseView {\n    const {id, title, icon} = this.spec\n    if (!id) {\n      throw new SerializeError(\n        '`id` is required for view item',\n        options.path,\n        options.index\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!title) {\n      throw new SerializeError(\n        '`title` is required for view item',\n        options.path,\n        options.index\n      ).withHelpUrl(HELP_URL.TITLE_REQUIRED)\n    }\n\n    return {\n      id: validateId(id, options.path, options.index),\n      title,\n      icon,\n    }\n  }\n\n  abstract clone(withSpec?: Partial<BaseView>): ConcreteImpl\n}\n\nfunction isSerializable(view: BaseView | Serializable<BaseView>): view is Serializable<BaseView> {\n  return typeof (view as Serializable<BaseView>).serialize === 'function'\n}\n\n/** @internal */\nexport function maybeSerializeView(\n  item: View | Serializable<View>,\n  index: number,\n  path: SerializePath\n): View {\n  return isSerializable(item) ? item.serialize({path, index}) : item\n}\n\n/**\n * @hidden\n * @beta */\nexport type ViewBuilder = ComponentViewBuilder | FormViewBuilder\n","import {SerializeOptions} from '../StructureNodes'\nimport {SerializeError, HELP_URL} from '../SerializeError'\nimport type {UserViewComponent} from '../types'\nimport {BaseView, GenericViewBuilder} from './View'\nimport {isRecord} from 'sanity'\n\n/**\n * @hidden\n * @beta */\nexport interface ComponentView<TOptions = Record<string, any>> extends BaseView {\n  type: 'component'\n  component: UserViewComponent\n  options: TOptions\n}\n\nconst isComponentSpec = (spec: unknown): spec is ComponentView =>\n  isRecord(spec) && spec.type === 'component'\n\n/**\n * @hidden\n * @beta */\nexport class ComponentViewBuilder extends GenericViewBuilder<\n  Partial<ComponentView>,\n  ComponentViewBuilder\n> {\n  protected spec: Partial<ComponentView>\n\n  constructor(componentOrSpec?: UserViewComponent | Partial<ComponentView>) {\n    const spec = isComponentSpec(componentOrSpec) ? {...componentOrSpec} : {options: {}}\n\n    super()\n    this.spec = spec\n\n    const userComponent =\n      typeof componentOrSpec === 'function' ? componentOrSpec : this.spec.component\n\n    if (userComponent) {\n      // Because we're cloning, this'll return a new instance, so grab the spec from it\n      this.spec = this.component(userComponent).spec\n    }\n  }\n\n  component(component: UserViewComponent): ComponentViewBuilder {\n    return this.clone({component})\n  }\n\n  getComponent(): Partial<ComponentView>['component'] {\n    return this.spec.component\n  }\n\n  options(options: {[key: string]: any}): ComponentViewBuilder {\n    return this.clone({options})\n  }\n\n  getOptions(): ComponentView['options'] {\n    return this.spec.options || {}\n  }\n\n  serialize(options: SerializeOptions = {path: []}): ComponentView {\n    const base = super.serialize(options)\n\n    const component = this.spec.component\n    if (typeof component !== 'function') {\n      throw new SerializeError(\n        '`component` is required and must be a function for `component()` view item',\n        options.path,\n        options.index\n      ).withHelpUrl(HELP_URL.COMPONENT_REQUIRED)\n    }\n\n    return {\n      ...base,\n      component,\n      options: this.spec.options || {},\n      type: 'component',\n    }\n  }\n\n  clone(withSpec?: Partial<ComponentView>): ComponentViewBuilder {\n    const builder = new ComponentViewBuilder()\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n","import {SerializeOptions} from '../StructureNodes'\nimport {BaseView, GenericViewBuilder} from './View'\n\n/**\n * @hidden\n * @beta */\nexport interface FormView extends BaseView {\n  type: 'form'\n}\n\n/**\n * @hidden\n * @beta */\nexport class FormViewBuilder extends GenericViewBuilder<Partial<BaseView>, FormViewBuilder> {\n  protected spec: Partial<FormView>\n\n  constructor(spec?: Partial<FormView>) {\n    super()\n    this.spec = {id: 'editor', title: 'Editor', ...(spec ? spec : {})}\n  }\n\n  serialize(options: SerializeOptions = {path: []}): FormView {\n    return {\n      ...super.serialize(options),\n      type: 'form',\n    }\n  }\n\n  clone(withSpec?: Partial<FormView>): FormViewBuilder {\n    const builder = new FormViewBuilder()\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n","import type {UserViewComponent} from '../types'\nimport {ComponentView, ComponentViewBuilder} from './ComponentView'\nimport {FormView, FormViewBuilder} from './FormView'\n\nexport * from './FormView'\nexport * from './ComponentView'\nexport * from './View'\n\n/** @internal */\nexport const form = (spec?: Partial<FormView>): FormViewBuilder => new FormViewBuilder(spec)\n\n/** @internal */\nexport const component = (\n  componentOrSpec?: UserViewComponent | Partial<ComponentView>\n): ComponentViewBuilder => new ComponentViewBuilder(componentOrSpec)\n","import {uniq} from 'lodash'\nimport {SchemaType} from '@sanity/types'\nimport {resolveTypeForDocument} from './util/resolveTypeForDocument'\nimport {ChildResolver} from './ChildResolver'\nimport {SerializeOptions, Serializable, Child, DocumentNode, EditorNode} from './StructureNodes'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {validateId} from './util/validateId'\nimport {ViewBuilder, maybeSerializeView} from './views/View'\nimport {form} from './views'\nimport type {StructureContext, View} from './types'\nimport {getStructureNodeId} from './util/getStructureNodeId'\n\nconst createDocumentChildResolver =\n  ({resolveDocumentNode, getClient}: StructureContext): ChildResolver =>\n  async (itemId, {params, path}) => {\n    let type = params.type\n\n    const parentPath = path.slice(0, path.length - 1)\n    const currentSegment = path[path.length - 1]\n\n    if (!type) {\n      type = await resolveTypeForDocument(getClient, itemId)\n    }\n\n    if (!type) {\n      throw new SerializeError(\n        `Failed to resolve document, and no type provided in parameters.`,\n        parentPath,\n        currentSegment\n      )\n    }\n\n    return resolveDocumentNode({documentId: itemId, schemaType: type})\n  }\n\n/**\n * @hidden\n * @beta */\nexport interface DocumentOptions {\n  id: string\n  type: string\n  template?: string\n  templateParameters?: Record<string, unknown>\n}\n\n/**\n * @hidden\n * @beta */\nexport type PartialDocumentNode = {\n  id?: string\n  title?: string\n  child?: Child\n  views?: (View | ViewBuilder)[]\n  options?: Partial<DocumentOptions>\n}\n\n/**\n * @hidden\n * @beta */\nexport class DocumentBuilder implements Serializable<DocumentNode> {\n  protected spec: PartialDocumentNode\n\n  constructor(protected _context: StructureContext, spec?: PartialDocumentNode) {\n    this.spec = spec ? spec : {}\n  }\n\n  id(id: string): DocumentBuilder {\n    return this.clone({id})\n  }\n\n  getId(): PartialDocumentNode['id'] {\n    return this.spec.id\n  }\n\n  title(title: string): DocumentBuilder {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  getTitle(): PartialDocumentNode['title'] {\n    return this.spec.title\n  }\n\n  child(child: Child): DocumentBuilder {\n    return this.clone({child})\n  }\n\n  getChild(): PartialDocumentNode['child'] {\n    return this.spec.child\n  }\n\n  documentId(documentId: string): DocumentBuilder {\n    // Let's try to be a bit helpful and assign an ID from document ID if none is specified\n    const paneId = this.spec.id || documentId\n    return this.clone({\n      id: paneId,\n      options: {\n        ...(this.spec.options || {}),\n        id: documentId,\n      },\n    })\n  }\n\n  getDocumentId(): Partial<DocumentOptions>['id'] {\n    return this.spec.options?.id\n  }\n\n  schemaType(documentType: SchemaType | string): DocumentBuilder {\n    return this.clone({\n      options: {\n        ...(this.spec.options || {}),\n        type: typeof documentType === 'string' ? documentType : documentType.name,\n      },\n    })\n  }\n\n  getSchemaType(): Partial<DocumentOptions>['type'] {\n    return this.spec.options?.type\n  }\n\n  initialValueTemplate(templateId: string, parameters?: Record<string, unknown>): DocumentBuilder {\n    return this.clone({\n      options: {\n        ...(this.spec.options || {}),\n        template: templateId,\n        templateParameters: parameters,\n      },\n    })\n  }\n\n  getInitialValueTemplate(): Partial<DocumentOptions>['template'] {\n    return this.spec.options?.template\n  }\n\n  getInitialValueTemplateParameters(): Partial<DocumentOptions>['templateParameters'] {\n    return this.spec.options?.templateParameters\n  }\n\n  views(views: (View | ViewBuilder)[]): DocumentBuilder {\n    return this.clone({views})\n  }\n\n  getViews(): (View | ViewBuilder)[] {\n    return this.spec.views || []\n  }\n\n  serialize({path = [], index, hint}: SerializeOptions = {path: []}): DocumentNode {\n    const urlId = path[index || path.length - 1]\n\n    // Try to grab document ID / editor ID from URL if not defined\n    const id = this.spec.id || (urlId && `${urlId}`) || ''\n    const options: Partial<DocumentOptions> = {\n      id,\n      type: undefined,\n      template: undefined,\n      templateParameters: undefined,\n      ...this.spec.options,\n    }\n\n    if (typeof id !== 'string' || !id) {\n      throw new SerializeError(\n        '`id` is required for document nodes',\n        path,\n        index,\n        hint\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!options || !options.id) {\n      throw new SerializeError(\n        'document id (`id`) is required for document nodes',\n        path,\n        id,\n        hint\n      ).withHelpUrl(HELP_URL.DOCUMENT_ID_REQUIRED)\n    }\n\n    if (!options || !options.type) {\n      throw new SerializeError(\n        'document type (`schemaType`) is required for document nodes',\n        path,\n        id,\n        hint\n      )\n    }\n\n    const views = (this.spec.views && this.spec.views.length > 0 ? this.spec.views : [form()]).map(\n      (item, i) => maybeSerializeView(item, i, path)\n    )\n\n    const viewIds = views.map((view) => view.id)\n    const dupes = uniq(viewIds.filter((viewId, i) => viewIds.includes(viewId, i + 1)))\n    if (dupes.length > 0) {\n      throw new SerializeError(\n        `document node has views with duplicate IDs: ${dupes.join(',  ')}`,\n        path,\n        id,\n        hint\n      )\n    }\n\n    return {\n      ...this.spec,\n      child: this.spec.child || createDocumentChildResolver(this._context),\n      id: validateId(id, path, index),\n      type: 'document',\n      options: getDocumentOptions(options),\n      views,\n    }\n  }\n\n  clone(withSpec: PartialDocumentNode = {}): DocumentBuilder {\n    const builder = new DocumentBuilder(this._context)\n    const options = {...(this.spec.options || {}), ...(withSpec.options || {})}\n    builder.spec = {...this.spec, ...withSpec, options}\n    return builder\n  }\n}\n\nfunction getDocumentOptions(spec: Partial<DocumentOptions>): DocumentOptions {\n  const opts: DocumentOptions = {\n    id: spec.id || '',\n    type: spec.type || '*',\n  }\n\n  if (spec.template) {\n    opts.template = spec.template\n  }\n\n  if (spec.templateParameters) {\n    opts.templateParameters = spec.templateParameters\n  }\n\n  return opts\n}\n\n/** @internal */\nexport function documentFromEditor(context: StructureContext, spec?: EditorNode): DocumentBuilder {\n  let doc = spec?.type\n    ? // Use user-defined document fragment as base if possible\n      context.resolveDocumentNode({schemaType: spec.type})\n    : // Fall back to plain old document builder\n      new DocumentBuilder(context)\n\n  if (!spec) return doc\n\n  const {id, type, template, templateParameters} = spec.options\n  doc = doc.id(spec.id).documentId(id)\n\n  if (type) {\n    doc = doc.schemaType(type)\n  }\n  if (template) {\n    doc = doc.initialValueTemplate(template, templateParameters)\n  }\n  if (spec.child) {\n    doc = doc.child(spec.child)\n  }\n\n  return doc\n}\n\n/** @internal */\nexport function documentFromEditorWithInitialValue(\n  {resolveDocumentNode, templates}: StructureContext,\n  templateId: string,\n  parameters?: Record<string, unknown>\n): DocumentBuilder {\n  const template = templates.find((t) => t.id === templateId)\n\n  if (!template) {\n    throw new Error(`Template with ID \"${templateId}\" not defined`)\n  }\n\n  return resolveDocumentNode({schemaType: template.schemaType}).initialValueTemplate(\n    templateId,\n    parameters\n  )\n}\n","export const layoutOptions = ['default', 'card', 'media', 'detail', 'block']\n","import {PartialDocumentList, getTypeNamesFromFilter} from './DocumentList'\nimport {StructureNode} from './StructureNodes'\n\n/**\n * @hidden\n * @beta */\nexport type IntentJsonParams = {[key: string]: any}\n\n/**\n * @hidden\n * @beta */\nexport type BaseIntentParams = {\n  type?: string\n  id?: string\n  template?: string\n}\n\n/** @internal */\nexport const DEFAULT_INTENT_HANDLER = Symbol('Document type list canHandleIntent')\n\n/**\n * @hidden\n * @beta */\nexport type IntentParams = BaseIntentParams | [BaseIntentParams, IntentJsonParams]\n\n/**\n * @hidden\n * @beta */\n// TODO: intents should be unified somewhere\nexport interface Intent {\n  type: string\n  params?: IntentParams\n}\n\n/**\n * @hidden\n * @beta */\nexport interface IntentChecker {\n  (\n    intentName: string,\n    params: {[key: string]: any},\n    context: {pane: StructureNode; index: number}\n  ): boolean\n  identity?: symbol\n}\n\n/** @internal */\nexport const defaultIntentChecker: IntentChecker = (intentName, params, {pane}): boolean => {\n  const isEdit = intentName === 'edit'\n  const isCreate = intentName === 'create'\n  const typedSpec = pane as PartialDocumentList\n  const paneFilter = typedSpec.options?.filter || ''\n  const paneParams = typedSpec.options?.params || {}\n  const typeNames = typedSpec.schemaTypeName\n    ? [typedSpec.schemaTypeName]\n    : getTypeNamesFromFilter(paneFilter, paneParams)\n\n  const initialValueTemplates = typedSpec.initialValueTemplates || []\n\n  if (isCreate && params.template) {\n    return initialValueTemplates.some((tpl) => tpl.templateId === params.template)\n  }\n\n  return (\n    (isEdit && params.id && typeNames.includes(params.type)) ||\n    (isCreate && typeNames.includes(params.type))\n  )\n}\n\ndefaultIntentChecker.identity = DEFAULT_INTENT_HANDLER\n","import {pickBy} from 'lodash'\nimport {ComposeIcon} from '@sanity/icons'\nimport {HELP_URL, SerializeError} from './SerializeError'\nimport {Serializable, SerializeOptions, SerializePath} from './StructureNodes'\nimport {MenuItemBuilder, MenuItem} from './MenuItem'\nimport {IntentParams} from './Intent'\nimport {StructureContext} from './types'\nimport {InitialValueTemplateItem} from 'sanity'\n\n/**\n * @hidden\n * @beta */\nexport class InitialValueTemplateItemBuilder implements Serializable<InitialValueTemplateItem> {\n  protected spec: Partial<InitialValueTemplateItem>\n\n  constructor(protected _context: StructureContext, spec?: Partial<InitialValueTemplateItem>) {\n    this.spec = spec ? spec : {}\n  }\n\n  id(id: string): InitialValueTemplateItemBuilder {\n    return this.clone({id})\n  }\n\n  getId(): Partial<InitialValueTemplateItem>['id'] {\n    return this.spec.id\n  }\n\n  title(title: string): InitialValueTemplateItemBuilder {\n    return this.clone({title})\n  }\n\n  getTitle(): Partial<InitialValueTemplateItem>['title'] {\n    return this.spec.title\n  }\n\n  description(description: string): InitialValueTemplateItemBuilder {\n    return this.clone({description})\n  }\n\n  getDescription(): Partial<InitialValueTemplateItem>['description'] {\n    return this.spec.description\n  }\n\n  templateId(templateId: string): InitialValueTemplateItemBuilder {\n    // Let's try to be a bit helpful and assign an ID from template ID if none is specified\n    const paneId = this.spec.id || templateId\n    return this.clone({\n      id: paneId,\n      templateId,\n    })\n  }\n\n  getTemplateId(): Partial<InitialValueTemplateItem>['templateId'] {\n    return this.spec.templateId\n  }\n\n  parameters(parameters: {[key: string]: any}): InitialValueTemplateItemBuilder {\n    return this.clone({parameters})\n  }\n\n  getParameters(): Partial<InitialValueTemplateItem>['parameters'] {\n    return this.spec.parameters\n  }\n\n  serialize({path = [], index, hint}: SerializeOptions = {path: []}): InitialValueTemplateItem {\n    const {spec, _context} = this\n    const {templates} = _context\n\n    if (typeof spec.id !== 'string' || !spec.id) {\n      throw new SerializeError(\n        '`id` is required for initial value template item nodes',\n        path,\n        index,\n        hint\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!spec.templateId) {\n      throw new SerializeError(\n        'template id (`templateId`) is required for initial value template item nodes',\n        path,\n        spec.id,\n        hint\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    const template = templates.find((t) => t.id === spec.templateId)\n\n    if (!template) {\n      throw new SerializeError(\n        'template id (`templateId`) is required for initial value template item nodes',\n        path,\n        spec.id,\n        hint\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    return {\n      id: spec.id,\n      templateId: spec.id,\n      schemaType: template.schemaType,\n      type: 'initialValueTemplateItem',\n      description: spec.description || template.description,\n      title: spec.title || template.title,\n      subtitle: spec.subtitle,\n      icon: spec.icon || template.icon,\n      initialDocumentId: spec.initialDocumentId,\n      parameters: spec.parameters,\n    }\n  }\n\n  clone(withSpec: Partial<InitialValueTemplateItem> = {}): InitialValueTemplateItemBuilder {\n    const builder = new InitialValueTemplateItemBuilder(this._context)\n    builder.spec = {...this.spec, ...withSpec}\n    return builder\n  }\n}\n\n/** @internal */\nexport function defaultInitialValueTemplateItems(\n  context: StructureContext\n): InitialValueTemplateItemBuilder[] {\n  const {schema, getStructureBuilder, templates} = context\n\n  // Sort templates by their schema type, in order or definition\n  const typeNames = schema.getTypeNames()\n  const ordered = templates\n    // Don't list templates that require parameters\n    // TODO: this should use the new-document template items instead maybe?\n    .filter((tpl) => !tpl.parameters?.length)\n    .sort((a, b) => typeNames.indexOf(a.schemaType) - typeNames.indexOf(b.schemaType))\n\n  // Create actual template items out of the templates\n  return ordered.map((tpl) => getStructureBuilder().initialValueTemplateItem(tpl.id))\n}\n\n/** @internal */\nexport function maybeSerializeInitialValueTemplateItem(\n  item: InitialValueTemplateItem | InitialValueTemplateItemBuilder,\n  index: number,\n  path: SerializePath\n): InitialValueTemplateItem {\n  return item instanceof InitialValueTemplateItemBuilder ? item.serialize({path, index}) : item\n}\n\n/** @internal */\nexport function menuItemsFromInitialValueTemplateItems(\n  context: StructureContext,\n  templateItems: InitialValueTemplateItem[]\n): MenuItem[] {\n  const {schema, templates} = context\n  return templateItems.map((item) => {\n    const template = templates.find((t) => t.id === item.templateId)\n    const title = item.title || template?.title || 'Create new'\n    const params = pickBy(\n      {type: template && template.schemaType, template: item.templateId},\n      Boolean\n    )\n    const intentParams: IntentParams = item.parameters ? [params, item.parameters] : params\n    const schemaType = template && schema.get(template.schemaType)\n\n    return new MenuItemBuilder(context)\n      .title(title)\n      .icon((template && template.icon) || schemaType?.icon || ComposeIcon)\n      .intent({type: 'create', params: intentParams})\n      .serialize()\n  })\n}\n","import {Child, Serializable, SerializeOptions, StructureNode} from './StructureNodes'\nimport {layoutOptions} from './Layout'\nimport {MenuItem, MenuItemBuilder, maybeSerializeMenuItem} from './MenuItem'\nimport {MenuItemGroup, MenuItemGroupBuilder, maybeSerializeMenuItemGroup} from './MenuItemGroup'\nimport {IntentChecker, defaultIntentChecker} from './Intent'\nimport {SerializeError} from './SerializeError'\nimport {\n  InitialValueTemplateItemBuilder,\n  maybeSerializeInitialValueTemplateItem,\n} from './InitialValueTemplateItem'\nimport {validateId} from './util/validateId'\nimport {getStructureNodeId} from './util/getStructureNodeId'\nimport {PreviewLayoutKey, InitialValueTemplateItem} from 'sanity'\n\nfunction noChildResolver() {\n  return undefined\n}\n\n/** @internal */\nexport const shallowIntentChecker: IntentChecker = (intentName, params, {pane, index}): boolean => {\n  return index <= 1 && defaultIntentChecker(intentName, params, {pane, index})\n}\n\n/**\n * @hidden\n * @beta */\nexport interface ListDisplayOptions {\n  showIcons?: boolean\n}\n\n/**\n * @hidden\n * @beta */\nexport interface BaseGenericList extends StructureNode {\n  defaultLayout?: PreviewLayoutKey\n  canHandleIntent?: IntentChecker\n  displayOptions?: ListDisplayOptions\n  child: Child\n  initialValueTemplates?: (InitialValueTemplateItem | InitialValueTemplateItemBuilder)[]\n}\n\n/**\n * @hidden\n * @beta */\n// \"POJO\"/verbatim-version - end result\nexport interface GenericList extends BaseGenericList {\n  type: string\n  menuItems: MenuItem[]\n  menuItemGroups: MenuItemGroup[]\n}\n\n/**\n * @hidden\n * @beta */\n// Used internally in builder classes to make everything optional\nexport interface BuildableGenericList extends Partial<BaseGenericList> {\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n}\n\n/**\n * @hidden\n * @beta */\n// Input version, allows builders and only requires things not inferrable\nexport interface GenericListInput extends StructureNode {\n  id: string\n  title: string\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n  initialValueTemplates?: (InitialValueTemplateItem | InitialValueTemplateItemBuilder)[]\n  defaultLayout?: PreviewLayoutKey\n  canHandleIntent?: IntentChecker\n  child?: Child\n}\n\n/**\n * @hidden\n * @beta */\nexport abstract class GenericListBuilder<TList extends BuildableGenericList, ConcreteImpl>\n  implements Serializable<GenericList>\n{\n  protected initialValueTemplatesSpecified = false\n  protected spec: TList = {} as TList\n\n  id(id: string): ConcreteImpl {\n    return this.clone({id})\n  }\n\n  getId(): TList['id'] {\n    return this.spec.id\n  }\n\n  title(title: string): ConcreteImpl {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  getTitle(): TList['title'] {\n    return this.spec.title\n  }\n\n  defaultLayout(defaultLayout: PreviewLayoutKey): ConcreteImpl {\n    return this.clone({defaultLayout})\n  }\n\n  getDefaultLayout(): TList['defaultLayout'] {\n    return this.spec.defaultLayout\n  }\n\n  menuItems(menuItems: (MenuItem | MenuItemBuilder)[] | undefined): ConcreteImpl {\n    return this.clone({menuItems})\n  }\n\n  getMenuItems(): TList['menuItems'] {\n    return this.spec.menuItems\n  }\n\n  menuItemGroups(menuItemGroups: (MenuItemGroup | MenuItemGroupBuilder)[]): ConcreteImpl {\n    return this.clone({menuItemGroups})\n  }\n\n  getMenuItemGroups(): TList['menuItemGroups'] {\n    return this.spec.menuItemGroups\n  }\n\n  child(child: Child): ConcreteImpl {\n    return this.clone({child})\n  }\n\n  getChild(): TList['child'] {\n    return this.spec.child\n  }\n\n  canHandleIntent(canHandleIntent: IntentChecker): ConcreteImpl {\n    return this.clone({canHandleIntent})\n  }\n\n  getCanHandleIntent(): TList['canHandleIntent'] {\n    return this.spec.canHandleIntent\n  }\n\n  showIcons(enabled = true): ConcreteImpl {\n    return this.clone({\n      displayOptions: {...(this.spec.displayOptions || {}), showIcons: enabled},\n    })\n  }\n\n  getShowIcons(): boolean | undefined {\n    return this.spec.displayOptions ? this.spec.displayOptions.showIcons : undefined\n  }\n\n  initialValueTemplates(\n    templates:\n      | InitialValueTemplateItem\n      | InitialValueTemplateItemBuilder\n      | Array<InitialValueTemplateItem | InitialValueTemplateItemBuilder>\n  ): ConcreteImpl {\n    this.initialValueTemplatesSpecified = true\n    return this.clone({initialValueTemplates: Array.isArray(templates) ? templates : [templates]})\n  }\n\n  getInitialValueTemplates(): TList['initialValueTemplates'] {\n    return this.spec.initialValueTemplates\n  }\n\n  serialize(options: SerializeOptions = {path: []}): GenericList {\n    const id = this.spec.id || ''\n    const path = options.path\n\n    const defaultLayout = this.spec.defaultLayout\n    if (defaultLayout && !layoutOptions.includes(defaultLayout)) {\n      throw new SerializeError(\n        `\\`layout\\` must be one of ${layoutOptions.map((item) => `\"${item}\"`).join(', ')}`,\n        path,\n        id || options.index,\n        this.spec.title\n      )\n    }\n\n    const initialValueTemplates = (this.spec.initialValueTemplates || []).map((item, i) =>\n      maybeSerializeInitialValueTemplateItem(item, i, path)\n    )\n\n    return {\n      id: validateId(id, options.path, id || options.index),\n      title: this.spec.title,\n      type: 'genericList',\n      defaultLayout,\n      child: this.spec.child || noChildResolver,\n      canHandleIntent: this.spec.canHandleIntent || shallowIntentChecker,\n      displayOptions: this.spec.displayOptions,\n      initialValueTemplates,\n      menuItems: (this.spec.menuItems || []).map((item, i) =>\n        maybeSerializeMenuItem(item, i, path)\n      ),\n      menuItemGroups: (this.spec.menuItemGroups || []).map((item, i) =>\n        maybeSerializeMenuItemGroup(item, i, path)\n      ),\n    }\n  }\n\n  abstract clone(_withSpec?: object): ConcreteImpl\n}\n","import {SchemaType, SortOrderingItem} from '@sanity/types'\nimport {ComposeIcon} from '@sanity/icons'\nimport {resolveTypeForDocument} from './util/resolveTypeForDocument'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {SerializeOptions, Child} from './StructureNodes'\nimport {ChildResolver, ChildResolverOptions, ItemChild} from './ChildResolver'\nimport {\n  GenericListBuilder,\n  BuildableGenericList,\n  GenericList,\n  GenericListInput,\n} from './GenericList'\nimport {DocumentBuilder} from './Document'\nimport {StructureContext} from './types'\nimport {InitialValueTemplateItem} from 'sanity'\n\nconst validateFilter = (spec: PartialDocumentList, options: SerializeOptions) => {\n  const filter = spec.options?.filter.trim() || ''\n\n  if (['*', '{'].includes(filter[0])) {\n    throw new SerializeError(\n      `\\`filter\\` cannot start with \\`${filter[0]}\\` - looks like you are providing a query, not a filter`,\n      options.path,\n      spec.id,\n      spec.title\n    ).withHelpUrl(HELP_URL.QUERY_PROVIDED_FOR_FILTER)\n  }\n\n  return filter\n}\n\nconst createDocumentChildResolverForItem =\n  (context: StructureContext): ChildResolver =>\n  (itemId: string, options: ChildResolverOptions): ItemChild | Promise<ItemChild> | undefined => {\n    const parentItem = options.parent as DocumentList\n    const template = options.params?.template\n      ? context.templates.find((tpl) => tpl.id === options.params.template)\n      : undefined\n    const type = template\n      ? template.schemaType\n      : parentItem.schemaTypeName || resolveTypeForDocument(context.getClient, itemId)\n\n    return Promise.resolve(type).then((schemaType) =>\n      schemaType\n        ? context.resolveDocumentNode({schemaType, documentId: itemId})\n        : new DocumentBuilder(context).id('editor').documentId(itemId).schemaType('')\n    )\n  }\n\n/**\n * @hidden\n * @beta */\nexport interface PartialDocumentList extends BuildableGenericList {\n  options?: DocumentListOptions\n  schemaTypeName?: string\n}\n\n/**\n * @hidden\n * @beta */\nexport interface DocumentListInput extends GenericListInput {\n  options: DocumentListOptions\n}\n\n/**\n * @hidden\n * @beta */\nexport interface DocumentList extends GenericList {\n  type: 'documentList'\n  options: DocumentListOptions\n  child: Child\n  schemaTypeName?: string\n}\n\n/**\n * @hidden\n * @beta */\nexport interface DocumentListOptions {\n  filter: string\n  params?: Record<string, unknown>\n  apiVersion?: string\n  defaultOrdering?: SortOrderingItem[]\n}\n\n/**\n * @hidden\n * @beta */\nexport class DocumentListBuilder extends GenericListBuilder<\n  PartialDocumentList,\n  DocumentListBuilder\n> {\n  protected spec: PartialDocumentList\n\n  constructor(protected _context: StructureContext, spec?: DocumentListInput) {\n    super()\n    this.spec = spec || {}\n    this.initialValueTemplatesSpecified = Boolean(spec?.initialValueTemplates)\n  }\n\n  apiVersion(apiVersion: string): DocumentListBuilder {\n    return this.clone({options: {...(this.spec.options || {filter: ''}), apiVersion}})\n  }\n\n  getApiVersion(): string | undefined {\n    return this.spec.options?.apiVersion\n  }\n\n  filter(filter: string): DocumentListBuilder {\n    return this.clone({options: {...(this.spec.options || {}), filter}})\n  }\n\n  getFilter(): string | undefined {\n    return this.spec.options?.filter\n  }\n\n  schemaType(type: SchemaType | string): DocumentListBuilder {\n    const schemaTypeName = typeof type === 'string' ? type : type.name\n    return this.clone({schemaTypeName})\n  }\n\n  getSchemaType(): string | undefined {\n    return this.spec.schemaTypeName\n  }\n\n  params(params: Record<string, unknown>): DocumentListBuilder {\n    return this.clone({\n      options: {...(this.spec.options || {filter: ''}), params},\n    })\n  }\n\n  getParams(): Record<string, unknown> | undefined {\n    return this.spec.options?.params\n  }\n\n  defaultOrdering(ordering: SortOrderingItem[]): DocumentListBuilder {\n    if (!Array.isArray(ordering)) {\n      throw new Error('`defaultOrdering` must be an array of order clauses')\n    }\n\n    return this.clone({\n      options: {...(this.spec.options || {filter: ''}), defaultOrdering: ordering},\n    })\n  }\n\n  getDefaultOrdering(): SortOrderingItem[] | undefined {\n    return this.spec.options?.defaultOrdering\n  }\n\n  serialize(options: SerializeOptions = {path: []}): DocumentList {\n    if (typeof this.spec.id !== 'string' || !this.spec.id) {\n      throw new SerializeError(\n        '`id` is required for document lists',\n        options.path,\n        options.index,\n        this.spec.title\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!this.spec.options || !this.spec.options.filter) {\n      throw new SerializeError(\n        '`filter` is required for document lists',\n        options.path,\n        this.spec.id,\n        this.spec.title\n      ).withHelpUrl(HELP_URL.FILTER_REQUIRED)\n    }\n\n    return {\n      ...super.serialize(options),\n      type: 'documentList',\n      schemaTypeName: this.spec.schemaTypeName,\n      child: this.spec.child || createDocumentChildResolverForItem(this._context),\n      options: {\n        ...this.spec.options,\n        apiVersion:\n          this.spec.options.apiVersion ||\n          // If this is a simple type filter, use modern API version - otherwise default to v1\n          (this.spec.options?.filter === '_type == $type' ? '2021-06-07' : '1'),\n        filter: validateFilter(this.spec, options),\n      },\n    }\n  }\n\n  clone(withSpec?: PartialDocumentList): DocumentListBuilder {\n    const builder = new DocumentListBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n\n    if (!this.initialValueTemplatesSpecified) {\n      builder.spec.initialValueTemplates = inferInitialValueTemplates(this._context, builder.spec)\n    }\n\n    if (!builder.spec.schemaTypeName) {\n      builder.spec.schemaTypeName = inferTypeName(builder.spec)\n    }\n\n    return builder\n  }\n\n  getSpec(): PartialDocumentList {\n    return this.spec\n  }\n}\n\nfunction inferInitialValueTemplates(\n  context: StructureContext,\n  spec: PartialDocumentList\n): InitialValueTemplateItem[] | undefined {\n  const {document} = context\n  const {schemaTypeName, options} = spec\n  const {filter, params} = options || {filter: '', params: {}}\n  const typeNames = schemaTypeName\n    ? [schemaTypeName]\n    : Array.from(new Set(getTypeNamesFromFilter(filter, params)))\n\n  if (typeNames.length === 0) {\n    return undefined\n  }\n\n  return typeNames\n    .flatMap((schemaType) =>\n      document.resolveNewDocumentOptions({\n        type: 'structure',\n        schemaType,\n      })\n    )\n    .map((option) => ({...option, icon: ComposeIcon}))\n}\n\nfunction inferTypeName(spec: PartialDocumentList): string | undefined {\n  const {options} = spec\n  const {filter, params} = options || {filter: '', params: {}}\n  const typeNames = getTypeNamesFromFilter(filter, params)\n  return typeNames.length === 1 ? typeNames[0] : undefined\n}\n\n/** @internal */\nexport function getTypeNamesFromFilter(\n  filter: string,\n  params: Record<string, unknown> = {}\n): string[] {\n  let typeNames = getTypeNamesFromEqualityFilter(filter, params)\n\n  if (typeNames.length === 0) {\n    typeNames = getTypeNamesFromInTypesFilter(filter, params)\n  }\n\n  return typeNames\n}\n\n// From _type == \"movie\" || _type == $otherType\nfunction getTypeNamesFromEqualityFilter(\n  filter: string,\n  params: Record<string, unknown> = {}\n): string[] {\n  const pattern =\n    /\\b_type\\s*==\\s*(['\"].*?['\"]|\\$.*?(?:\\s|$))|\\B(['\"].*?['\"]|\\$.*?(?:\\s|$))\\s*==\\s*_type/g\n  const matches: string[] = []\n  let match\n  while ((match = pattern.exec(filter)) !== null) {\n    matches.push(match[1] || match[2])\n  }\n\n  return matches\n    .map((candidate) => {\n      const typeName = candidate[0] === '$' ? params[candidate.slice(1)] : candidate\n      const normalized = ((typeName as string) || '').trim().replace(/^[\"']|[\"']$/g, '')\n      return normalized\n    })\n    .filter(Boolean)\n}\n\n// From _type in [\"dog\", \"cat\", $otherSpecies]\nfunction getTypeNamesFromInTypesFilter(\n  filter: string,\n  params: Record<string, unknown> = {}\n): string[] {\n  const pattern = /\\b_type\\s+in\\s+\\[(.*?)\\]/\n  const matches = filter.match(pattern)\n  if (!matches) {\n    return []\n  }\n\n  return matches[1]\n    .split(/,\\s*/)\n    .map((match) => match.trim().replace(/^[\"']+|[\"']+$/g, ''))\n    .map((item) => (item[0] === '$' ? params[item.slice(1)] : item))\n    .filter(Boolean) as string[]\n}\n","import {find} from 'lodash'\nimport {SerializePath, SerializeOptions, Divider} from './StructureNodes'\nimport {ChildResolverOptions, ChildResolver} from './ChildResolver'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {ListItem, ListItemBuilder} from './ListItem'\nimport {IntentChecker} from './Intent'\nimport {isDocumentListItem} from './DocumentListItem'\nimport {\n  GenericListBuilder,\n  BuildableGenericList,\n  GenericList,\n  GenericListInput,\n  shallowIntentChecker,\n} from './GenericList'\nimport {StructureContext} from './types'\nimport {isRecord} from 'sanity'\n\nconst getArgType = (thing: ListItem) => {\n  if (thing instanceof ListBuilder) {\n    return 'ListBuilder'\n  }\n\n  if (isPromise<ListItem>(thing)) {\n    return 'Promise'\n  }\n\n  return Array.isArray(thing) ? 'array' : typeof thing\n}\n\nconst isListItem = (item: ListItem | Divider): item is ListItem => {\n  return item.type === 'listItem'\n}\n\nconst defaultCanHandleIntent: IntentChecker = (intentName: string, params, context) => {\n  const pane = context.pane as List\n  const items = pane.items || []\n  return (\n    items\n      .filter(isDocumentListItem)\n      .some((item) => item.schemaType.name === params.type && item._id === params.id) ||\n    shallowIntentChecker(intentName, params, context)\n  )\n}\n\nconst resolveChildForItem: ChildResolver = (itemId: string, options: ChildResolverOptions) => {\n  const parentItem = options.parent as List\n  const items = parentItem.items.filter(isListItem)\n  const target = (items.find((item) => item.id === itemId) || {child: undefined}).child\n\n  if (!target || typeof target !== 'function') {\n    return target\n  }\n\n  return typeof target === 'function' ? target(itemId, options) : target\n}\n\nfunction maybeSerializeListItem(\n  item: ListItem | ListItemBuilder | Divider,\n  index: number,\n  path: SerializePath\n): ListItem | Divider {\n  if (item instanceof ListItemBuilder) {\n    return item.serialize({path, index})\n  }\n\n  const listItem = item as ListItem\n  if (listItem && listItem.type === 'divider') {\n    return item as Divider\n  }\n\n  if (!listItem || listItem.type !== 'listItem') {\n    const gotWhat = (listItem && listItem.type) || getArgType(listItem)\n    const helpText = gotWhat === 'array' ? ' - did you forget to spread (...moreItems)?' : ''\n    throw new SerializeError(\n      `List items must be of type \"listItem\", got \"${gotWhat}\"${helpText}`,\n      path,\n      index\n    ).withHelpUrl(HELP_URL.INVALID_LIST_ITEM)\n  }\n\n  return item\n}\n\nfunction isPromise<T>(thing: unknown): thing is PromiseLike<T> {\n  return isRecord(thing) && typeof thing.then === 'function'\n}\n\n/**\n * @hidden\n * @beta */\nexport interface List extends GenericList {\n  type: 'list'\n  items: (ListItem | Divider)[]\n}\n\n/**\n * @hidden\n * @beta */\nexport interface ListInput extends GenericListInput {\n  items?: (ListItem | ListItemBuilder | Divider)[]\n}\n\n/**\n * @hidden\n * @beta */\nexport interface BuildableList extends BuildableGenericList {\n  items?: (ListItem | ListItemBuilder | Divider)[]\n}\n\n/**\n * @hidden\n * @beta */\nexport class ListBuilder extends GenericListBuilder<BuildableList, ListBuilder> {\n  protected spec: BuildableList\n\n  constructor(protected _context: StructureContext, spec?: ListInput) {\n    super()\n    this.spec = spec ? spec : {}\n    this.initialValueTemplatesSpecified = Boolean(spec && spec.initialValueTemplates)\n  }\n\n  items(items: (ListItemBuilder | ListItem | Divider)[]): ListBuilder {\n    return this.clone({items})\n  }\n\n  getItems(): BuildableList['items'] {\n    return this.spec.items\n  }\n\n  serialize(options: SerializeOptions = {path: []}): List {\n    const id = this.spec.id\n    if (typeof id !== 'string' || !id) {\n      throw new SerializeError(\n        '`id` is required for lists',\n        options.path,\n        options.index\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    const items = typeof this.spec.items === 'undefined' ? [] : this.spec.items\n    if (!Array.isArray(items)) {\n      throw new SerializeError(\n        '`items` must be an array of items',\n        options.path,\n        options.index\n      ).withHelpUrl(HELP_URL.LIST_ITEMS_MUST_BE_ARRAY)\n    }\n\n    const path = (options.path || []).concat(id)\n    const serializedItems = items.map((item, index) => maybeSerializeListItem(item, index, path))\n    const dupes = serializedItems.filter((val, i) => find(serializedItems, {id: val.id}, i + 1))\n\n    if (dupes.length > 0) {\n      const dupeIds = dupes.map((item) => item.id).slice(0, 5)\n      const dupeDesc = dupes.length > 5 ? `${dupeIds.join(', ')}...` : dupeIds.join(', ')\n      throw new SerializeError(\n        `List items with same ID found (${dupeDesc})`,\n        options.path,\n        options.index\n      ).withHelpUrl(HELP_URL.LIST_ITEM_IDS_MUST_BE_UNIQUE)\n    }\n\n    return {\n      ...super.serialize(options),\n      type: 'list',\n      canHandleIntent: this.spec.canHandleIntent || defaultCanHandleIntent,\n      child: this.spec.child || resolveChildForItem,\n      items: serializedItems,\n    }\n  }\n\n  clone(withSpec?: BuildableList): ListBuilder {\n    const builder = new ListBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n","import {SchemaType} from '@sanity/types'\nimport {Observable} from 'rxjs'\nimport {SerializeOptions, Serializable, Collection, CollectionBuilder} from './StructureNodes'\nimport {ChildResolver, ItemChild} from './ChildResolver'\nimport {DocumentListBuilder} from './DocumentList'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {ListBuilder} from './List'\nimport {DocumentBuilder} from './Document'\nimport {ComponentBuilder} from './Component'\nimport {validateId} from './util/validateId'\nimport {StructureContext} from './types'\nimport {getStructureNodeId} from './util/getStructureNodeId'\n\n/**\n * @hidden\n * @beta */\nexport type UnserializedListItemChild =\n  | Collection\n  | CollectionBuilder\n  | ChildResolver\n  | Observable<ItemChild>\n\n/**\n * @hidden\n * @beta */\nexport type ListItemChild = Collection | ChildResolver | Observable<ItemChild> | undefined\n\n/**\n * @hidden\n * @beta */\nexport interface ListItemSerializeOptions extends SerializeOptions {\n  titleIsOptional?: boolean\n}\n\n/**\n * @hidden\n * @beta */\nexport interface ListItemDisplayOptions {\n  showIcon?: boolean\n}\n\n/**\n * @hidden\n * @beta */\nexport interface ListItemInput {\n  id: string\n  title?: string\n  icon?: React.ComponentType | React.ReactNode\n  child?: ListItemChild\n  displayOptions?: ListItemDisplayOptions\n  schemaType?: SchemaType | string\n}\n\n/**\n * @hidden\n * @beta */\nexport interface ListItem {\n  id: string\n  type: string\n  title?: string\n  icon?: React.ComponentType | React.ReactNode\n  child?: ListItemChild\n  displayOptions?: ListItemDisplayOptions\n  schemaType?: SchemaType\n}\n\n/**\n * @hidden\n * @beta */\nexport interface UnserializedListItem {\n  id: string\n  title: string\n  icon?: React.ComponentType | React.ReactNode\n  child?: UnserializedListItemChild\n  displayOptions?: ListItemDisplayOptions\n  schemaType?: SchemaType | string\n}\n\n/**\n * @hidden\n * @beta */\nexport type PartialListItem = Partial<UnserializedListItem>\n\n/**\n * @hidden\n * @beta */\nexport class ListItemBuilder implements Serializable<ListItem> {\n  protected spec: PartialListItem\n\n  constructor(protected _context: StructureContext, spec?: ListItemInput) {\n    this.spec = spec ? spec : {}\n  }\n\n  id(id: string): ListItemBuilder {\n    return this.clone({id})\n  }\n\n  getId(): PartialListItem['id'] {\n    return this.spec.id\n  }\n\n  title(title: string): ListItemBuilder {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  getTitle(): PartialListItem['title'] {\n    return this.spec.title\n  }\n\n  icon(icon: React.ComponentType | React.ReactNode): ListItemBuilder {\n    return this.clone({icon})\n  }\n\n  showIcon(enabled = true): ListItemBuilder {\n    return this.clone({\n      displayOptions: {...(this.spec.displayOptions || {}), showIcon: enabled},\n    })\n  }\n\n  getShowIcon(): boolean | undefined {\n    return this.spec.displayOptions ? this.spec.displayOptions.showIcon : undefined\n  }\n\n  getIcon(): PartialListItem['icon'] {\n    return this.spec.icon\n  }\n\n  child(child: UnserializedListItemChild): ListItemBuilder {\n    return this.clone({child})\n  }\n\n  getChild(): PartialListItem['child'] {\n    return this.spec.child\n  }\n\n  schemaType(schemaType: SchemaType | string): ListItemBuilder {\n    return this.clone({schemaType})\n  }\n\n  getSchemaType(): PartialListItem['schemaType'] {\n    const schemaType = this.spec.schemaType\n\n    if (typeof schemaType === 'string') {\n      return this._context.schema.get(schemaType)\n    }\n\n    return this.spec.schemaType\n  }\n\n  serialize(options: ListItemSerializeOptions = {path: []}): ListItem {\n    const {id, title, child} = this.spec\n    if (typeof id !== 'string' || !id) {\n      throw new SerializeError(\n        '`id` is required for list items',\n        options.path,\n        options.index\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!options.titleIsOptional && (typeof title !== 'string' || !title)) {\n      throw new SerializeError('`title` is required for list items', options.path, id).withHelpUrl(\n        HELP_URL.TITLE_REQUIRED\n      )\n    }\n\n    let schemaType = this.spec.schemaType\n    if (typeof schemaType === 'string') {\n      const type = this._context.schema.get(schemaType)\n      if (!type) {\n        throw new SerializeError(\n          `Could not find type \"${schemaType}\" in schema`,\n          options.path,\n          id\n        ).withHelpUrl(HELP_URL.SCHEMA_TYPE_NOT_FOUND)\n      }\n\n      schemaType = type\n    }\n\n    const serializeOptions = {path: options.path.concat(id), hint: 'child'}\n    let listChild =\n      child instanceof ComponentBuilder ||\n      child instanceof DocumentListBuilder ||\n      child instanceof DocumentBuilder ||\n      child instanceof ListBuilder\n        ? child.serialize(serializeOptions)\n        : child\n\n    // In the case of a function, create a bound version that will pass the correct serialize\n    // context, so we may lazily resolve it at some point in the future without losing context\n    if (typeof listChild === 'function') {\n      const originalChild = listChild\n      listChild = (itemId, childOptions) => {\n        return originalChild(itemId, {...childOptions, serializeOptions})\n      }\n    }\n\n    return {\n      ...this.spec,\n      id: validateId(id, options.path, options.index),\n      schemaType,\n      child: listChild,\n      title,\n      type: 'listItem',\n    }\n  }\n\n  clone(withSpec?: PartialListItem): ListItemBuilder {\n    const builder = new ListItemBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n","import {SchemaType} from '@sanity/types'\nimport {SerializeOptions} from './StructureNodes'\nimport {ListItemBuilder, ListItem, UnserializedListItem, ListItemInput} from './ListItem'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {DocumentBuilder} from './Document'\nimport {StructureContext} from './types'\nimport {isRecord} from 'sanity'\n\n/**\n * @hidden\n * @beta */\nexport interface DocumentListItemInput extends ListItemInput {\n  schemaType: SchemaType | string\n}\n\n/**\n * @hidden\n * @beta */\nexport interface DocumentListItem extends ListItem {\n  schemaType: SchemaType\n  _id: string\n}\n\n/**\n * @hidden\n * @beta */\nexport type PartialDocumentListItem = Partial<UnserializedListItem>\n\nconst createDefaultChildResolver =\n  (context: StructureContext, spec: PartialDocumentListItem) => (documentId: string) => {\n    const schemaType =\n      spec.schemaType &&\n      (typeof spec.schemaType === 'string' ? spec.schemaType : spec.schemaType.name)\n\n    return schemaType\n      ? context.resolveDocumentNode({schemaType, documentId})\n      : new DocumentBuilder(context).id('documentEditor').documentId(documentId)\n  }\n\n/**\n * @hidden\n * @beta */\nexport class DocumentListItemBuilder extends ListItemBuilder {\n  protected spec: PartialDocumentListItem\n\n  constructor(protected _context: StructureContext, spec?: DocumentListItemInput) {\n    super(_context, spec)\n    this.spec = spec ? spec : {}\n  }\n\n  serialize(options: SerializeOptions = {path: []}): DocumentListItem {\n    const spec = super.serialize({...options, titleIsOptional: true})\n\n    if (!spec.schemaType) {\n      throw new SerializeError(\n        '`schemaType` is required for document list items',\n        options.path,\n        options.index\n      ).withHelpUrl(HELP_URL.SCHEMA_TYPE_REQUIRED)\n    }\n\n    const child = spec.child || createDefaultChildResolver(this._context, spec)\n    return {...spec, child, schemaType: spec.schemaType, _id: spec.id}\n  }\n\n  clone(withSpec?: PartialDocumentListItem): DocumentListItemBuilder {\n    const builder = new DocumentListItemBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n\n/** @internal */\nexport function isDocumentListItem(item: unknown): item is DocumentListItem {\n  return isRecord(item) && typeof item.schemaType !== 'undefined' && typeof item._id === 'string'\n}\n","import {SchemaType} from '@sanity/types'\nimport {DocumentListBuilder, DocumentListInput, PartialDocumentList} from './DocumentList'\nimport {Child} from './StructureNodes'\nimport {DEFAULT_INTENT_HANDLER} from './Intent'\nimport {GenericListInput} from './GenericList'\nimport {StructureContext} from './types'\n\n/**\n * @hidden\n * @beta */\nexport interface DocumentTypeListInput extends Partial<GenericListInput> {\n  schemaType: SchemaType | string\n}\n\n/**\n * @hidden\n * @beta */\nexport class DocumentTypeListBuilder extends DocumentListBuilder {\n  protected spec: PartialDocumentList\n\n  constructor(protected _context: StructureContext, spec?: DocumentListInput) {\n    super(_context)\n    this.spec = spec ? spec : {}\n  }\n\n  child(child: Child): DocumentTypeListBuilder {\n    return this.cloneWithoutDefaultIntentHandler({child})\n  }\n\n  clone(withSpec?: PartialDocumentList): DocumentTypeListBuilder {\n    const parent = super.clone(withSpec)\n    const builder = new DocumentTypeListBuilder(this._context)\n    builder.spec = {...this.spec, ...parent.getSpec(), ...(withSpec || {})}\n    return builder\n  }\n\n  cloneWithoutDefaultIntentHandler(withSpec?: PartialDocumentList): DocumentTypeListBuilder {\n    const parent = super.clone(withSpec)\n    const builder = new DocumentTypeListBuilder(this._context)\n    const canHandleIntent = this.spec.canHandleIntent\n    const shouldOverride = canHandleIntent && canHandleIntent.identity === DEFAULT_INTENT_HANDLER\n    const override = shouldOverride ? {canHandleIntent: undefined} : {}\n    builder.spec = {\n      ...parent.getSpec(),\n      ...this.spec,\n      ...(withSpec || {}),\n      ...override,\n    }\n    return builder\n  }\n}\n","import {SchemaType} from '@sanity/types'\nimport {startCase} from 'lodash'\nimport {StackCompactIcon, StackIcon} from '@sanity/icons'\nimport {MenuItemBuilder, getOrderingMenuItemsForSchemaType} from './MenuItem'\nimport {DEFAULT_SELECTED_ORDERING_OPTION} from './Sort'\nimport {DocumentListBuilder} from './DocumentList'\nimport {ListItemBuilder, ListItem} from './ListItem'\nimport {DocumentTypeListBuilder, DocumentTypeListInput} from './DocumentTypeList'\nimport {defaultIntentChecker} from './Intent'\nimport {List} from './List'\nimport {Collection} from './StructureNodes'\nimport {StructureContext} from './types'\n\nfunction shouldShowIcon(schemaType: SchemaType): boolean {\n  const preview = schemaType.preview\n  return Boolean(preview && (preview.prepare || (preview.select && preview.select.media)))\n}\n\nconst BUNDLED_DOC_TYPES = ['sanity.imageAsset', 'sanity.fileAsset']\n\nfunction isBundledDocType(typeName: string) {\n  return BUNDLED_DOC_TYPES.includes(typeName)\n}\n\nfunction isDocumentType(schemaType: SchemaType) {\n  return schemaType.type?.name === 'document'\n}\n\nfunction isList(collection: Collection): collection is List {\n  return collection.type === 'list'\n}\n\nexport function getDocumentTypes({schema}: StructureContext): string[] {\n  return schema\n    .getTypeNames()\n    .filter((n) => {\n      const schemaType = schema.get(n)\n      return schemaType && isDocumentType(schemaType)\n    })\n    .filter((n) => !isBundledDocType(n))\n}\n\nexport function getDocumentTypeListItems(context: StructureContext): ListItemBuilder[] {\n  const types = getDocumentTypes(context)\n  return types.map((typeName) => getDocumentTypeListItem(context, typeName))\n}\n\nexport function getDocumentTypeListItem(\n  context: StructureContext,\n  typeName: string\n): ListItemBuilder {\n  const {schema} = context\n\n  const type = schema.get(typeName)\n  if (!type) {\n    throw new Error(`Schema type with name \"${typeName}\" not found`)\n  }\n\n  const title = type.title || startCase(typeName)\n\n  return new ListItemBuilder(context)\n    .id(typeName)\n    .title(title)\n    .schemaType(type)\n    .child((id, childContext) => {\n      const parent = childContext.parent as Collection\n      const parentItem = isList(parent)\n        ? (parent.items.find((item) => item.id === id) as ListItem)\n        : null\n\n      let list = getDocumentTypeList(context, typeName)\n      if (parentItem && parentItem.title) {\n        list = list.title(parentItem.title)\n      }\n\n      return list\n    })\n}\n\nexport function getDocumentTypeList(\n  context: StructureContext,\n  typeNameOrSpec: string | DocumentTypeListInput\n): DocumentListBuilder {\n  const {schema, resolveDocumentNode} = context\n\n  const schemaType = typeof typeNameOrSpec === 'string' ? typeNameOrSpec : typeNameOrSpec.schemaType\n  const typeName = typeof schemaType === 'string' ? schemaType : schemaType.name\n  const spec: DocumentTypeListInput =\n    typeof typeNameOrSpec === 'string' ? {schemaType} : typeNameOrSpec\n\n  const type = schema.get(typeName)\n  if (!type) {\n    throw new Error(`Schema type with name \"${typeName}\" not found`)\n  }\n\n  const title = type.title || startCase(typeName)\n  const showIcons = shouldShowIcon(type)\n\n  return new DocumentTypeListBuilder(context)\n    .id(spec.id || typeName)\n    .title(spec.title || title)\n    .filter('_type == $type')\n    .params({type: typeName})\n    .schemaType(type)\n    .showIcons(showIcons)\n    .defaultOrdering(DEFAULT_SELECTED_ORDERING_OPTION.by)\n    .menuItemGroups(\n      spec.menuItemGroups || [\n        {id: 'sorting', title: 'Sort'},\n        {id: 'layout', title: 'Layout'},\n        {id: 'actions', title: 'Actions'},\n      ]\n    )\n    .child(\n      spec.child ||\n        ((documentId: string) => resolveDocumentNode({schemaType: typeName, documentId}))\n    )\n    .canHandleIntent(spec.canHandleIntent || defaultIntentChecker)\n    .menuItems(\n      spec.menuItems || [\n        // Create new (from action button) will be added in serialization step of GenericList\n\n        // Sort by <Y>\n        ...getOrderingMenuItemsForSchemaType(context, type),\n\n        // Display as <Z>\n        new MenuItemBuilder(context)\n          .group('layout')\n          .title('Compact view')\n          .icon(StackCompactIcon)\n          .action('setLayout')\n          .params({layout: 'default'}),\n\n        new MenuItemBuilder(context)\n          .group('layout')\n          .title('Detailed view')\n          .icon(StackIcon)\n          .action('setLayout')\n          .params({layout: 'detail'}),\n\n        // Create new (from menu) will be added in serialization step of GenericList\n      ]\n    )\n}\n","import {uniqueId} from 'lodash'\nimport type {SchemaType} from '@sanity/types'\nimport {isValidElementType} from 'react-is'\nimport {ListBuilder} from './List'\nimport {\n  getDocumentTypeListItems,\n  getDocumentTypeListItem,\n  getDocumentTypeList,\n} from './documentTypeListItems'\nimport {MenuItemBuilder, getOrderingMenuItemsForSchemaType, getOrderingMenuItem} from './MenuItem'\nimport {ListItemBuilder} from './ListItem'\nimport {MenuItemGroupBuilder} from './MenuItemGroup'\nimport {DocumentListBuilder} from './DocumentList'\nimport type {Divider} from './StructureNodes'\nimport {DocumentBuilder, documentFromEditor, documentFromEditorWithInitialValue} from './Document'\nimport {ComponentInput, ComponentBuilder} from './Component'\nimport {DocumentListItemBuilder} from './DocumentListItem'\nimport * as views from './views'\nimport {\n  InitialValueTemplateItemBuilder,\n  defaultInitialValueTemplateItems,\n  menuItemsFromInitialValueTemplateItems,\n} from './InitialValueTemplateItem'\nimport type {\n  StructureBuilder,\n  UserComponent,\n  StructureContext,\n  DefaultDocumentNodeResolver,\n} from './types'\nimport {Source, getConfigContextFromSource, getPublishedId} from 'sanity'\n\n/** @internal */\nexport interface StructureBuilderOptions {\n  source: Source\n  defaultDocumentNode?: DefaultDocumentNodeResolver\n}\n\nfunction hasIcon(schemaType?: SchemaType | string): boolean {\n  if (!schemaType || typeof schemaType === 'string') {\n    return false\n  }\n\n  return Boolean(schemaType.icon)\n}\n\nfunction getDefaultStructure(context: StructureContext): ListBuilder {\n  const items = getDocumentTypeListItems(context)\n  return new ListBuilder(context)\n    .id('__root__')\n    .title('Content')\n    .items(items)\n    .showIcons(items.some((item) => hasIcon(item.getSchemaType())))\n}\n\n/** @internal */\nexport function createStructureBuilder({\n  defaultDocumentNode,\n  source,\n}: StructureBuilderOptions): StructureBuilder {\n  const configContext = getConfigContextFromSource(source)\n  const context: StructureContext = {\n    ...source,\n    getStructureBuilder: () => structureBuilder,\n    resolveDocumentNode: (options) => {\n      let builder =\n        defaultDocumentNode?.(structureBuilder, {...options, ...configContext}) ||\n        new DocumentBuilder(context)\n\n      if (!builder.getId()) {\n        builder = builder.id('documentEditor')\n      }\n\n      if (options.documentId) {\n        builder = builder.documentId(getPublishedId(options.documentId))\n      }\n\n      return builder.schemaType(options.schemaType)\n    },\n  }\n\n  const structureBuilder: StructureBuilder = {\n    defaults: () => getDefaultStructure(context),\n    documentTypeList: (...args) => getDocumentTypeList(context, ...args),\n    documentTypeListItem: (...args) => getDocumentTypeListItem(context, ...args),\n    documentTypeListItems: (...args) => getDocumentTypeListItems(context, ...args),\n    document: (...args) => new DocumentBuilder(context, ...args),\n    documentWithInitialValueTemplate: (...args) =>\n      documentFromEditorWithInitialValue(context, ...args),\n    defaultDocument: context.resolveDocumentNode,\n\n    list: (...args) => new ListBuilder(context, ...args),\n    listItem: (...args) => new ListItemBuilder(context, ...args),\n\n    menuItem: (...args) => new MenuItemBuilder(context, ...args),\n    menuItemGroup: (...args) => new MenuItemGroupBuilder(context, ...args),\n    menuItemsFromInitialValueTemplateItems: (...args) =>\n      menuItemsFromInitialValueTemplateItems(context, ...args),\n\n    documentList: (...args) => new DocumentListBuilder(context, ...args),\n    documentListItem: (...args) => new DocumentListItemBuilder(context, ...args),\n\n    orderingMenuItem: (...args) => getOrderingMenuItem(context, ...args),\n    orderingMenuItemsForType: (...args) => getOrderingMenuItemsForSchemaType(context, ...args),\n\n    editor: (...args) => documentFromEditor(context, ...args),\n\n    defaultInitialValueTemplateItems: (...args) =>\n      defaultInitialValueTemplateItems(context, ...args),\n\n    initialValueTemplateItem: (\n      templateId: string,\n      parameters?: Record<string, unknown>\n    ): InitialValueTemplateItemBuilder =>\n      new InitialValueTemplateItemBuilder(context, {\n        id: templateId,\n        parameters,\n        templateId,\n      }),\n\n    component: (spec?: ComponentInput | UserComponent) => {\n      return isValidElementType(spec)\n        ? new ComponentBuilder().component(spec as UserComponent)\n        : new ComponentBuilder(spec as ComponentInput)\n    },\n\n    divider: (): Divider => ({id: uniqueId('__divider__'), type: 'divider'}),\n\n    view: views,\n    context,\n  }\n\n  return structureBuilder\n}\n","import React, {useMemo, useState} from 'react'\nimport {DeskToolContext} from './DeskToolContext'\nimport {createStructureBuilder, DefaultDocumentNodeResolver} from './structureBuilder'\nimport {StructureResolver, UnresolvedPaneNode} from './types'\nimport {useConfigContextFromSource, useDocumentStore, useSource} from 'sanity'\n\n/** @internal */\nexport interface DeskToolProviderProps {\n  structure?: StructureResolver\n  defaultDocumentNode?: DefaultDocumentNodeResolver\n  children: React.ReactNode\n}\n\n/** @internal */\nexport function DeskToolProvider({\n  defaultDocumentNode,\n  structure: resolveStructure,\n  children,\n}: DeskToolProviderProps): React.ReactElement {\n  const [layoutCollapsed, setLayoutCollapsed] = useState(false)\n  const source = useSource()\n  const configContext = useConfigContextFromSource(source)\n  const documentStore = useDocumentStore()\n\n  const S = useMemo(() => {\n    return createStructureBuilder({\n      defaultDocumentNode,\n      source,\n    })\n  }, [defaultDocumentNode, source])\n\n  const rootPaneNode = useMemo(() => {\n    // TODO: unify types and remove cast\n    if (resolveStructure)\n      return resolveStructure(S, {\n        ...configContext,\n        documentStore,\n      }) as UnresolvedPaneNode\n    return S.defaults() as UnresolvedPaneNode\n  }, [S, resolveStructure, configContext, documentStore])\n\n  return (\n    <DeskToolContext.Provider\n      value={useMemo(() => {\n        return {\n          features: {\n            backButton: layoutCollapsed,\n            reviewChanges: !layoutCollapsed,\n            splitPanes: !layoutCollapsed,\n            splitViews: !layoutCollapsed,\n          },\n          layoutCollapsed,\n          setLayoutCollapsed,\n          rootPaneNode,\n          structureContext: S.context,\n        }\n      }, [layoutCollapsed, rootPaneNode, S.context])}\n    >\n      {children}\n    </DeskToolContext.Provider>\n  )\n}\n"],"names":["DocTitle","props","document","documentValue","schema","useSchema","schemaType","get","_type","error","value","useValuePreview","children","jsxs","Fragment","message","jsx","title","style","color","TimeAgo","_ref","time","timeAgo","useTimeAgo","isClientError","e","POLL_INTERVAL","visiblePoll$","getVisiblePoll$","fromEvent","pipe","startWith","map","visibilityState","distinctUntilChanged","switchMap","visible","timer","EMPTY","shareReplay","refCount","bufferSize","getDocumentExistence","documentId","_ref2","versionedClient","draftId","getDraftId","publishedId","getPublishedId","requestOptions","uri","getDataUrl","concat","json","query","excludeContent","tag","observable","request","_ref3","omitted","nonExistant","filter","doc","reason","length","some","id","fetchCrossDatasetReferences","context","checkDocumentId","of","totalCount","references","currentDataset","config","dataset","url","catchError","statusCode","useInternalReferences","createHookFromObservableFactory","_ref4","documentStore","referencesClause","totalClause","fetchQuery","listenQuery","fetch","listen","transitions","throttleTime","useCrossDatasetReferences","_ref5","useReferringDocuments","useClient","DEFAULT_STUDIO_CLIENT_OPTIONS","useDocumentStore","internalReferences","isInternalReferencesLoading","useMemo","crossDatasetReferences","isCrossDatasetReferencesLoading","projectIds","Array","from","Set","crossDatasetReference","projectId","Boolean","sort","datasetNames","datasetName","hasUnknownDatasetNames","isLoading","PublishedStatus","updatedAt","_updatedAt","Tooltip","portal","content","Box","padding","Text","size","TextWithTone","tone","dimmed","muted","PublishIcon","DraftStatus","EditIcon","PaneItemPreview","icon","layout","presence","isRecord","isValidElement","isString","isNumber","draft","published","useMemoObservable","getPreviewStateObservable","documentPreviewStore","_id","status","Inline","space","DocumentPreviewPresence","SanityDefaultPreview","getPreviewValueWithFallback","isPlaceholder","missingContext","Error","PaneRouterContext","createContext","index","groupIndex","siblingIndex","payload","params","hasGroupSiblings","groupLength","routerPanesState","BackLink","ChildLink","ReferenceChildLink","handleEditReference","ParameterizedLink","replaceCurrent","closeCurrent","duplicateCurrent","setView","setParams","setPayload","navigateIntent","forwardRef","ref","useContext","panes","slice","state","StateLink","childId","childPayload","childParameters","rest","documentType","parentRefPath","template","type","pathToString","currentPanes","nextParams","useUnique","nextPayload","nextState","currentGroup","currentSibling","nextSibling","nextGroup","nextPanes","usePaneRouter","EMPTY_ARRAY","ReferencePreviewLink","onClick","documentPresence","useDocumentPresence","useDocumentPreviewStore","Link","useCallback","LinkComponent","linkProps","name","PreviewCard","__unstable_focusRing","as","radius","ChevronWrapper","styled","_templateObject","_taggedTemplateLiteral","CrossDatasetReferencesDetails","default","details","_templateObject2","CrossDatasetReferencesSummary","summary","_templateObject3","TableContainer","attrs","paddingX","paddingBottom","_templateObject4","Table","table","_templateObject5","_ref7","theme","rem","sanity","_ref8","_ref9","DocumentIdFlex","Flex","_templateObject6","ReferencesCard","Card","shadow","marginBottom","flex","_templateObject7","OtherReferenceCount","difference","placement","Container","width","InfoOutlineIcon","ConfirmDeleteDialogBody","_ref10","documentTitle","action","onReferenceLinkClick","toast","useToast","renderPreviewItem","item","UnknownIcon","subtitle","documentCount","toLocaleString","normalizedDatasetNames","datasetsCount","datasetNameList","join","WarningOutlineIcon","marginLeft","direction","height","Stack","overflow","borderTop","align","marginRight","DocumentsIcon","textOverflow","ChevronDownIcon","Label","reference","_ref11","gap","justify","CopyToClipboard","text","onCopy","push","Button","mode","ClipboardIcon","fontSize","DialogBody","_templateObject8","LoadingContainer","_templateObject9","ConfirmDeleteDialog","_ref12","onCancel","onConfirm","dialogId","useId","capitalizedAction","substring","toUpperCase","showConfirmButton","Dialog","header","footer","Grid","columns","paddingY","onClose","onClickOutside","Spinner","marginTop","ConfirmDeleteDialogContainer","setError","useState","handleRetry","ErrorBoundary","onCatch","CONTEXT_MENU_POPOVER_PROPS","constrainSize","PaneContextMenuButton","items","itemGroups","onAction","groups","defaultGroup","groupMap","reduce","acc","group","Object","values","g","MenuButton","button","EllipsisVerticalIcon","menu","Menu","MenuDivider","paddingTop","itemIndex","PaneContextMenuItem","popover","handleClick","hotkeys","shortcut","split","IntentButtonOrActionButton","linkRef","intent","IntentLink","MenuItem","pressed","selected","displayName","PANE_DEBUG","PANE_COLLAPSED_WIDTH","PANE_DEFAULT_MIN_WIDTH","PaneContext","PaneLayoutContext","usePaneLayout","pane","Root","Layer","_templateObject10","PaneDivider","_ref13","disabled","element","resize","dragging","setDragging","handleMouseDown","event","preventDefault","startX","pageX","handleMouseMove","deltaX","handleMouseUp","window","removeEventListener","addEventListener","onMouseDown","_templateObject11","Pane","_a","_b","_c","currentMinWidth","currentMinWidthProp","currentMaxWidth","currentMaxWidthProp","flexProp","minWidth","minWidthProp","maxWidth","maxWidthProp","restProps","rootElement","setRootElement","collapse","collapsed","layoutCollapsed","expand","expandedElement","mount","find","p","paneIndex","indexOf","nextPane","isLast","nextCollapsed","forwardedRef","useForwardedRef","setRef","refValue","current","useEffect","handleCollapse","handleExpand","contextValue","hidden","divider","LegacyLayerProvider","zOffset","Infinity","Provider","BoundaryElementProvider","usePane","_templateObject12","PaneContent","forwardedAs","_templateObject13","RootCard","_templateObject14","PaneFooter","_templateObject15","Layout","_templateObject16","TitleCard","_ref14","fg","bg","card","enabled","css","_templateObject17","TitleTextSkeleton","TextSkeleton","_templateObject18","TitleText","_templateObject19","TabsBox","_ref15","_templateObject20","rgba","base","PaneHeader","actions","backButton","contentAfter","loading","subActions","tabs","tabIndex","paneElement","paneRect","useElementRect","layoutStyle","innerHeight","handleTitleClick","handleLayoutClick","LayerProvider","sizing","paddingLeft","animated","weight","_templateObject21","IntentButton","Link2","role","InsufficientPermissionsMessageTooltip","_ref16","reveal","currentUser","useCurrentUser","InsufficientPermissionsMessage","POPOVER_PROPS","getIntent","templates","typeName","t","templateId","baseParams","initialDocumentId","parameters","PaneHeaderCreateButton","_ref17","templateItems","useTemplates","templatePermissions","isTemplatePermissionsLoading","useTemplatePermissions","nothingGranted","every","permission","granted","permissionsById","ComposeIcon","firstItem","permissions","emptyArray","emptyObject","isNonNullable","hashObject","sortObject","v","isArray","entries","_ref18","_ref19","keyA","keyB","localeCompare","normalize","JSON","parse","stringify","PaneHeaderActions","memo","_ref20","initialValueTemplateItems","initialValueTemplateItemsFromStructure","menuItems","menuItemGroups","actionHandlers","handleAction","console","warn","handler","actionMenuItems","contextMenuItems","nonCreateMenuItem","partition","showAsAction","initialValueTemplateItemFromMenuItems","menuItemIndex","intentParams","templateParams","_ref21","initialValueTemplateItem","description","combinedInitialValueTemplates","uniqBy","actionItem","actionIndex","DISABLED_REASON_TITLE","NOTHING_TO_DELETE","DeleteAction","_ref22","onComplete","delete","deleteOp","useDocumentOperation","isDeleting","setIsDeleting","isConfirmDialogOpen","setConfirmDialogOpen","handleCancel","handleConfirm","execute","handle","isPermissionsLoading","useDocumentPairPermissions","TrashIcon","label","operationLabel","onHandle","dialog","component","NO_CHANGES","NOT_PUBLISHED","DiscardChangesAction","_ref23","liveEdit","discardChanges","ResetIcon","NOTHING_TO_DUPLICATE","DuplicateAction","_ref24","duplicate","useRouter","isDuplicating","setDuplicating","dupeId","uuid","CopyIcon","HistoryRestoreAction","_ref25","revision","restore","isRevisionInitialVersion","isRevisionLatestVersion","RestoreIcon","DocumentPaneContext","useDocumentPane","documentPane","LIVE_EDIT_ENABLED","ALREADY_PUBLISHED","NOT_READY","getDisabledReason","publishedAt","PublishAction","publishState","setPublishState","publish","validationStatus","useValidationStatus","syncState","useSyncState","changesOpen","onHistoryOpen","editState","useEditState","_rev","hasValidationErrors","validation","isValidationErrorMarker","publishScheduled","setPublishScheduled","isSyncing","isValidating","hasDraft","doPublish","validationComplete","didPublish","delay","setTimeout","clearTimeout","transactionSyncLock","CheckmarkIcon","UnpublishAction","_ref26","unpublish","UnpublishIcon","LiveEditBadge","_DEBUG","EMPTY_PARAMS","LOADING_PANE","Symbol","DOCUMENT_PANEL_PORTAL_ELEMENT","activePanes","setActivePanes","getIntentState","routerState","editDocumentId","isTemplate","i","canHandleIntent","call","schemaTypeName","options","paneParams","legacyEditParamsToState","decodeURIComponent","err","encodePanesSegment","encodeChunks","encodeURIComponent","legacyEditParamsToPath","toState","pathSegment","parsePanesSegment","toPath","router","route","create","intents","path","transform","panePattern","isParam","str","test","isPayload","exclusiveParams","isTruthy","parseChunks","chunks","initial","chunk","key","tryParseBase64Payload","firstSibling","paneIsFirstSibling","sameAsFirst","encodedPayload","btoa","encodedParams","entry","valueFromFirstSibling","includes","_ref27","flat","parseOldPanesSegment","restOfSiblings","segment","sibling","omit","buffer","match","payloadChunk","tryParsePayload","data","atob","documentActions","documentBadges","deskTool","definePlugin","prevActions","badges","prevBadges","badge","tools","MasterDetailIcon","lazy","Promise","resolve","then","require","DeskToolContext","SerializeError","constructor","parentPath","hint","withHelpUrl","helpId","HELP_URL","IMPLICIT_FIELDS","joinReferences","head","tail","schemaField","fields","field","refTypes","to","refType","tailFields","tailWrapper","getExtendedProjection","orderBy","ordering","ORDER_BY_UPDATED_AT","by","ORDER_BY_CREATED_AT","DEFAULT_SELECTED_ORDERING_OPTION","DEFAULT_ORDERING_OPTIONS","maybeSerializeMenuItem","MenuItemBuilder","serialize","_context","spec","clone","getAction","getTitle","getGroup","getIcon","getParams","getShowAsAction","arguments","undefined","TITLE_REQUIRED","ACTION_OR_INTENT_REQUIRED","ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE","withSpec","builder","getOrderingMenuItem","extendedProjection","SortIcon","getOrderingMenuItemsForSchemaType","orderings","maybeSerializeMenuItemGroup","MenuItemGroupBuilder","_title","getId","ID_REQUIRED","disallowedPattern","validateId","disallowedChar","startsWith","getStructureNodeId","camelCased","camelCase","getSlug","ComponentBuilder","child","getChild","getComponent","getOptions","getMenuItems","getMenuItemGroups","componentOptions","resolveTypeForDocument","getClient","types","GenericViewBuilder","kebabCase","isSerializable","view","maybeSerializeView","isComponentSpec","ComponentViewBuilder","componentOrSpec","userComponent","COMPONENT_REQUIRED","FormViewBuilder","form","createDocumentChildResolver","_ref28","resolveDocumentNode","itemId","_ref29","currentSegment","DocumentBuilder","paneId","getDocumentId","getSchemaType","initialValueTemplate","templateParameters","getInitialValueTemplate","getInitialValueTemplateParameters","views","getViews","urlId","DOCUMENT_ID_REQUIRED","viewIds","dupes","uniq","viewId","getDocumentOptions","opts","documentFromEditor","documentFromEditorWithInitialValue","_ref30","layoutOptions","DEFAULT_INTENT_HANDLER","defaultIntentChecker","intentName","_ref31","isEdit","isCreate","typedSpec","paneFilter","typeNames","getTypeNamesFromFilter","initialValueTemplates","tpl","identity","InitialValueTemplateItemBuilder","getDescription","getTemplateId","getParameters","defaultInitialValueTemplateItems","getStructureBuilder","getTypeNames","ordered","a","b","maybeSerializeInitialValueTemplateItem","menuItemsFromInitialValueTemplateItems","pickBy","noChildResolver","shallowIntentChecker","_ref32","GenericListBuilder","initialValueTemplatesSpecified","defaultLayout","getDefaultLayout","getCanHandleIntent","showIcons","displayOptions","getShowIcons","getInitialValueTemplates","validateFilter","trim","QUERY_PROVIDED_FOR_FILTER","createDocumentChildResolverForItem","parentItem","parent","DocumentListBuilder","apiVersion","getApiVersion","getFilter","defaultOrdering","getDefaultOrdering","FILTER_REQUIRED","inferInitialValueTemplates","inferTypeName","getSpec","flatMap","resolveNewDocumentOptions","option","getTypeNamesFromEqualityFilter","getTypeNamesFromInTypesFilter","pattern","matches","exec","candidate","normalized","replace","getArgType","thing","ListBuilder","isPromise","isListItem","defaultCanHandleIntent","isDocumentListItem","resolveChildForItem","target","maybeSerializeListItem","ListItemBuilder","listItem","gotWhat","helpText","INVALID_LIST_ITEM","getItems","LIST_ITEMS_MUST_BE_ARRAY","serializedItems","val","dupeIds","dupeDesc","LIST_ITEM_IDS_MUST_BE_UNIQUE","showIcon","getShowIcon","titleIsOptional","SCHEMA_TYPE_NOT_FOUND","serializeOptions","listChild","originalChild","childOptions","createDefaultChildResolver","DocumentListItemBuilder","SCHEMA_TYPE_REQUIRED","DocumentTypeListBuilder","cloneWithoutDefaultIntentHandler","shouldOverride","override","shouldShowIcon","preview","prepare","select","media","BUNDLED_DOC_TYPES","isBundledDocType","isDocumentType","isList","collection","getDocumentTypes","_ref33","n","getDocumentTypeListItems","getDocumentTypeListItem","startCase","childContext","list","getDocumentTypeList","typeNameOrSpec","StackCompactIcon","StackIcon","hasIcon","getDefaultStructure","createStructureBuilder","_ref34","defaultDocumentNode","source","configContext","getConfigContextFromSource","structureBuilder","defaults","documentTypeList","_len","args","_key","documentTypeListItem","_len2","_key2","documentTypeListItems","_len3","_key3","_len4","_key4","documentWithInitialValueTemplate","_len5","_key5","defaultDocument","_len6","_key6","_len7","_key7","menuItem","_len8","_key8","menuItemGroup","_len9","_key9","_len10","_key10","documentList","_len11","_key11","documentListItem","_len12","_key12","orderingMenuItem","_len13","_key13","orderingMenuItemsForType","_len14","_key14","editor","_len15","_key15","_len16","_key16","isValidElementType","uniqueId","DeskToolProvider","_ref35","structure","resolveStructure","setLayoutCollapsed","useSource","useConfigContextFromSource","S","rootPaneNode","features","reviewChanges","splitPanes","splitViews","structureContext"],"mappings":"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"}