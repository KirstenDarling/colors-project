{"version":3,"file":"index.cjs","sources":["../src/hooks.ts","../src/LiveQueryProvider.tsx"],"sourcesContent":["import type { QueryParams as ClientQueryParams } from '@sanity/client'\nimport { useCallback, useContext, useMemo, useState } from 'react'\nimport isFastEqual from 'react-fast-compare'\nimport { useSyncExternalStoreWithSelector } from 'use-sync-external-store/with-selector'\n\nimport { defineListenerContext, LoadedListenersContext } from './context'\nimport type { ListenerStatus } from './types'\nimport { getQueryCacheKey } from './utils'\n\n// Re-export types we use that are needed externally\nexport type { ClientQueryParams, ListenerStatus }\n\n/**\n * By default 'react-fast-compare' is used to check if the query result has changed.\n * It's reasonably fast, but you can make it even faster by providing your own function as you know which\n * part of the query result is visible to the user, and which parts can skip rendering.\n * @public\n */\nexport type isEqualFn<QueryResult> = (a: QueryResult, b: QueryResult) => boolean\n\n/** @public */\nexport interface LiveQueryHookOptions<QueryResult> {\n  isEqual?: isEqualFn<QueryResult>\n}\n\n/** @public */\nexport type QueryLoading = boolean\n\n/** @public */\nexport function useLiveQuery<\n  QueryResult,\n  QueryParams extends ClientQueryParams = ClientQueryParams\n>(\n  initialData: QueryResult,\n  query: string,\n  queryParams?: QueryParams,\n  options?: LiveQueryHookOptions<QueryResult>\n): [QueryResult, QueryLoading] {\n  const { isEqual = isFastEqual } = options || {}\n\n  const defineStore = useContext(defineListenerContext)\n  const params = useParams(queryParams)\n  const store = useMemo(\n    () => defineStore<QueryResult>(initialData, query, params),\n    [defineStore, initialData, params, query]\n  )\n  // initialSnapshot might change before hydration is done, so deep cloning it on the first hook call\n  // helps ensure that we don't get a mismatch between the server and client snapshots\n  const [serverSnapshot] = useState(() => {\n    if (initialData === undefined) {\n      throw new Error(\n        `initialSnapshot can't be undefined, if you don't want an initial value use null instead`\n      )\n    }\n    try {\n      return JSON.parse(JSON.stringify(initialData))\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        \"Failed to deep clone initialSnapshot, this is likely an error and an indication that the snapshot isn't JSON serializable\",\n        { initialSnapshot: initialData, error }\n      )\n      return initialData\n    }\n  })\n  const getServerSnapshot = useCallback(() => serverSnapshot, [serverSnapshot])\n  const selector = useCallback((snapshot: QueryResult) => snapshot, [])\n\n  const snapshot = useSyncExternalStoreWithSelector(\n    store.subscribe,\n    store.getSnapshot,\n    getServerSnapshot,\n    selector,\n    isEqual\n  )\n  const loading = useLiveQueryIsLoading(query, params)\n\n  return [snapshot, loading]\n}\n\n/**\n * Wether a particular query is loading or not.\n * @public\n */\nfunction useLiveQueryIsLoading(\n  query: string,\n  params: ClientQueryParams\n): QueryLoading {\n  const loadedListeners = useContext(LoadedListenersContext)\n  const key = useMemo(() => getQueryCacheKey(query, params), [params, query])\n\n  return useMemo(() => {\n    if (Array.isArray(loadedListeners)) {\n      return loadedListeners.includes(key) ? false : true\n    }\n    return false\n  }, [key, loadedListeners])\n}\n\n/**\n * @public\n * @deprecated use `LiveQueryHookOptions` instead\n */\nexport interface ListeningQueryHookOptions<QueryResult> {\n  isEqual?: isEqualFn<QueryResult>\n}\n\n/**\n * @public\n * @deprecated use `useLiveQuery` instead\n */\nexport function useListeningQuery<\n  QueryResult,\n  QueryParams extends ClientQueryParams = ClientQueryParams\n>(\n  initialSnapshot: QueryResult,\n  query: string,\n  queryParams?: QueryParams,\n  options?: ListeningQueryHookOptions<QueryResult>\n): QueryResult {\n  const [snapshot] = useLiveQuery<QueryResult, QueryParams>(\n    initialSnapshot,\n    query,\n    queryParams,\n    options\n  )\n  return snapshot\n}\n\n/**\n * Wether a particular query is loading or not.\n * @public\n * @deprecated use `useLiveQuery` instead\n */\nexport function useListeningQueryStatus<\n  QueryParams extends ClientQueryParams = ClientQueryParams\n>(query: string, queryParams?: QueryParams): ListenerStatus {\n  const params = useParams(queryParams)\n  const loading = useLiveQueryIsLoading(query, params)\n\n  return loading ? 'loading' : 'success'\n}\n\n/**\n * Return params that are stable with deep equal as long as the key order is the same\n * @internal\n */\nfunction useParams(\n  params?: undefined | null | ClientQueryParams\n): ClientQueryParams {\n  const stringifiedParams = useMemo(\n    () => JSON.stringify(params || {}),\n    [params]\n  )\n  return useMemo(() => JSON.parse(stringifiedParams), [stringifiedParams])\n}\n","/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport type { SanityClient } from '@sanity/client'\nimport { lazy, memo, Suspense, useEffect, useMemo, useState } from 'react'\n\nimport type { Logger } from './types'\nimport { DEFAULT_MAX_DOCUMENTS } from './utils'\n\nconst LazyGroqStoreProvider = lazy(() => import('./groq-store'))\nconst LiveStoreProvider = lazy(() => import('./live-store'))\n\nexport type { Logger }\n\n/** @public */\nexport interface CacheOptions {\n  /**\n   * Uses a `Listen` API call with EventSource to stream updates in real-time to the documents cache\n   * @defaultValue true\n   */\n  listen?: boolean\n  /**\n   * The maximum number of documents to keep in the in-memory\n   * @defaultValue 3000\n   */\n  maxDocuments?: number\n  /**\n   * Set it to an array over document `_type` names to filter the cache to, set it to an empty array to cache any type\n   * @defaultValue []\n   */\n  includeTypes?: string[]\n}\n\n/** @public */\nexport interface LiveQueryProviderProps {\n  children: React.ReactNode\n  client: SanityClient\n  cache?: CacheOptions\n  /**\n   * @defaultValue false\n   * @alpha Highly experimental, may have breaking changes in minor releases\n   */\n  experimental__turboSourceMap?: boolean\n  /**\n   * The interval in millieseconds to refetch in the background, when the tab is active.\n   * Set it to `0` to disable background refresh.\n   * @defaultValue experimental__turboSourceMap ? 10000 : 0\n   * @alpha Highly experimental, may have breaking changes in minor releases\n   */\n  experimental__refreshInterval?: number\n  logger?: Logger\n}\n\nexport const LiveQueryProvider = memo(function LiveQueryProvider(\n  props: LiveQueryProviderProps\n) {\n  const {\n    children,\n    experimental__turboSourceMap = false,\n    experimental__refreshInterval,\n  } = props\n  // Ensure these values are stable even if userland isn't memoizing properly\n  const [client] = useState(() => props.client)\n  const [cache] = useState(() => props.cache)\n  const [logger] = useState(() => props.logger)\n\n  useEffect(() => {\n    if (experimental__refreshInterval || experimental__turboSourceMap) {\n      logger?.warn(\n        '[@sanity/preview-kit]: You are using experimental features, these may have breaking changes in minor releases'\n      )\n    }\n  }, [experimental__refreshInterval, experimental__turboSourceMap, logger])\n\n  if (experimental__turboSourceMap) {\n    return (\n      <Suspense fallback={children}>\n        <LiveStoreProvider\n          client={client}\n          logger={logger}\n          refreshInterval={experimental__refreshInterval}\n          turboSourceMap={experimental__turboSourceMap}\n        >\n          {children}\n        </LiveStoreProvider>\n      </Suspense>\n    )\n  }\n\n  return (\n    <SelectStoreProvider\n      client={client}\n      cache={cache}\n      logger={logger}\n      experimental__refreshInterval={experimental__refreshInterval}\n    >\n      {children}\n    </SelectStoreProvider>\n  )\n})\n\nconst SelectStoreProvider = memo(function SelectStoreProvider(\n  props: LiveQueryProviderProps\n) {\n  const {\n    children,\n    experimental__refreshInterval = 0,\n    client,\n    cache,\n    logger,\n  } = props\n  const maxDocuments = cache?.maxDocuments ?? DEFAULT_MAX_DOCUMENTS\n  const [documentsCount, setDocumentsCount] = useState<number | null>(null)\n  const [error, setError] = useState<Error | null>(null)\n  const [includeTypes] = useState(() => cache?.includeTypes ?? [])\n\n  // Rethrow errors to the nearest error boundary\n  if (error) {\n    throw error\n  }\n\n  useEffect(() => {\n    if (documentsCount !== null) {\n      return\n    }\n\n    logger?.log('[@sanity/preview-kit]: fetch documents count')\n    const controller = new AbortController()\n    client\n      .fetch<number>(\n        includeTypes.length > 0\n          ? 'count(*[_type in $includeTypes])'\n          : 'count(*)',\n        { includeTypes },\n        { filterResponse: true, signal: controller.signal }\n      )\n      .then((result) => {\n        logger?.log('[@sanity/preview-kit]: documents count', result)\n        setDocumentsCount(result)\n      })\n      .catch((error) => {\n        if (error.name !== 'AbortError') {\n          setError(error)\n        }\n      })\n    return () => {\n      controller.abort()\n    }\n  }, [client, documentsCount, includeTypes, logger])\n\n  if (documentsCount === null) {\n    return children\n  }\n\n  if (experimental__refreshInterval && documentsCount >= maxDocuments) {\n    return (\n      <Suspense fallback={children}>\n        <LiveStoreProvider\n          client={client}\n          refreshInterval={experimental__refreshInterval}\n          turboSourceMap={false}\n          logger={logger}\n        >\n          {children}\n        </LiveStoreProvider>\n      </Suspense>\n    )\n  }\n\n  if (documentsCount >= maxDocuments) {\n    throw new Error(\n      `[@sanity/preview-kit]: You have ${documentsCount} documents in your dataset, which is more than the maximum of ${maxDocuments} documents. Please reduce the number of documents in your dataset or increase the limit.`\n    )\n  }\n\n  return (\n    <Suspense fallback={children}>\n      <GroqStoreProvider {...props}>{children}</GroqStoreProvider>\n    </Suspense>\n  )\n})\n\nconst GroqStoreProvider = memo(function GroqStoreProvider(\n  props: LiveQueryProviderProps\n) {\n  const { children, client, cache, logger } = props\n  const {\n    projectId,\n    dataset,\n    token,\n    perspective = 'previewDrafts',\n  } = useMemo(() => client.config(), [client])\n\n  return (\n    <LazyGroqStoreProvider\n      projectId={projectId!}\n      dataset={dataset!}\n      token={token}\n      logger={logger}\n      listen={cache?.listen ?? true}\n      documentLimit={cache?.maxDocuments}\n      overlayDrafts={perspective === 'previewDrafts'}\n      includeTypes={cache?.includeTypes}\n    >\n      {children}\n    </LazyGroqStoreProvider>\n  )\n})\n"],"names":["useLiveQuery","initialData","query","queryParams","options","isEqual","isFastEqual","defineStore","useContext","defineListenerContext","params","useParams","store","useMemo","serverSnapshot","useState","Error","JSON","parse","stringify","error","console","warn","initialSnapshot","getServerSnapshot","useCallback","selector","snapshot","useSyncExternalStoreWithSelector","subscribe","getSnapshot","loading","useLiveQueryIsLoading","loadedListeners","LoadedListenersContext","key","getQueryCacheKey","Array","isArray","includes","useListeningQuery","useListeningQueryStatus","stringifiedParams","LazyGroqStoreProvider","lazy","Promise","resolve","then","require","LiveStoreProvider","LiveQueryProvider","memo","props","children","experimental__turboSourceMap","experimental__refreshInterval","client","cache","logger","useEffect","jsx","Suspense","fallback","refreshInterval","turboSourceMap","SelectStoreProvider","_a","maxDocuments","DEFAULT_MAX_DOCUMENTS","documentsCount","setDocumentsCount","setError","includeTypes","log","controller","AbortController","fetch","length","filterResponse","signal","result","catch","name","abort","concat","GroqStoreProvider","projectId","dataset","token","perspective","config","listen","documentLimit","overlayDrafts"],"mappings":"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"}