{"version":3,"file":"Marker.js","names":["markerPath","Marker","React","PureComponent","componentDidMount","props","position","api","map","onMove","zIndex","opacity","label","markerRef","color","GMarker","icon","path","fillOpacity","fillColor","background","strokeColor","border","strokeWeight","anchor","Point","labelOrigin","marker","draggable","Boolean","current","attachMoveHandler","attachClickHandler","componentDidUpdate","prevProps","latLngAreEqual","setPosition","setLabel","setZIndex","setOpacity","setMap","componentWillUnmount","eventHandlers","move","remove","event","addListener","onClick","click","render"],"sources":["../../src/map/Marker.tsx"],"sourcesContent":["import * as React from 'react'\nimport {LatLng} from '../types'\nimport {latLngAreEqual} from './util'\n\nconst markerPath =\n  'M 3.052 3.7 C 1.56 5.293 0.626 7.612 0.663 9.793 C 0.738 14.352 2.793 16.077 6.078 22.351 C 7.263 25.111 8.497 28.032 9.672 32.871 C 9.835 33.584 9.994 34.246 10.069 34.305 C 10.143 34.362 10.301 33.697 10.465 32.983 C 11.639 28.145 12.875 25.226 14.059 22.466 C 17.344 16.192 19.398 14.466 19.474 9.908 C 19.511 7.727 18.574 5.405 17.083 3.814 C 15.379 1.994 12.809 0.649 10.069 0.593 C 7.328 0.536 4.756 1.882 3.052 3.7 Z'\n\ninterface Props {\n  api: typeof window.google.maps\n  map: google.maps.Map\n  onMove?: (event: google.maps.MapMouseEvent) => void\n  onClick?: (event: google.maps.MapMouseEvent) => void\n  onMouseOver?: (event: google.maps.MapMouseEvent) => void\n  onMouseOut?: (event: google.maps.MapMouseEvent) => void\n  position: LatLng | google.maps.LatLng\n  zIndex?: number\n  opacity?: number\n  label?: string\n  markerRef?: React.MutableRefObject<google.maps.Marker | undefined>\n  color?: {background: string; border: string; text: string}\n}\n\nexport class Marker extends React.PureComponent<Props> {\n  marker: google.maps.Marker | undefined\n\n  eventHandlers: {\n    move?: google.maps.MapsEventListener\n    click?: google.maps.MapsEventListener\n  } = {}\n\n  componentDidMount() {\n    const {position, api, map, onMove, zIndex, opacity, label, markerRef, color} = this.props\n    const {Marker: GMarker} = api\n\n    let icon: google.maps.ReadonlySymbol | undefined\n    if (color) {\n      icon = {\n        path: markerPath,\n        fillOpacity: 1,\n        fillColor: color.background,\n        strokeColor: color.border,\n        strokeWeight: 2,\n        anchor: new api.Point(10, 35),\n        labelOrigin: new api.Point(10, 11),\n      }\n    }\n\n    this.marker = new GMarker({\n      draggable: Boolean(onMove),\n      position,\n      map,\n      zIndex,\n      opacity,\n      label,\n      icon,\n    })\n\n    if (markerRef) {\n      markerRef.current = this.marker\n    }\n\n    this.attachMoveHandler()\n    this.attachClickHandler()\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (!this.marker) {\n      return\n    }\n\n    const {position, onMove, label, zIndex, opacity, map} = this.props\n\n    if (prevProps.onMove !== onMove) {\n      this.attachMoveHandler()\n    }\n\n    if (!latLngAreEqual(prevProps.position, position)) {\n      this.marker.setPosition(position)\n    }\n\n    if (prevProps.label !== label) {\n      this.marker.setLabel(label || null)\n    }\n\n    if (prevProps.zIndex !== zIndex) {\n      this.marker.setZIndex(zIndex || null)\n    }\n\n    if (prevProps.opacity !== opacity) {\n      this.marker.setOpacity(opacity || null)\n    }\n\n    if (prevProps.map !== map) {\n      this.marker.setMap(map)\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.eventHandlers.move) {\n      this.eventHandlers.move.remove()\n    }\n\n    if (this.marker) {\n      this.marker.setMap(null)\n    }\n  }\n\n  attachMoveHandler() {\n    const {api, onMove} = this.props\n    if (this.eventHandlers.move) {\n      this.eventHandlers.move.remove()\n    }\n    if (this.marker && onMove) {\n      this.eventHandlers.move = api.event.addListener(this.marker, 'dragend', onMove)\n    }\n  }\n\n  attachClickHandler() {\n    const {api, onClick} = this.props\n    if (this.eventHandlers.click) {\n      this.eventHandlers.click.remove()\n    }\n    if (this.marker && onClick) {\n      this.eventHandlers.click = api.event.addListener(this.marker, 'click', onClick)\n    }\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  render() {\n    return null\n  }\n}\n"],"mappings":"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"}