{"version":3,"file":"Map.js","names":["GoogleMap","React","PureComponent","map","undefined","createRef","state","props","api","onClick","event","clickHandler","remove","addListener","element","mapEl","constructMap","setState","attachClickHandler","componentDidMount","componentDidUpdate","prevProps","location","bounds","latLngAreEqual","panTo","getCenter","equals","fitBounds","componentWillUnmount","LatLng","lat","lng","el","defaultZoom","mapTypeControl","controlSize","scrollWheel","Map","zoom","center","scrollwheel","streetViewControl","render","children","setMapElement"],"sources":["../../src/map/Map.tsx"],"sourcesContent":["import React from 'react'\nimport {LatLng} from '../types'\nimport {latLngAreEqual} from './util'\nimport {MapContainer} from './Map.styles'\n\ninterface MapProps {\n  api: typeof window.google.maps\n  location: LatLng\n  bounds?: google.maps.LatLngBounds\n  defaultZoom?: number\n  mapTypeControl?: boolean\n  scrollWheel?: boolean\n  controlSize?: number\n  onClick?: (event: google.maps.MapMouseEvent) => void\n  children?: (map: google.maps.Map) => React.ReactElement\n}\n\ninterface MapState {\n  map: google.maps.Map | undefined\n}\n\nexport class GoogleMap extends React.PureComponent<MapProps, MapState> {\n  static defaultProps = {\n    defaultZoom: 8,\n    scrollWheel: true,\n  }\n\n  state: MapState = {map: undefined}\n  clickHandler: google.maps.MapsEventListener | undefined\n  mapRef = React.createRef<HTMLDivElement>()\n  mapEl: HTMLDivElement | null = null\n\n  componentDidMount() {\n    this.attachClickHandler()\n  }\n\n  attachClickHandler = () => {\n    const map = this.state.map\n    if (!map) {\n      return\n    }\n\n    const {api, onClick} = this.props\n    const {event} = api\n\n    if (this.clickHandler) {\n      this.clickHandler.remove()\n    }\n\n    if (onClick) {\n      this.clickHandler = event.addListener(map, 'click', onClick)\n    }\n  }\n\n  componentDidUpdate(prevProps: MapProps) {\n    const map = this.state.map\n    if (!map) {\n      return\n    }\n\n    const {onClick, location, bounds} = this.props\n\n    if (prevProps.onClick !== onClick) {\n      this.attachClickHandler()\n    }\n\n    if (!latLngAreEqual(prevProps.location, location)) {\n      map.panTo(this.getCenter())\n    }\n\n    if (bounds && (!prevProps.bounds || !bounds.equals(prevProps.bounds))) {\n      map.fitBounds(bounds)\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.clickHandler) {\n      this.clickHandler.remove()\n    }\n  }\n\n  getCenter(): google.maps.LatLng {\n    const {location, api} = this.props\n    return new api.LatLng(location.lat, location.lng)\n  }\n\n  constructMap(el: HTMLDivElement) {\n    const {defaultZoom, api, mapTypeControl, controlSize, bounds, scrollWheel} = this.props\n\n    const map = new api.Map(el, {\n      zoom: defaultZoom,\n      center: this.getCenter(),\n      scrollwheel: scrollWheel,\n      streetViewControl: false,\n      mapTypeControl,\n      controlSize,\n    })\n\n    if (bounds) {\n      map.fitBounds(bounds)\n    }\n\n    return map\n  }\n\n  setMapElement = (element: HTMLDivElement | null) => {\n    if (element && element !== this.mapEl) {\n      const map = this.constructMap(element)\n      this.setState({map}, this.attachClickHandler)\n    }\n\n    this.mapEl = element\n  }\n\n  render() {\n    const {children} = this.props\n    const {map} = this.state\n    return (\n      <>\n        <MapContainer ref={this.setMapElement} />\n        {children && map ? children(map) : null}\n      </>\n    )\n  }\n}\n"],"mappings":";;;;;;AAAA;AAEA;AACA;AAAyC;AAAA;AAkBlC,MAAMA,SAAS,SAASC,cAAK,CAACC,aAAa,CAAqB;EAAA;IAAA;IAAA,+BAMnD;MAACC,GAAG,EAAEC;IAAS,CAAC;IAAA;IAAA,6CAEzBH,cAAK,CAACI,SAAS,EAAkB;IAAA,+BACX,IAAI;IAAA,4CAMd,MAAM;MACzB,IAAMF,GAAG,GAAG,IAAI,CAACG,KAAK,CAACH,GAAG;MAC1B,IAAI,CAACA,GAAG,EAAE;QACR;MACF;MAEA,kBAAuB,IAAI,CAACI,KAAK;QAA1BC,GAAG,eAAHA,GAAG;QAAEC,OAAO,eAAPA,OAAO;MACnB,IAAOC,KAAK,GAAIF,GAAG,CAAZE,KAAK;MAEZ,IAAI,IAAI,CAACC,YAAY,EAAE;QACrB,IAAI,CAACA,YAAY,CAACC,MAAM,EAAE;MAC5B;MAEA,IAAIH,OAAO,EAAE;QACX,IAAI,CAACE,YAAY,GAAGD,KAAK,CAACG,WAAW,CAACV,GAAG,EAAE,OAAO,EAAEM,OAAO,CAAC;MAC9D;IACF,CAAC;IAAA,uCAqDgBK,OAA8B,IAAK;MAClD,IAAIA,OAAO,IAAIA,OAAO,KAAK,IAAI,CAACC,KAAK,EAAE;QACrC,IAAMZ,IAAG,GAAG,IAAI,CAACa,YAAY,CAACF,OAAO,CAAC;QACtC,IAAI,CAACG,QAAQ,CAAC;UAACd,GAAG,EAAHA;QAAG,CAAC,EAAE,IAAI,CAACe,kBAAkB,CAAC;MAC/C;MAEA,IAAI,CAACH,KAAK,GAAGD,OAAO;IACtB,CAAC;EAAA;EAhFDK,iBAAiB,GAAG;IAClB,IAAI,CAACD,kBAAkB,EAAE;EAC3B;EAoBAE,kBAAkB,CAACC,SAAmB,EAAE;IACtC,IAAMlB,GAAG,GAAG,IAAI,CAACG,KAAK,CAACH,GAAG;IAC1B,IAAI,CAACA,GAAG,EAAE;MACR;IACF;IAEA,mBAAoC,IAAI,CAACI,KAAK;MAAvCE,OAAO,gBAAPA,OAAO;MAAEa,QAAQ,gBAARA,QAAQ;MAAEC,MAAM,gBAANA,MAAM;IAEhC,IAAIF,SAAS,CAACZ,OAAO,KAAKA,OAAO,EAAE;MACjC,IAAI,CAACS,kBAAkB,EAAE;IAC3B;IAEA,IAAI,CAAC,IAAAM,oBAAc,EAACH,SAAS,CAACC,QAAQ,EAAEA,QAAQ,CAAC,EAAE;MACjDnB,GAAG,CAACsB,KAAK,CAAC,IAAI,CAACC,SAAS,EAAE,CAAC;IAC7B;IAEA,IAAIH,MAAM,KAAK,CAACF,SAAS,CAACE,MAAM,IAAI,CAACA,MAAM,CAACI,MAAM,CAACN,SAAS,CAACE,MAAM,CAAC,CAAC,EAAE;MACrEpB,GAAG,CAACyB,SAAS,CAACL,MAAM,CAAC;IACvB;EACF;EAEAM,oBAAoB,GAAG;IACrB,IAAI,IAAI,CAAClB,YAAY,EAAE;MACrB,IAAI,CAACA,YAAY,CAACC,MAAM,EAAE;IAC5B;EACF;EAEAc,SAAS,GAAuB;IAC9B,mBAAwB,IAAI,CAACnB,KAAK;MAA3Be,QAAQ,gBAARA,QAAQ;MAAEd,GAAG,gBAAHA,GAAG;IACpB,OAAO,IAAIA,GAAG,CAACsB,MAAM,CAACR,QAAQ,CAACS,GAAG,EAAET,QAAQ,CAACU,GAAG,CAAC;EACnD;EAEAhB,YAAY,CAACiB,EAAkB,EAAE;IAC/B,mBAA6E,IAAI,CAAC1B,KAAK;MAAhF2B,WAAW,gBAAXA,WAAW;MAAE1B,GAAG,gBAAHA,GAAG;MAAE2B,cAAc,gBAAdA,cAAc;MAAEC,WAAW,gBAAXA,WAAW;MAAEb,MAAM,gBAANA,MAAM;MAAEc,WAAW,gBAAXA,WAAW;IAEzE,IAAMlC,GAAG,GAAG,IAAIK,GAAG,CAAC8B,GAAG,CAACL,EAAE,EAAE;MAC1BM,IAAI,EAAEL,WAAW;MACjBM,MAAM,EAAE,IAAI,CAACd,SAAS,EAAE;MACxBe,WAAW,EAAEJ,WAAW;MACxBK,iBAAiB,EAAE,KAAK;MACxBP,cAAc;MACdC;IACF,CAAC,CAAC;IAEF,IAAIb,MAAM,EAAE;MACVpB,GAAG,CAACyB,SAAS,CAACL,MAAM,CAAC;IACvB;IAEA,OAAOpB,GAAG;EACZ;EAWAwC,MAAM,GAAG;IACP,IAAOC,QAAQ,GAAI,IAAI,CAACrC,KAAK,CAAtBqC,QAAQ;IACf,IAAOzC,GAAG,GAAI,IAAI,CAACG,KAAK,CAAjBH,GAAG;IACV,oBACE,yEACE,6BAAC,iBAAY;MAAC,GAAG,EAAE,IAAI,CAAC0C;IAAc,EAAG,EACxCD,QAAQ,IAAIzC,GAAG,GAAGyC,QAAQ,CAACzC,GAAG,CAAC,GAAG,IAAI,CACtC;EAEP;AACF;AAAC;AAAA,gBAvGYH,SAAS,kBACE;EACpBkC,WAAW,EAAE,CAAC;EACdG,WAAW,EAAE;AACf,CAAC"}